<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Compute reactivity, return rates and contributions of interactions to
stationary forecast variance from
mvgam models with Vector Autoregressive dynamics"><title>Calculate measures of latent VAR community stability — stability.mvgam • mvgam</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Calculate measures of latent VAR community stability — stability.mvgam"><meta property="og:description" content="Compute reactivity, return rates and contributions of interactions to
stationary forecast variance from
mvgam models with Vector Autoregressive dynamics"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">mvgam</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.4</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/data_in_mvgam.html">Formatting data for use in mvgam</a>
    <a class="dropdown-item" href="../articles/forecast_evaluation.html">Forecasting and forecast evaluation in mvgam</a>
    <a class="dropdown-item" href="../articles/mvgam_overview.html">Overview of the mvgam package</a>
    <a class="dropdown-item" href="../articles/nmixtures.html">N-mixtures in mvgam</a>
    <a class="dropdown-item" href="../articles/shared_states.html">Shared latent states in mvgam</a>
    <a class="dropdown-item" href="../articles/time_varying_effects.html">Time-varying effects in mvgam</a>
    <a class="dropdown-item" href="../articles/trend_formulas.html">State-Space models in mvgam</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/nicholasjclark/mvgam/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Calculate measures of latent VAR community stability</h1>
      <small class="dont-index">Source: <a href="https://github.com/nicholasjclark/mvgam/blob/HEAD/R/stability.R" class="external-link"><code>R/stability.R</code></a></small>
      <div class="d-none name"><code>stability.mvgam.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Compute reactivity, return rates and contributions of interactions to
stationary forecast variance from
<code>mvgam</code> models with Vector Autoregressive dynamics</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">stability</span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for mvgam</span></span>
<span><span class="fu">stability</span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>object</dt>
<dd><p><code>list</code> object of class <code>mvgam</code> resulting from a call to <code><a href="mvgam.html">mvgam()</a></code>
that used a Vector Autoregressive latent process model (either as <code>VAR(cor = FALSE)</code> or
<code>VAR(cor = TRUE)</code>)</p></dd>


<dt>...</dt>
<dd><p>ignored</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A <code>data.frame</code> containing posterior draws for each stability metric.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>These measures of stability can be used to assess how important inter-series
dependencies are to the variability of a multivariate system and to ask how systems
are expected to respond to environmental perturbations. Using the formula for a latent VAR(1) as:
$$
\mu_t \sim \text{MVNormal}(A(\mu_{t - 1}), \Sigma) \quad
$$
this function will calculate the long-term stationary forecast distribution of the system, which
has mean \(\mu_{\infty}\) and variance \(\Sigma_{\infty}\), to then calculate the following quantities:</p><ul><li><p><code>prop_int</code>: Proportion of the volume of the stationary forecast distribution
that is attributable to lagged interactions (i.e. how important are the autoregressive
interaction coefficients in \(A\) for explaining the shape of the stationary forecast distribution?):
$$
    det(A)^2 \quad
    $$</p></li>
<li><p><code>prop_int_adj</code>: Same as <code>prop_int</code> but scaled by the number of series \(p\) to facilitate
direct comparisons among systems with different numbers of interacting variables:
$$
    det(A)^{2/p} \quad
    $$</p></li>
<li><p><code>prop_int_offdiag</code>: Sensitivity of <code>prop_int</code> to inter-series
interactions (i.e. how important are the off-diagonals of the autoregressive coefficient
matrix \(A\) for shaping <code>prop_int</code>?), calculated as the relative magnitude of the <em>off-diagonals</em> in
the partial derivative matrix:
$$
    [2~det(A) (A^{-1})^T] \quad
    $$</p></li>
<li><p><code>prop_int_diag</code>: Sensitivity of <code>prop_int</code> to intra-series
interactions (i.e. how important are the diagonals of the autoregressive coefficient matrix \(A\)
for shaping <code>prop_int</code>?), calculated as the relative magnitude of the <em>diagonals</em> in the partial derivative
matrix:
$$
    [2~det(A) (A^{-1})^T] \quad
    $$</p></li>
<li><p><code>prop_cov_offdiag</code>: Sensitivity of \(\Sigma_{\infty}\) to inter-series error correlations
(i.e. how important are off-diagonal covariances in \(\Sigma\) for shaping
\(\Sigma_{\infty}\)?), calculated as the relative magnitude of the <em>off-diagonals</em> in
the partial derivative matrix:
$$
    [2~det(\Sigma_{\infty}) (\Sigma_{\infty}^{-1})^T] \quad
    $$</p></li>
<li><p><code>prop_cov_diag</code>: Sensitivity of \(\Sigma_{\infty}\) to error variances
(i.e. how important are diagonal variances in \(\Sigma\) for shaping
\(\Sigma_{\infty}\)?), calculated as the relative magnitude of the <em>diagonals</em> in
the partial derivative matrix:
$$
    [2~det(\Sigma_{\infty}) (\Sigma_{\infty}^{-1})^T] \quad
    $$</p></li>
<li><p><code>reactivity</code>: A measure of the degree to which the system moves
away from a stable equilibrium following a perturbation.
Values <code>&gt; 0</code> suggest the system is reactive, whereby a
perturbation of the system in one period can be amplified in the next period. If
\(\sigma_{max}(A)\) is the largest singular value of \(A\), then reactivity is defined as:
$$
    log\sigma_{max}(A) \quad
    $$</p></li>
<li><p><code>mean_return_rate</code>: Asymptotic (long-term) return rate of the mean of the transition distribution
to the stationary mean, calculated using the largest eigenvalue of the matrix \(A\):
$$
   max(\lambda_{A}) \quad
   $$
Lower values suggest greater stability</p></li>
<li><p><code>var_return_rate</code>: Asymptotic (long-term) return rate of the variance of the transition distribution
to the stationary variance:
$$
   max(\lambda_{A \otimes{A}}) \quad
   $$
Again, lower values suggest greater stability</p></li>
</ul><p>Major advantages of using <span class="pkg">mvgam</span> to compute these metrics are that well-calibrated uncertainties are
available and that VAR processes are forced to be stationary. These properties make it simple and
insightful to calculate and inspect aspects of both long-term and short-term stability.
But it is also possible to more directly inspect possible interactions among the
time series in a latent VAR process. To do so, you can calculate and plot
Generalized or Orthogonalized Impulse Response Functions using the <code><a href="irf.mvgam.html">irf</a></code> function.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>AR Ives, B Dennis, KL Cottingham &amp; SR Carpenter (2003).
Estimating community stability and ecological interactions from time-series data.
Ecological Monographs. 73, 301-330.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="RW.html">VAR</a></code>, <code><a href="irf.mvgam.html">irf</a></code>, <code><a href="fevd.mvgam.html">fevd</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Nicholas J Clark</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co"># Simulate some time series that follow a latent VAR(1) process</span></span></span>
<span class="r-in"><span><span class="va">simdat</span> <span class="op">&lt;-</span> <span class="fu"><a href="sim_mvgam.html">sim_mvgam</a></span><span class="op">(</span>family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">gaussian</a></span><span class="op">(</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                    n_series <span class="op">=</span> <span class="fl">4</span>,</span></span>
<span class="r-in"><span>                    trend_model <span class="op">=</span> <span class="fu"><a href="RW.html">VAR</a></span><span class="op">(</span>cor <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                    prop_trend <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="plot_mvgam_series.html">plot_mvgam_series</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">simdat</span><span class="op">$</span><span class="va">data_train</span>, series <span class="op">=</span> <span class="st">'all'</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="stability.mvgam-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Fit a model that uses a latent VAR(1)</span></span></span>
<span class="r-in"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="mvgam.html">mvgam</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="op">-</span><span class="fl">1</span>,</span></span>
<span class="r-in"><span>             trend_formula <span class="op">=</span> <span class="op">~</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>             trend_model <span class="op">=</span> <span class="fu"><a href="RW.html">VAR</a></span><span class="op">(</span>cor <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>             family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">gaussian</a></span><span class="op">(</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>             data <span class="op">=</span> <span class="va">simdat</span><span class="op">$</span><span class="va">data_train</span>,</span></span>
<span class="r-in"><span>             silent <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> In file included from stan/lib/stan_math/stan/math/prim/prob/von_mises_lccdf.hpp:5,</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>                  from stan/lib/stan_math/stan/math/prim/prob/von_mises_ccdf_log.hpp:4,</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>                  from stan/lib/stan_math/stan/math/prim/prob.hpp:359,</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>                  from stan/lib/stan_math/stan/math/prim.hpp:16,</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>                  from stan/lib/stan_math/stan/math/rev.hpp:16,</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>                  from stan/lib/stan_math/stan/math.hpp:19,</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>                  from stan/src/stan/model/model_header.hpp:4,</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>                  from C:/Users/uqnclar2/AppData/Local/Temp/Rtmp2bnpq5/model-3cd07f564707.hpp:2:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> stan/lib/stan_math/stan/math/prim/prob/von_mises_cdf.hpp: In function 'stan::return_type_t&lt;T_x, T_sigma, T_l&gt; stan::math::von_mises_cdf(const T_x&amp;, const T_mu&amp;, const T_k&amp;)':</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> stan/lib/stan_math/stan/math/prim/prob/von_mises_cdf.hpp:194: note: '-Wmisleading-indentation' is disabled from this point onwards, since column-tracking was disabled due to the size of the code/headers</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   194 |       if (cdf_n &lt; 0.0)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>       | </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> stan/lib/stan_math/stan/math/prim/prob/von_mises_cdf.hpp:194: note: adding '-flarge-source-files' will allow for more column-tracking support, at the expense of compilation time and memory</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Calulate stability metrics for this system</span></span></span>
<span class="r-in"><span><span class="va">metrics</span> <span class="op">&lt;-</span> <span class="fu">stability</span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Proportion of stationary forecast distribution</span></span></span>
<span class="r-in"><span><span class="co"># attributable to lagged interactions</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">metrics</span><span class="op">$</span><span class="va">prop_int</span>,</span></span>
<span class="r-in"><span>     xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>     xlab <span class="op">=</span> <span class="st">'Prop_int'</span>,</span></span>
<span class="r-in"><span>     main <span class="op">=</span> <span class="st">''</span>,</span></span>
<span class="r-in"><span>     col <span class="op">=</span> <span class="st">'#B97C7C'</span>,</span></span>
<span class="r-in"><span>     border <span class="op">=</span> <span class="st">'white'</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="stability.mvgam-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Within this contribution of interactions, how important</span></span></span>
<span class="r-in"><span><span class="co"># are inter-series interactions (offdiagonals of the A matrix) vs</span></span></span>
<span class="r-in"><span><span class="co"># intra-series density dependence (diagonals of the A matrix)?</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/layout.html" class="external-link">layout</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">metrics</span><span class="op">$</span><span class="va">prop_int_offdiag</span>,</span></span>
<span class="r-in"><span>     xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>     xlab <span class="op">=</span> <span class="st">''</span>,</span></span>
<span class="r-in"><span>     main <span class="op">=</span> <span class="st">'Inter-series interactions'</span>,</span></span>
<span class="r-in"><span>     col <span class="op">=</span> <span class="st">'#B97C7C'</span>,</span></span>
<span class="r-in"><span>     border <span class="op">=</span> <span class="st">'white'</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">metrics</span><span class="op">$</span><span class="va">prop_int_diag</span>,</span></span>
<span class="r-in"><span>     xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>     xlab <span class="op">=</span> <span class="st">'Contribution to interaction effect'</span>,</span></span>
<span class="r-in"><span>     main <span class="op">=</span> <span class="st">'Intra-series interactions (density dependence)'</span>,</span></span>
<span class="r-in"><span>     col <span class="op">=</span> <span class="st">'darkblue'</span>,</span></span>
<span class="r-in"><span>     border <span class="op">=</span> <span class="st">'white'</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="stability.mvgam-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/layout.html" class="external-link">layout</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># How important are inter-series error covariances</span></span></span>
<span class="r-in"><span><span class="co"># (offdiagonals of the Sigma matrix) vs</span></span></span>
<span class="r-in"><span><span class="co"># intra-series variances (diagonals of the Sigma matrix) for explaining</span></span></span>
<span class="r-in"><span><span class="co"># the variance of the stationary forecast distribution?</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/layout.html" class="external-link">layout</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, nrow <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">metrics</span><span class="op">$</span><span class="va">prop_cov_offdiag</span>,</span></span>
<span class="r-in"><span>     xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>     xlab <span class="op">=</span> <span class="st">''</span>,</span></span>
<span class="r-in"><span>     main <span class="op">=</span> <span class="st">'Inter-series covariances'</span>,</span></span>
<span class="r-in"><span>     col <span class="op">=</span> <span class="st">'#B97C7C'</span>,</span></span>
<span class="r-in"><span>     border <span class="op">=</span> <span class="st">'white'</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">metrics</span><span class="op">$</span><span class="va">prop_cov_diag</span>,</span></span>
<span class="r-in"><span>     xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>     xlab <span class="op">=</span> <span class="st">'Contribution to forecast variance'</span>,</span></span>
<span class="r-in"><span>     main <span class="op">=</span> <span class="st">'Intra-series variances'</span>,</span></span>
<span class="r-in"><span>     col <span class="op">=</span> <span class="st">'darkblue'</span>,</span></span>
<span class="r-in"><span>     border <span class="op">=</span> <span class="st">'white'</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="stability.mvgam-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/layout.html" class="external-link">layout</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Reactivity, i.e. degree to which the system moves</span></span></span>
<span class="r-in"><span><span class="co"># away from a stable equilibrium following a perturbation</span></span></span>
<span class="r-in"><span><span class="co"># (values &gt; 1 suggest a more reactive, less stable system)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">metrics</span><span class="op">$</span><span class="va">reactivity</span>,</span></span>
<span class="r-in"><span>     main <span class="op">=</span> <span class="st">''</span>,</span></span>
<span class="r-in"><span>     xlab <span class="op">=</span> <span class="st">'Reactivity'</span>,</span></span>
<span class="r-in"><span>     col <span class="op">=</span> <span class="st">'#B97C7C'</span>,</span></span>
<span class="r-in"><span>     border <span class="op">=</span> <span class="st">'white'</span>,</span></span>
<span class="r-in"><span>     xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">metrics</span><span class="op">$</span><span class="va">reactivity</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>              <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">metrics</span><span class="op">$</span><span class="va">reactivity</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v <span class="op">=</span> <span class="fl">0</span>, lwd <span class="op">=</span> <span class="fl">2.5</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="stability.mvgam-5.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by <a href="https://researchers.uq.edu.au/researcher/15140" class="external-link">Nicholas J Clark</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

