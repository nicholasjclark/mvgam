<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="This function plots posterior empirical quantiles for a series-specific
smooth term"><title>Plot smooth terms from mvgam models — plot_mvgam_smooth • mvgam</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Plot smooth terms from mvgam models — plot_mvgam_smooth"><meta property="og:description" content="This function plots posterior empirical quantiles for a series-specific
smooth term"><meta property="og:image" content="https://nicholasjclark.github.io/mvgam/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary" data-bs-theme="dark"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">mvgam</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.593</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/data_in_mvgam.html">Formatting data for use in mvgam</a>
    <a class="dropdown-item" href="../articles/forecast_evaluation.html">Forecasting and forecast evaluation in mvgam</a>
    <a class="dropdown-item" href="../articles/mvgam_overview.html">Overview of the mvgam package</a>
    <a class="dropdown-item" href="../articles/nmixtures.html">N-mixtures in mvgam</a>
    <a class="dropdown-item" href="../articles/shared_states.html">Shared latent states in mvgam</a>
    <a class="dropdown-item" href="../articles/time_varying_effects.html">Time-varying effects in mvgam</a>
    <a class="dropdown-item" href="../articles/trend_formulas.html">State-Space models in mvgam</a>
  </div>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/nicholasjclark/mvgam/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Plot smooth terms from <span class="pkg">mvgam</span> models</h1>
      <small class="dont-index">Source: <a href="https://github.com/nicholasjclark/mvgam/blob/HEAD/R/plot_mvgam_smooth.R" class="external-link"><code>R/plot_mvgam_smooth.R</code></a></small>
      <div class="d-none name"><code>plot_mvgam_smooth.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function plots posterior empirical quantiles for a series-specific
smooth term</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">plot_mvgam_smooth</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  trend_effects <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  series <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  <span class="va">smooth</span>,</span>
<span>  residuals <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  n_resid_bins <span class="op">=</span> <span class="fl">25</span>,</span>
<span>  realisations <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  n_realisations <span class="op">=</span> <span class="fl">15</span>,</span>
<span>  derivatives <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">newdata</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>object</dt>
<dd><p><code>list</code> object of class <code>mvgam</code>. See <code><a href="mvgam.html">mvgam()</a></code></p></dd>


<dt>trend_effects</dt>
<dd><p>logical. If <code>TRUE</code> and a <code>trend_formula</code> was used in
model fitting, terms from the trend (i.e. process) model will be plotted</p></dd>


<dt>series</dt>
<dd><p><code>integer</code> specifying which series in the set is to be
plotted</p></dd>


<dt>smooth</dt>
<dd><p>Either a <code>character</code> or <code>integer</code> specifying which
smooth term to be plotted</p></dd>


<dt>residuals</dt>
<dd><p><code>logical</code>. If <code>TRUE</code>, posterior quantiles of
partial residuals are added to plots of 1-D smooths as a series of ribbon
rectangles. Partial residuals for a smooth term are the median Dunn-Smyth
residuals that would be obtained by dropping the term concerned from the
model, while leaving all other estimates fixed (i.e. the estimates for the
term plus the original median Dunn-Smyth residuals). Note that because
<code>mvgam</code> works with Dunn-Smyth residuals and not working residuals,
which are used by <code>mgcv</code>, the magnitudes of partial residuals will be
different to what you would expect from <code><a href="https://rdrr.io/pkg/mgcv/man/plot.gam.html" class="external-link">plot.gam</a></code>.
Interpretation is similar though, as these partial residuals should be
evenly scattered around the smooth function if the function is well
estimated</p></dd>


<dt>n_resid_bins</dt>
<dd><p><code>integer</code> specifying the number of bins to group
the covariate into when plotting partial residuals. Setting this argument
too high can make for messy plots that are difficult to interpret, while
setting it too low will likely mask some potentially useful patterns in
the partial residuals. Default is <code>25</code></p></dd>


<dt>realisations</dt>
<dd><p><code>logical</code>. If <code>TRUE</code>, posterior realisations
are shown as a spaghetti plot, making it easier to visualise the diversity
of possible functions. If <code>FALSE</code>, the default, empirical quantiles
of the posterior distribution are shown</p></dd>


<dt>n_realisations</dt>
<dd><p><code>integer</code> specifying the number of posterior
realisations to plot, if <code>realisations = TRUE</code>. Ignored otherwise</p></dd>


<dt>derivatives</dt>
<dd><p><code>logical</code>. If <code>TRUE</code>, an additional plot will
be returned to show the estimated 1st derivative for the specified smooth
(Note: this only works for univariate smooths)</p></dd>


<dt>newdata</dt>
<dd><p>Optional <code>dataframe</code> for predicting the smooth,
containing at least 'series' in addition to any other variables included
in the linear predictor of the original model's <code>formula</code>. Note that
this currently is only supported for plotting univariate smooths</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A base <code>R</code> graphics plot</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Smooth functions are shown as empirical quantiles (or spaghetti
plots) of posterior partial expectations across a sequence of values
between the variable's <code>min</code> and <code>max</code>, while zeroing out
effects of all other variables. At present, only univariate and bivariate
smooth plots are allowed, though note that bivariate smooths rely on
default behaviour from <code><a href="https://rdrr.io/pkg/mgcv/man/plot.gam.html" class="external-link">plot.gam</a></code>. <code>plot_mvgam_smooth</code>
generates posterior predictions from an object of class <code>mvgam</code>,
calculates posterior empirical quantiles and plots them. If
<code>realisations = FALSE</code>, the returned plot shows 90, 60, 40 and 20 percent
posterior quantiles (as ribbons of increasingly darker shades of red) as
well as the posterior median (as a dark red line). If
<code>realisations = TRUE</code>, a set of <code>n_realisations</code> posterior draws are
shown. For more nuanced visualisation, supply <code>newdata</code> just as you
would when predicting from a <code><a href="https://rdrr.io/pkg/mgcv/man/gam.html" class="external-link">gam</a></code> model or use the more
flexible <code><a href="conditional_effects.mvgam.html">conditional_effects.mvgam</a></code>. Alternatively, if you
prefer to use partial effect plots in the style of <code>gratia</code>, and if you
have the <code>gratia</code> package installed, you can use <code>draw.mvgam</code>. See
<code><a href="gratia_mvgam_enhancements.html">gratia_mvgam_enhancements</a></code> for details.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/pkg/mgcv/man/plot.gam.html" class="external-link">plot.gam</a></code>,
<code><a href="conditional_effects.mvgam.html">conditional_effects.mvgam</a></code>,
<code><a href="gratia_mvgam_enhancements.html">gratia_mvgam_enhancements</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Nicholas J Clark</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://researchers.uq.edu.au/researcher/15140" class="external-link">Nicholas J Clark</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer></div>

  

  

  </body></html>

