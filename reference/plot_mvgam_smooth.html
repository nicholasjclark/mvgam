<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Plot smooth terms from mvgam models — plot_mvgam_smooth • mvgam</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Plot smooth terms from mvgam models — plot_mvgam_smooth"><meta name="description" content="This function plots posterior empirical quantiles for a series-specific smooth term"><meta property="og:description" content="This function plots posterior empirical quantiles for a series-specific smooth term"><meta property="og:image" content="https://nicholasjclark.github.io/mvgam/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">mvgam</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.5001</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/data_in_mvgam.html">Formatting data for use in mvgam</a></li>
    <li><a class="dropdown-item" href="../articles/forecast_evaluation.html">Forecasting and forecast evaluation in mvgam</a></li>
    <li><a class="dropdown-item" href="../articles/mvgam_overview.html">Overview of the mvgam package</a></li>
    <li><a class="dropdown-item" href="../articles/nmixtures.html">N-mixtures in mvgam</a></li>
    <li><a class="dropdown-item" href="../articles/shared_states.html">Shared latent states in mvgam</a></li>
    <li><a class="dropdown-item" href="../articles/time_varying_effects.html">Time-varying effects in mvgam</a></li>
    <li><a class="dropdown-item" href="../articles/trend_formulas.html">State-Space models in mvgam</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/nicholasjclark/mvgam/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Plot smooth terms from <span class="pkg">mvgam</span> models</h1>
      <small class="dont-index">Source: <a href="https://github.com/nicholasjclark/mvgam/blob/master/R/plot_mvgam_smooth.R" class="external-link"><code>R/plot_mvgam_smooth.R</code></a></small>
      <div class="d-none name"><code>plot_mvgam_smooth.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function plots posterior empirical quantiles for a series-specific smooth term</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">plot_mvgam_smooth</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  trend_effects <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  series <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  <span class="va">smooth</span>,</span>
<span>  residuals <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  n_resid_bins <span class="op">=</span> <span class="fl">25</span>,</span>
<span>  realisations <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  n_realisations <span class="op">=</span> <span class="fl">15</span>,</span>
<span>  derivatives <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">newdata</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p><code>list</code> object of class <code>mvgam</code>. See <code><a href="mvgam.html">mvgam()</a></code></p></dd>


<dt id="arg-trend-effects">trend_effects<a class="anchor" aria-label="anchor" href="#arg-trend-effects"></a></dt>
<dd><p>logical. If <code>TRUE</code> and a <code>trend_formula</code> was used in model
fitting, terms from the trend (i.e. process) model will be plotted</p></dd>


<dt id="arg-series">series<a class="anchor" aria-label="anchor" href="#arg-series"></a></dt>
<dd><p><code>integer</code> specifying which series in the set is to be plotted</p></dd>


<dt id="arg-smooth">smooth<a class="anchor" aria-label="anchor" href="#arg-smooth"></a></dt>
<dd><p>either a <code>character</code> or <code>integer</code> specifying which smooth term to be plotted</p></dd>


<dt id="arg-residuals">residuals<a class="anchor" aria-label="anchor" href="#arg-residuals"></a></dt>
<dd><p><code>logical</code>. If <code>TRUE</code> then posterior quantiles of partial residuals are added
to plots of 1-D smooths as a series of ribbon rectangles.
Partial residuals for a smooth term are the median Dunn-Smyth residuals that would be obtained by dropping the term
concerned from the model, while leaving all other estimates fixed (i.e. the
estimates for the term plus the original median Dunn-Smyth residuals). Note that because <code>mvgam</code> works with
Dunn-Smyth residuals and not working residuals, which are used by <code>mgcv</code>, the magnitudes of
partial residuals will be different to what you would expect from <code><a href="https://rdrr.io/pkg/mgcv/man/plot.gam.html" class="external-link">plot.gam</a></code>. Interpretation
is similar though, as these partial residuals should be evenly scattered
around the smooth function if the function is well estimated</p></dd>


<dt id="arg-n-resid-bins">n_resid_bins<a class="anchor" aria-label="anchor" href="#arg-n-resid-bins"></a></dt>
<dd><p><code>integer</code> specifying the number of bins group the covariate into when plotting partial residuals.
Setting this argument too high can make for messy plots that are difficult to interpret, while setting it too
low will likely mask some potentially useful patterns in the partial residuals. Default is <code>25</code></p></dd>


<dt id="arg-realisations">realisations<a class="anchor" aria-label="anchor" href="#arg-realisations"></a></dt>
<dd><p><code>logical</code>. If <code>TRUE</code>, posterior realisations are shown as a spaghetti plot,
making it easier to visualise the diversity of possible functions. If <code>FALSE</code>, the default,
empirical quantiles of the posterior distribution are shown</p></dd>


<dt id="arg-n-realisations">n_realisations<a class="anchor" aria-label="anchor" href="#arg-n-realisations"></a></dt>
<dd><p><code>integer</code> specifying the number of posterior realisations to plot, if
<code>realisations = TRUE</code>. Ignored otherwise</p></dd>


<dt id="arg-derivatives">derivatives<a class="anchor" aria-label="anchor" href="#arg-derivatives"></a></dt>
<dd><p><code>logical</code>. If <code>TRUE</code>, an additional plot will be returned to show the
estimated 1st derivative for the specified smooth (Note, this only works for univariate smooths)</p></dd>


<dt id="arg-newdata">newdata<a class="anchor" aria-label="anchor" href="#arg-newdata"></a></dt>
<dd><p>Optional <code>dataframe</code> for predicting the smooth, containing at least 'series'
in addition to any other variables included in the linear predictor of the original model's <code>formula</code>.
Note that this currently is only supported for plotting univariate smooths</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A base <code>R</code> graphics plot</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Smooth functions are shown as empirical quantiles (or spaghetti plots) of posterior partial expectations
across a sequence of values between the variable's <code>min</code> and <code>max</code>,
while zeroing out effects of all other variables. At present, only univariate and bivariate smooth plots
are allowed, though note that bivariate smooths rely on default behaviour from
<code><a href="https://rdrr.io/pkg/mgcv/man/plot.gam.html" class="external-link">plot.gam</a></code>. <code>plot_mvgam_smooth</code> generates posterior predictions from an
object of class <code>mvgam</code>, calculates posterior empirical quantiles and plots them.
If <code>realisations = FALSE</code>, the returned plot shows 90, 60, 40 and 20 percent posterior
quantiles (as ribbons of increasingly darker shades or red) as well as the posterior
median (as a dark red line). If <code>realisations = FALSE</code>, a set of <code>n_realisations</code> posterior
draws are shown. For more nuanced visualisation, supply
<code>newdata</code> just as you would when predicting from a <code><a href="https://rdrr.io/pkg/mgcv/man/gam.html" class="external-link">gam</a></code> model or use the more flexible <code><a href="conditional_effects.mvgam.html">conditional_effects.mvgam</a></code>. Alternatively, if you prefer to use partial
effect plots in the style of <code>gratia</code>, and if you have the <code>gratia</code> package installed, you can
use <code>draw.mvgam</code>. See <code><a href="gratia_mvgam_enhancements.html">gratia_mvgam_enhancements</a></code> for details.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/pkg/mgcv/man/plot.gam.html" class="external-link">plot.gam</a></code>, <code><a href="conditional_effects.mvgam.html">conditional_effects.mvgam</a></code>,
<code><a href="gratia_mvgam_enhancements.html">gratia_mvgam_enhancements</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Nicholas J Clark</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://researchers.uq.edu.au/researcher/15140" class="external-link">Nicholas J Clark</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.9000.</p>
</div>

    </footer></div>





  </body></html>

