<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="This function sets up a Joint Species Distribution Model whereby the residual
associations among species can be modelled in a reduced-rank format using a
set of latent factors. The factor specification is extremely flexible,
allowing users to include spatial, temporal or any other type of predictor
effects to more efficiently capture unmodelled residual associations, while
the observation model can also be highly flexible (including all smooth, GP
and other effects that mvgam can handle)"><title>Fit Joint Species Distribution Models in mvgam — jsdgam • mvgam</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Fit Joint Species Distribution Models in mvgam — jsdgam"><meta property="og:description" content="This function sets up a Joint Species Distribution Model whereby the residual
associations among species can be modelled in a reduced-rank format using a
set of latent factors. The factor specification is extremely flexible,
allowing users to include spatial, temporal or any other type of predictor
effects to more efficiently capture unmodelled residual associations, while
the observation model can also be highly flexible (including all smooth, GP
and other effects that mvgam can handle)"><meta property="og:image" content="https://nicholasjclark.github.io/mvgam/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary" data-bs-theme="dark"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">mvgam</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.594</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/data_in_mvgam.html">Formatting data for use in mvgam</a>
    <a class="dropdown-item" href="../articles/forecast_evaluation.html">Forecasting and forecast evaluation in mvgam</a>
    <a class="dropdown-item" href="../articles/mvgam_overview.html">Overview of the mvgam package</a>
    <a class="dropdown-item" href="../articles/nmixtures.html">N-mixtures in mvgam</a>
    <a class="dropdown-item" href="../articles/shared_states.html">Shared latent states in mvgam</a>
    <a class="dropdown-item" href="../articles/time_varying_effects.html">Time-varying effects in mvgam</a>
    <a class="dropdown-item" href="../articles/trend_formulas.html">State-Space models in mvgam</a>
  </div>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/nicholasjclark/mvgam/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Fit Joint Species Distribution Models in <span class="pkg">mvgam</span></h1>
      <small class="dont-index">Source: <a href="https://github.com/nicholasjclark/mvgam/blob/HEAD/R/jsdgam.R" class="external-link"><code>R/jsdgam.R</code></a></small>
      <div class="d-none name"><code>jsdgam.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function sets up a Joint Species Distribution Model whereby the residual
associations among species can be modelled in a reduced-rank format using a
set of latent factors. The factor specification is extremely flexible,
allowing users to include spatial, temporal or any other type of predictor
effects to more efficiently capture unmodelled residual associations, while
the observation model can also be highly flexible (including all smooth, GP
and other effects that <span class="pkg">mvgam</span> can handle)</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">jsdgam</span><span class="op">(</span></span>
<span>  <span class="va">formula</span>,</span>
<span>  factor_formula <span class="op">=</span> <span class="op">~</span><span class="op">-</span><span class="fl">1</span>,</span>
<span>  <span class="va">knots</span>,</span>
<span>  <span class="va">factor_knots</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">newdata</span>,</span>
<span>  family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">poisson</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  unit <span class="op">=</span> <span class="va">time</span>,</span>
<span>  species <span class="op">=</span> <span class="va">series</span>,</span>
<span>  share_obs_params <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">priors</span>,</span>
<span>  n_lv <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  backend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"brms.backend"</span>, <span class="st">"cmdstanr"</span><span class="op">)</span>,</span>
<span>  algorithm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"brms.algorithm"</span>, <span class="st">"sampling"</span><span class="op">)</span>,</span>
<span>  control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>max_treedepth <span class="op">=</span> <span class="fl">10</span>, adapt_delta <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span>,</span>
<span>  chains <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  burnin <span class="op">=</span> <span class="fl">500</span>,</span>
<span>  samples <span class="op">=</span> <span class="fl">500</span>,</span>
<span>  thin <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  parallel <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  threads <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  silent <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  run_model <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  return_model_data <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  residuals <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>formula</dt>
<dd><p>A <code>formula</code> object specifying the GAM observation model
formula. These are exactly like the formula for a GLM except that smooth
terms, <code><a href="https://rdrr.io/pkg/mgcv/man/s.html" class="external-link">s()</a></code>, <code><a href="https://rdrr.io/pkg/mgcv/man/te.html" class="external-link">te()</a></code>, <code><a href="https://rdrr.io/pkg/mgcv/man/te.html" class="external-link">ti()</a></code>, <code><a href="https://rdrr.io/pkg/mgcv/man/t2.html" class="external-link">t2()</a></code>, as well as time-varying <code><a href="dynamic.html">dynamic()</a></code>
terms, nonparametric <code><a href="https://paulbuerkner.com/brms/reference/gp.html" class="external-link">gp()</a></code> terms and offsets using <code><a href="https://rdrr.io/r/stats/offset.html" class="external-link">offset()</a></code>, can be
added to the right hand side to specify that the linear predictor depends
on smooth functions of predictors (or linear functionals of these).
Details of the formula syntax used by <span class="pkg">mvgam</span> can be found in
<code><a href="mvgam_formulae.html">mvgam_formulae</a></code></p></dd>


<dt>factor_formula</dt>
<dd><p>A <code>formula</code> object specifying the linear predictor
effects for the latent factors. Use <code>by = trend</code> within calls to functional
terms (i.e. <code><a href="https://rdrr.io/pkg/mgcv/man/s.html" class="external-link">s()</a></code>, <code><a href="https://rdrr.io/pkg/mgcv/man/te.html" class="external-link">te()</a></code>, <code><a href="https://rdrr.io/pkg/mgcv/man/te.html" class="external-link">ti()</a></code>, <code><a href="https://rdrr.io/pkg/mgcv/man/t2.html" class="external-link">t2()</a></code>, <code><a href="dynamic.html">dynamic()</a></code>, or <code><a href="https://paulbuerkner.com/brms/reference/gp.html" class="external-link">gp()</a></code>) to
ensure that each factor captures a different axis of variation. See the
example below as an illustration</p></dd>


<dt>knots</dt>
<dd><p>An optional <code>list</code> containing user specified knot values for
basis construction. For most bases the user simply supplies the knots to be
used, which must match up with the <code>k</code> value supplied. Different terms can
use different numbers of knots, unless they share a covariate.</p></dd>


<dt>factor_knots</dt>
<dd><p>An optional <code>list</code> containing user specified knot
values to be used for basis construction of any smooth terms in
<code>factor_formula</code>. For most bases the user simply supplies the knots to be
used, which must match up with the <code>k</code> value supplied (note that the
number of knots is not always just <code>k</code>). Different terms can use different
numbers of knots, unless they share a covariate</p></dd>


<dt>data</dt>
<dd><p>A <code>dataframe</code> or <code>list</code> containing the model response
variable and covariates required by the GAM <code>formula</code> and
<code>factor_formula</code> objects</p></dd>


<dt>newdata</dt>
<dd><p>Optional <code>dataframe</code> or <code>list</code> of test data containing the same
variables as in <code>data</code>. If included, observations in variable <code>y</code> will be
set to <code>NA</code> when fitting the model so that posterior simulations can be obtained.</p></dd>


<dt>family</dt>
<dd><p><code>family</code> specifying the observation family for the
outcomes. Currently supported families are:</p><ul><li><p><code><a href="https://rdrr.io/r/stats/family.html" class="external-link">gaussian()</a></code> for real-valued data</p></li>
<li><p><code><a href="mvgam_families.html">betar()</a></code> for proportional data on <code>(0,1)</code></p></li>
<li><p><code><a href="mvgam_families.html">lognormal()</a></code> for non-negative real-valued data</p></li>
<li><p><code><a href="mvgam_families.html">student_t()</a></code> for real-valued data</p></li>
<li><p><code><a href="https://rdrr.io/r/stats/family.html" class="external-link">Gamma()</a></code> for non-negative real-valued data</p></li>
<li><p><code><a href="mvgam_families.html">bernoulli()</a></code> for binary data</p></li>
<li><p><code><a href="https://rdrr.io/r/stats/family.html" class="external-link">poisson()</a></code> for count data</p></li>
<li><p><code><a href="mvgam_families.html">nb()</a></code> for overdispersed count data</p></li>
<li><p><code><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial()</a></code> for count data with imperfect detection when the number
of trials is known; note that the <code><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind()</a></code> function must be used to
bind the discrete observations and the discrete number of trials</p></li>
<li><p><code><a href="mvgam_families.html">beta_binomial()</a></code> as for <code><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial()</a></code> but allows for overdispersion</p></li>
</ul><p>Default is <code><a href="https://rdrr.io/r/stats/family.html" class="external-link">poisson()</a></code>. See <code><a href="mvgam_families.html">mvgam_families</a></code> for more details</p></dd>


<dt>unit</dt>
<dd><p>The unquoted name of the variable that represents the unit of
analysis in <code>data</code> over which latent residuals should be correlated. This
variable should be either a <code>numeric</code> or <code>integer</code> variable in the
supplied <code>data</code>. Defaults to <code>time</code> to be consistent with other
functionalities in <span class="pkg">mvgam</span>, though note that the data need not be time
series in this case. See examples below for further details and
explanations</p></dd>


<dt>species</dt>
<dd><p>The unquoted name of the <code>factor</code> variable that indexes the
different response units in <code>data</code> (usually <code>'species'</code> in a JSDM).
Defaults to <code>series</code> to be consistent with other <code>mvgam</code> models</p></dd>


<dt>share_obs_params</dt>
<dd><p><code>logical</code>. If <code>TRUE</code> and the <code>family</code> has additional
family-specific observation parameters (e.g., variance components, dispersion
parameters), these will be shared across all outcome variables. Useful when
multiple outcomes share properties. Default is <code>FALSE</code>.</p></dd>


<dt>priors</dt>
<dd><p>An optional <code>data.frame</code> with prior definitions (in Stan
syntax) or, preferentially, a vector containing objects of class
<code>brmsprior</code> (see. <code><a href="https://paulbuerkner.com/brms/reference/set_prior.html" class="external-link">prior</a></code> for details). See
<a href="get_mvgam_priors.html">get_mvgam_priors</a> and for more information on changing default prior
distributions</p></dd>


<dt>n_lv</dt>
<dd><p><code>integer</code> the number of latent factors to use for modelling
residual associations. Cannot be <code>&gt; n_species</code>. Defaults arbitrarily to <code>2</code></p></dd>


<dt>backend</dt>
<dd><p>Character string naming the package for Stan model fitting.
Options are <code>"cmdstanr"</code> (default) or <code>"rstan"</code>. Can be set globally via
<code>"brms.backend"</code> option. See https://mc-stan.org/rstan/ and
https://mc-stan.org/cmdstanr/ for details.</p></dd>


<dt>algorithm</dt>
<dd><p>Character string naming the estimation approach:</p><ul><li><p><code>"sampling"</code>: MCMC (default)</p></li>
<li><p><code>"meanfield"</code>: Variational inference with factorized normal distributions</p></li>
<li><p><code>"fullrank"</code>: Variational inference with multivariate normal distribution</p></li>
<li><p><code>"laplace"</code>: Laplace approximation (cmdstanr only)</p></li>
<li><p><code>"pathfinder"</code>: Pathfinder algorithm (cmdstanr only)</p></li>
</ul><p>Can be set globally via <code>"brms.algorithm"</code> option. Limited testing suggests
<code>"meanfield"</code> performs best among non-MCMC approximations for dynamic GAMs.</p></dd>


<dt>control</dt>
<dd><p>Named <code>list</code> for controlling sampler behaviour. Valid elements
include <code>max_treedepth</code>, <code>adapt_delta</code> and <code>init</code>.</p></dd>


<dt>chains</dt>
<dd><p><code>integer</code> specifying the number of parallel chains for the model.
Ignored for variational inference algorithms.</p></dd>


<dt>burnin</dt>
<dd><p><code>integer</code> specifying the number of warmup iterations to tune
sampling algorithms. Ignored for variational inference algorithms.</p></dd>


<dt>samples</dt>
<dd><p><code>integer</code> specifying the number of post-warmup iterations for
sampling the posterior distribution.</p></dd>


<dt>thin</dt>
<dd><p>Thinning interval for monitors. Ignored for variational inference
algorithms.</p></dd>


<dt>parallel</dt>
<dd><p><code>logical</code> specifying whether to use multiple cores for parallel
MCMC simulation. If <code>TRUE</code>, uses <code>min(c(chains, parallel::detectCores() - 1))</code> cores.</p></dd>


<dt>threads</dt>
<dd><p><code>integer</code> Experimental option to use multithreading for
within-chain parallelisation in <code>Stan</code>. We recommend its use only if
you are experienced with <code>Stan</code>'s <code>reduce_sum</code> function and have a
slow running model that cannot be sped up by any other means. Currently
works for all families when using <span class="pkg">cmdstanr</span> as the backend</p></dd>


<dt>silent</dt>
<dd><p>Verbosity level between <code>0</code> and <code>2</code>. If <code>1</code> (default), most
informational messages are suppressed. If <code>2</code>, even more messages are
suppressed. Sampling progress is still printed - set <code>refresh = 0</code> to
disable. For <code>backend = "rstan"</code>, also set <code>open_progress = FALSE</code> to
prevent additional progress bars.</p></dd>


<dt>run_model</dt>
<dd><p><code>logical</code>. If <code>FALSE</code>, the model is not fitted but instead
the function returns the model file and the data/initial values needed to
fit the model outside of <code>mvgam</code>.</p></dd>


<dt>return_model_data</dt>
<dd><p><code>logical</code>. If <code>TRUE</code>, the list of data needed to fit
the model is returned, along with initial values for smooth and AR parameters,
once the model is fitted. Helpful for users who wish to modify the model file
to add other stochastic elements. Default is <code>FALSE</code> unless <code>run_model == FALSE</code>.</p></dd>


<dt>residuals</dt>
<dd><p><code>logical</code>. Whether to compute series-level randomized quantile
residuals. Default is <code>TRUE</code>. Set to <code>FALSE</code> to save time and reduce object
size (can add later using <a href="add_residuals.mvgam.html">add_residuals</a>).</p></dd>


<dt>...</dt>
<dd><p>Other arguments to pass to <a href="mvgam.html">mvgam</a></p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A <code>list</code> object of class <code>mvgam</code> containing model output,
the text representation of the model file, the mgcv model output (for easily
generating simulations at unsampled covariate values), Dunn-Smyth residuals
for each species and key information needed for other functions in the
package. See <code><a href="mvgam-class.html">mvgam-class</a></code> for details. Use
<code>methods(class = "mvgam")</code> for an overview on available methods</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Joint Species Distribution Models allow for responses of multiple
species to be learned hierarchically, whereby responses to environmental
variables in <code>formula</code> can be partially pooled and any latent, unmodelled
residual associations can also be learned. In <span class="pkg">mvgam</span>, both of these
effects can be modelled with the full power of latent factor Hierarchical
GAMs, providing unmatched flexibility to model full communities of species.
When calling jsdgam, an initial State-Space model using <code>trend = 'None'</code> is
set up and then modified to include the latent factors and their linear
predictors. Consequently, you can inspect priors for these models using
<a href="get_mvgam_priors.html">get_mvgam_priors</a> by supplying the relevant <code>formula</code>, <code>factor_formula</code>,
<code>data</code> and <code>family</code> arguments and keeping the default <code>trend = 'None'</code>.</p>
<p>In a JSDGAM, the expectation of response \(Y_{ij}\) is modelled with</p>
<p>$$g(\mu_{ij}) = X_i\beta + u_i\theta_j,$$</p>
<p>where \(g(.)\) is a known link function,
\(X\) is a design matrix of linear predictors (with associated \(\beta\)
coefficients), \(u\) are \(n_{lv}\)-variate latent factors
(\(n_{lv}\)&lt;&lt;\(n_{species}\)) and \(\theta_j\) are species-specific
loadings on the latent factors, respectively. The design matrix \(X\) and
\(\beta\) coefficients are constructed and modelled using <code>formula</code> and
can contain any of <code>mvgam</code>'s predictor effects, including random intercepts
and slopes, multidimensional penalized smooths, GP effects etc... The factor
loadings \(\theta_j\) are constrained for identifiability but can be used
to reconstruct an estimate of the species' residual variance-covariance
matrix using \(\Theta \Theta'\) (see the example below and
<code><a href="residual_cor.jsdgam.html">residual_cor()</a></code> for details). The latent factors are further modelled using:
$$
u_i \sim \text{Normal}(Q_i\beta_{factor}, 1)
$$
where the second design matrix \(Q\) and associated \(\beta_{factor}\)
coefficients are constructed and modelled using <code>factor_formula</code>. Again, the
effects that make up this linear predictor can contain any of <code>mvgam</code>'s
allowed predictor effects, providing enormous flexibility for modelling
species' communities.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Nicholas J Clark &amp; Konstans Wells (2023). Dynamic generalised
additive models (DGAMs) for forecasting discrete ecological time series.
Methods in Ecology and Evolution. 14:3, 771-784.
<br><br>
David I Warton, F Guillaume Blanchet, Robert B O'Hara, Otso Ovaskainen, Sara
Taskinen, Steven C Walker &amp; Francis KC Hui (2015). So many variables: joint
modeling in community ecology. Trends in Ecology &amp; Evolution 30:12, 766-779.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="mvgam.html">mvgam()</a></code>, <code><a href="residual_cor.jsdgam.html">residual_cor()</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Nicholas J Clark</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://researchers.uq.edu.au/researcher/15140" class="external-link">Nicholas J Clark</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer></div>

  

  

  </body></html>

