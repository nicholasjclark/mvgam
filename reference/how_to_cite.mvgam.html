<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Create a brief but fully referenced methods description, along with a useful
list of references, for fitted mvgam and jsdgam models."><title>Generate a methods description for mvgam models — how_to_cite.mvgam • mvgam</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Generate a methods description for mvgam models — how_to_cite.mvgam"><meta property="og:description" content="Create a brief but fully referenced methods description, along with a useful
list of references, for fitted mvgam and jsdgam models."><meta property="og:image" content="https://nicholasjclark.github.io/mvgam/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary" data-bs-theme="dark"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">mvgam</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.595</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/data_in_mvgam.html">Formatting data for use in mvgam</a>
    <a class="dropdown-item" href="../articles/forecast_evaluation.html">Forecasting and forecast evaluation in mvgam</a>
    <a class="dropdown-item" href="../articles/mvgam_overview.html">Overview of the mvgam package</a>
    <a class="dropdown-item" href="../articles/nmixtures.html">N-mixtures in mvgam</a>
    <a class="dropdown-item" href="../articles/shared_states.html">Shared latent states in mvgam</a>
    <a class="dropdown-item" href="../articles/time_varying_effects.html">Time-varying effects in mvgam</a>
    <a class="dropdown-item" href="../articles/trend_formulas.html">State-Space models in mvgam</a>
  </div>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/nicholasjclark/mvgam/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Generate a methods description for <span class="pkg">mvgam</span> models</h1>
      <small class="dont-index">Source: <a href="https://github.com/nicholasjclark/mvgam/blob/HEAD/R/how_to_cite.R" class="external-link"><code>R/how_to_cite.R</code></a></small>
      <div class="d-none name"><code>how_to_cite.mvgam.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Create a brief but fully referenced methods description, along with a useful
list of references, for fitted <code>mvgam</code> and <code>jsdgam</code> models.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">how_to_cite</span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for mvgam</span></span>
<span><span class="fu">how_to_cite</span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>object</dt>
<dd><p><code>list</code> object of class <code>mvgam</code> resulting from a call
to <code><a href="mvgam.html">mvgam()</a></code> or <code><a href="jsdgam.html">jsdgam()</a></code></p></dd>


<dt>...</dt>
<dd><p>ignored</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>An object of class <code>how_to_cite</code> containing a text description
of the methods as well as lists of both primary and additional references.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function uses the model's structure to come up with a very
basic but hopefully useful methods description that can help users to
appropriately acknowledge the hard work of developers and champion open
science. Please do not consider the text returned by this function to be a
completely adequate methods section; it is only meant to get you started.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="https://rdrr.io/r/utils/citation.html" class="external-link">citation</a></code>, <code><a href="mvgam.html">mvgam</a></code>,
<code><a href="jsdgam.html">jsdgam</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Nicholas J Clark</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co">#--------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co"># Simulate 4 time series with hierarchical seasonality</span></span></span>
<span class="r-in"><span><span class="co"># and a VAR(1) dynamic process</span></span></span>
<span class="r-in"><span><span class="co">#--------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">simdat</span> <span class="op">&lt;-</span> <span class="fu"><a href="sim_mvgam.html">sim_mvgam</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  seasonality <span class="op">=</span> <span class="st">'hierarchical'</span>,</span></span>
<span class="r-in"><span>  trend_model <span class="op">=</span> <span class="fu"><a href="RW.html">VAR</a></span><span class="op">(</span>cor <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">gaussian</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Fit an appropriate model</span></span></span>
<span class="r-in"><span><span class="va">mod1</span> <span class="op">&lt;-</span> <span class="fu"><a href="mvgam.html">mvgam</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">y</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html" class="external-link">s</a></span><span class="op">(</span><span class="va">season</span>, bs <span class="op">=</span> <span class="st">'cc'</span>, k <span class="op">=</span> <span class="fl">6</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">simdat</span><span class="op">$</span><span class="va">data_train</span>,</span></span>
<span class="r-in"><span>  family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">gaussian</a></span><span class="op">(</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  trend_model <span class="op">=</span> <span class="fu"><a href="RW.html">VAR</a></span><span class="op">(</span>cor <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  chains <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>  silent <span class="op">=</span> <span class="fl">2</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">how_to_cite</span><span class="op">(</span><span class="va">mod1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Methods text skeleton</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> We used the R package mvgam (version 1.1.595; Clark &amp; Wells, 2023) to</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   construct, fit and interrogate the model. mvgam fits Bayesian</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   State-Space models that can include flexible predictor effects in both</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   the process and observation components by incorporating functionalities</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   from the brms (Burkner 2017), mgcv (Wood 2017) and splines2 (Wang &amp; Yan,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   2023) packages. To encourage stability and prevent forecast variance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   from increasing indefinitely, we enforced stationarity of the Vector</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Autoregressive process following methods described by Heaps (2023) and</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Clark et al. (2025). The mvgam-constructed model and observed data were</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   passed to the probabilistic programming environment Stan (version</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   2.38.0; Carpenter et al. 2017, Stan Development Team 2026), specifically</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   through the cmdstanr interface (Gabry &amp; Cesnovar, 2021). We ran 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Hamiltonian Monte Carlo chains for 500 warmup iterations and 500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   sampling iterations for joint posterior estimation. Rank normalized</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   split Rhat (Vehtari et al. 2021) and effective sample sizes were used to</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   monitor convergence.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Primary references</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Clark, NJ and Wells K (2023). Dynamic Generalized Additive Models</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   (DGAMs) for forecasting discrete ecological time series. Methods in</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Ecology and Evolution, 14, 771-784. doi.org/10.1111/2041-210X.13974</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Burkner, PC (2017). brms: An R Package for Bayesian Multilevel Models</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Using Stan. Journal of Statistical Software, 80(1), 1-28.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   doi:10.18637/jss.v080.i01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Wood, SN (2017). Generalized Additive Models: An Introduction with R</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   (2nd edition). Chapman and Hall/CRC.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Wang W and Yan J (2021). Shape-Restricted Regression Splines with R</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Package splines2. Journal of Data Science, 19(3), 498-517.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   doi:10.6339/21-JDS1020 https://doi.org/10.6339/21-JDS1020.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Heaps, SE (2023). Enforcing stationarity through the prior in vector</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   autoregressions. Journal of Computational and Graphical Statistics 32,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   74-83.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Clark NJ, Ernest SKM, Senyondo H, Simonis J, White EP, Yenni GM,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Karunarathna KANK (2025). Beyond single-species models: leveraging</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   multispecies forecasts to navigate the dynamics of ecological</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   predictability. PeerJ 13:e18929.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Carpenter B, Gelman A, Hoffman MD, Lee D, Goodrich B, Betancourt M,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Brubaker M, Guo J, Li P and Riddell A (2017). Stan: A probabilistic</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   programming language. Journal of Statistical Software 76.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Gabry J, Cesnovar R, Johnson A, and Bronder S (2026). cmdstanr: R</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Interface to 'CmdStan'. https://mc-stan.org/cmdstanr/,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   https://discourse.mc-stan.org.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Vehtari A, Gelman A, Simpson D, Carpenter B, and Burkner P (2021).</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Rank-normalization, folding, and localization: An improved Rhat for</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   assessing convergence of MCMC (with discussion). Bayesian Analysis 16(2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   667-718. https://doi.org/10.1214/20-BA1221.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Other useful references</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Arel-Bundock V, Greifer N, and Heiss A (2024). How to interpret</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   statistical models using marginaleffects for R and Python. Journal of</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Statistical Software, 111(9), 1-32.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   https://doi.org/10.18637/jss.v111.i09</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Gabry J, Simpson D, Vehtari A, Betancourt M, and Gelman A (2019).</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Visualization in Bayesian workflow. Journal of the Royal Statatistical</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Society A, 182, 389-402. doi:10.1111/rssa.12378.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Vehtari A, Gelman A, and Gabry J (2017). Practical Bayesian model</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   evaluation using leave-one-out cross-validation and WAIC. Statistics and</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Computing, 27, 1413-1432. doi:10.1007/s11222-016-9696-4.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Burkner PC, Gabry J, and Vehtari A. (2020). Approximate leave-future-out</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   cross-validation for Bayesian time series models. Journal of Statistical</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Computation and Simulation, 90(14), 2499-2523.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   https://doi.org/10.1080/00949655.2020.1783262</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#--------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co"># For a GP example, simulate data using the mgcv package</span></span></span>
<span class="r-in"><span><span class="co">#--------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu">mgcv</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/gamSim.html" class="external-link">gamSim</a></span><span class="op">(</span><span class="fl">1</span>, n <span class="op">=</span> <span class="fl">30</span>, scale <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Gu &amp; Wahba 4 term additive model</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Fit a model that uses an approximate GP from brms</span></span></span>
<span class="r-in"><span><span class="va">mod2</span> <span class="op">&lt;-</span> <span class="fu"><a href="mvgam.html">mvgam</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">y</span> <span class="op">~</span> <span class="fu"><a href="https://paulbuerkner.com/brms/reference/gp.html" class="external-link">gp</a></span><span class="op">(</span><span class="va">x2</span>, k <span class="op">=</span> <span class="fl">12</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">dat</span>,</span></span>
<span class="r-in"><span>  family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">gaussian</a></span><span class="op">(</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  chains <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>  silent <span class="op">=</span> <span class="fl">2</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>gp effects in mvgam cannot yet handle autogrouping</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> resetting all instances of 'gr = TRUE' to 'gr = FALSE'</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span style="color: #555555;">This warning is displayed once per session.</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">how_to_cite</span><span class="op">(</span><span class="va">mod2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Methods text skeleton</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> We used the R package mvgam (version 1.1.595; Clark &amp; Wells, 2023) to</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   construct, fit and interrogate the model. mvgam fits Bayesian</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   State-Space models that can include flexible predictor effects in both</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   the process and observation components by incorporating functionalities</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   from the brms (Burkner 2017), mgcv (Wood 2017) and splines2 (Wang &amp; Yan,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   2023) packages. Gaussian Process functional effects were estimated using</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   a low-rank Hilbert space approximation following methods described by</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Riutort-Mayol et al. (2023). The mvgam-constructed model and observed</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   data were passed to the probabilistic programming environment Stan</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   (version 2.38.0; Carpenter et al. 2017, Stan Development Team 2026),</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   specifically through the cmdstanr interface (Gabry &amp; Cesnovar, 2021). We</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ran 2 Hamiltonian Monte Carlo chains for 500 warmup iterations and 500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   sampling iterations for joint posterior estimation. Rank normalized</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   split Rhat (Vehtari et al. 2021) and effective sample sizes were used to</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   monitor convergence.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Primary references</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Clark, NJ and Wells K (2023). Dynamic Generalized Additive Models</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   (DGAMs) for forecasting discrete ecological time series. Methods in</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Ecology and Evolution, 14, 771-784. doi.org/10.1111/2041-210X.13974</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Burkner, PC (2017). brms: An R Package for Bayesian Multilevel Models</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Using Stan. Journal of Statistical Software, 80(1), 1-28.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   doi:10.18637/jss.v080.i01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Wood, SN (2017). Generalized Additive Models: An Introduction with R</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   (2nd edition). Chapman and Hall/CRC.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Wang W and Yan J (2021). Shape-Restricted Regression Splines with R</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Package splines2. Journal of Data Science, 19(3), 498-517.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   doi:10.6339/21-JDS1020 https://doi.org/10.6339/21-JDS1020.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Riutort-Mayol G, Burkner PC, Andersen MR, Solin A and Vehtari A (2023).</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Practical Hilbert space approximate Bayesian Gaussian processes for</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   probabilistic programming. Statistics and Computing 33, 1.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   https://doi.org/10.1007/s11222-022-10167-2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Carpenter B, Gelman A, Hoffman MD, Lee D, Goodrich B, Betancourt M,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Brubaker M, Guo J, Li P and Riddell A (2017). Stan: A probabilistic</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   programming language. Journal of Statistical Software 76.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Gabry J, Cesnovar R, Johnson A, and Bronder S (2026). cmdstanr: R</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Interface to 'CmdStan'. https://mc-stan.org/cmdstanr/,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   https://discourse.mc-stan.org.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Vehtari A, Gelman A, Simpson D, Carpenter B, and Burkner P (2021).</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Rank-normalization, folding, and localization: An improved Rhat for</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   assessing convergence of MCMC (with discussion). Bayesian Analysis 16(2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   667-718. https://doi.org/10.1214/20-BA1221.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Other useful references</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Arel-Bundock V, Greifer N, and Heiss A (2024). How to interpret</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   statistical models using marginaleffects for R and Python. Journal of</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Statistical Software, 111(9), 1-32.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   https://doi.org/10.18637/jss.v111.i09</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Gabry J, Simpson D, Vehtari A, Betancourt M, and Gelman A (2019).</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Visualization in Bayesian workflow. Journal of the Royal Statatistical</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Society A, 182, 389-402. doi:10.1111/rssa.12378.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Vehtari A, Gelman A, and Gabry J (2017). Practical Bayesian model</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   evaluation using leave-one-out cross-validation and WAIC. Statistics and</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Computing, 27, 1413-1432. doi:10.1007/s11222-016-9696-4.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Burkner PC, Gabry J, and Vehtari A. (2020). Approximate leave-future-out</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   cross-validation for Bayesian time series models. Journal of Statistical</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Computation and Simulation, 90(14), 2499-2523.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   https://doi.org/10.1080/00949655.2020.1783262</span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://researchers.uq.edu.au/researcher/15140" class="external-link">Nicholas J Clark</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer></div>

  

  

  </body></html>

