<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Evaluate forecasts from fitted mvgam objects"><title>Evaluate forecasts from fitted mvgam objects — evaluate_mvgams • mvgam</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Evaluate forecasts from fitted mvgam objects — evaluate_mvgams"><meta property="og:description" content="Evaluate forecasts from fitted mvgam objects"><meta property="og:image" content="https://nicholasjclark.github.io/mvgam/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary" data-bs-theme="dark"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">mvgam</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.5004</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/data_in_mvgam.html">Formatting data for use in mvgam</a>
    <a class="dropdown-item" href="../articles/forecast_evaluation.html">Forecasting and forecast evaluation in mvgam</a>
    <a class="dropdown-item" href="../articles/mvgam_overview.html">Overview of the mvgam package</a>
    <a class="dropdown-item" href="../articles/nmixtures.html">N-mixtures in mvgam</a>
    <a class="dropdown-item" href="../articles/shared_states.html">Shared latent states in mvgam</a>
    <a class="dropdown-item" href="../articles/time_varying_effects.html">Time-varying effects in mvgam</a>
    <a class="dropdown-item" href="../articles/trend_formulas.html">State-Space models in mvgam</a>
  </div>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/nicholasjclark/mvgam/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Evaluate forecasts from fitted <span class="pkg">mvgam</span> objects</h1>
      <small class="dont-index">Source: <a href="https://github.com/nicholasjclark/mvgam/blob/HEAD/R/evaluate_mvgams.R" class="external-link"><code>R/evaluate_mvgams.R</code></a></small>
      <div class="d-none name"><code>evaluate_mvgams.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Evaluate forecasts from fitted <span class="pkg">mvgam</span> objects</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">eval_mvgam</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  n_samples <span class="op">=</span> <span class="fl">5000</span>,</span>
<span>  eval_timepoint <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  fc_horizon <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  n_cores <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  score <span class="op">=</span> <span class="st">"drps"</span>,</span>
<span>  log <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">weights</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">roll_eval_mvgam</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  n_evaluations <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  <span class="va">evaluation_seq</span>,</span>
<span>  n_samples <span class="op">=</span> <span class="fl">5000</span>,</span>
<span>  fc_horizon <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  n_cores <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  score <span class="op">=</span> <span class="st">"drps"</span>,</span>
<span>  log <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">weights</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">compare_mvgams</span><span class="op">(</span></span>
<span>  <span class="va">model1</span>,</span>
<span>  <span class="va">model2</span>,</span>
<span>  n_samples <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  fc_horizon <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  n_evaluations <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  n_cores <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  score <span class="op">=</span> <span class="st">"drps"</span>,</span>
<span>  log <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">weights</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>object</dt>
<dd><p><code>list</code> object returned from <code>mvgam</code></p></dd>


<dt>n_samples</dt>
<dd><p><code>integer</code> specifying the number of samples to generate from the model's
posterior distribution</p></dd>


<dt>eval_timepoint</dt>
<dd><p><code>integer</code> indexing the timepoint that represents our last 'observed'
set of outcome data</p></dd>


<dt>fc_horizon</dt>
<dd><p><code>integer</code> specifying the length of the forecast horizon for evaluating forecasts</p></dd>


<dt>n_cores</dt>
<dd><p>Deprecated. Parallel processing is no longer supported</p></dd>


<dt>score</dt>
<dd><p><code>character</code> specifying the type of ranked probability score to use for evaluation. Options are:
<code>variogram</code>, <code>drps</code> or <code>crps</code></p></dd>


<dt>log</dt>
<dd><p><code>logical</code>. Should the forecasts and truths be logged prior to scoring?
This is often appropriate for comparing
performance of models when series vary in their observation ranges</p></dd>


<dt>weights</dt>
<dd><p>optional <code>vector</code> of weights (where <code>length(weights) == n_series</code>)
for weighting pairwise correlations when evaluating the variogram score for multivariate
forecasts. Useful for down-weighting series that have larger magnitude observations or that
are of less interest when forecasting. Ignored if <code>score != 'variogram'</code></p></dd>


<dt>n_evaluations</dt>
<dd><p><code>integer</code> specifying the total number of evaluations to perform</p></dd>


<dt>evaluation_seq</dt>
<dd><p>Optional <code>integer sequence</code> specifying the exact set of timepoints for
evaluating the model's forecasts. This sequence cannot have values
<code>&lt;3</code> or <code>&gt; max(training timepoints) - fc_horizon</code></p></dd>


<dt>model1</dt>
<dd><p><code>list</code> object returned from <code>mvgam</code> representing the first model to be
evaluated</p></dd>


<dt>model2</dt>
<dd><p><code>list</code> object returned from <code>mvgam</code> representing the second model to be
evaluated</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>For <code>eval_mvgam</code>, a <code>list</code> object containing information on specific evaluations for each series
(if using <code>drps</code> or <code>crps</code> as the score) or a vector of scores when using <code>variogram</code>.</p>


<p>For <code>roll_eval_mvgam</code>, a <code>list</code> object containing information on specific evaluations for each series as well as
a total evaluation summary (taken by summing the forecast score for each series at each evaluation and averaging
the coverages at each evaluation)</p>


<p>For <code>compare_mvgams</code>, a series of plots comparing forecast Rank Probability Scores for each competing
model. A lower score is preferred. Note however that it is possible to select a model that ultimately
would perform poorly in true out-of-sample forecasting. For example if a wiggly smooth function of 'year'
is included in the model then this function will be learned prior to evaluating rolling window forecasts,
and the model could generate very tight predictions as a result. But when forecasting ahead to timepoints
that the model has not seen (i.e. next year), the smooth function will end up extrapolating, sometimes
in very strange and unexpected ways. It is therefore recommended to only use smooth functions for
covariates that are adequately measured in the data (i.e. 'seasonality', for example) to reduce possible
extrapolation of smooths and let the latent trends in the <code>mvgam</code> model capture any
temporal dependencies in the data. These trends are time series models and so will provide much more
stable forecasts</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><code>eval_mvgam</code> may be useful when both repeated fitting of a model using <code><a href="update.mvgam.html">update.mvgam</a></code>
for exact leave-future-out cross-validation and approximate
leave-future-out cross-validation using <code><a href="lfo_cv.mvgam.html">lfo_cv</a></code> are impractical. The function generates a set of samples representing fixed parameters estimated from the full
<code>mvgam</code> model and latent trend states at a given point in time. The trends are rolled forward
a total of <code>fc_horizon</code> timesteps according to their estimated state space dynamics to
generate an 'out-of-sample' forecast that is evaluated against the true observations in the horizon window.
This function therefore simulates a situation where the model's parameters had already been estimated but
we have only observed data up to the evaluation timepoint and would like to generate forecasts from the
latent trends that have been observed up to that timepoint. Evaluation involves calculating an
appropriate Rank Probability Score and a binary indicator
for whether or not the true value lies within the forecast's 90% prediction interval</p>
<p><code>roll_eval_mvgam</code> sets up a sequence of evaluation timepoints along a rolling window and iteratively
calls <code>eval_mvgam</code> to evaluate 'out-of-sample' forecasts.
Evaluation involves calculating the Rank Probability Scores and a binary indicator
for whether or not the true value lies within the forecast's 90% prediction interval</p>
<p><code>compare_mvgams</code> automates the evaluation to compare two fitted models using rolling window forecast evaluation and
provides a series of summary plots to facilitate model selection. It is essentially a wrapper for
<code>roll_eval_mvgam</code></p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="forecast.mvgam.html">forecast</a></code>, <code><a href="score.mvgam_forecast.html">score</a></code>, <code><a href="lfo_cv.mvgam.html">lfo_cv</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co"># Simulate from a Poisson-AR2 model with a seasonal smooth</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu"><a href="sim_mvgam.html">sim_mvgam</a></span><span class="op">(</span>T <span class="op">=</span> <span class="fl">75</span>,</span></span>
<span class="r-in"><span>                n_series <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>                prop_trend <span class="op">=</span> <span class="fl">0.75</span>,</span></span>
<span class="r-in"><span>                trend_model <span class="op">=</span> <span class="fu"><a href="RW.html">AR</a></span><span class="op">(</span>p <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">poisson</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Fit an appropriate model</span></span></span>
<span class="r-in"><span><span class="va">mod_ar2</span> <span class="op">&lt;-</span> <span class="fu"><a href="mvgam.html">mvgam</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html" class="external-link">s</a></span><span class="op">(</span><span class="va">season</span>, bs <span class="op">=</span> <span class="st">'cc'</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                trend_model <span class="op">=</span> <span class="fu"><a href="RW.html">AR</a></span><span class="op">(</span>p <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">poisson</a></span><span class="op">(</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                data <span class="op">=</span> <span class="va">dat</span><span class="op">$</span><span class="va">data_train</span>,</span></span>
<span class="r-in"><span>                newdata <span class="op">=</span> <span class="va">dat</span><span class="op">$</span><span class="va">data_test</span>,</span></span>
<span class="r-in"><span>                chains <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>                silent <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Fit a less appropriate model</span></span></span>
<span class="r-in"><span><span class="va">mod_rw</span> <span class="op">&lt;-</span> <span class="fu"><a href="mvgam.html">mvgam</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>               trend_model <span class="op">=</span> <span class="fu"><a href="RW.html">RW</a></span><span class="op">(</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>               family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">poisson</a></span><span class="op">(</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>               data <span class="op">=</span> <span class="va">dat</span><span class="op">$</span><span class="va">data_train</span>,</span></span>
<span class="r-in"><span>               newdata <span class="op">=</span> <span class="va">dat</span><span class="op">$</span><span class="va">data_test</span>,</span></span>
<span class="r-in"><span>               chains <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>               silent <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Compare Discrete Ranked Probability Scores for the testing period</span></span></span>
<span class="r-in"><span><span class="va">fc_ar2</span> <span class="op">&lt;-</span> <span class="fu"><a href="forecast.mvgam.html">forecast</a></span><span class="op">(</span><span class="va">mod_ar2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fc_rw</span> <span class="op">&lt;-</span> <span class="fu"><a href="forecast.mvgam.html">forecast</a></span><span class="op">(</span><span class="va">mod_rw</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">score_ar2</span> <span class="op">&lt;-</span> <span class="fu"><a href="score.mvgam_forecast.html">score</a></span><span class="op">(</span><span class="va">fc_ar2</span>, score <span class="op">=</span> <span class="st">'drps'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">score_rw</span> <span class="op">&lt;-</span> <span class="fu"><a href="score.mvgam_forecast.html">score</a></span><span class="op">(</span><span class="va">fc_rw</span>, score <span class="op">=</span> <span class="st">'drps'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">score_ar2</span><span class="op">$</span><span class="va">series_1</span><span class="op">$</span><span class="va">score</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 39.48068</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">score_rw</span><span class="op">$</span><span class="va">series_1</span><span class="op">$</span><span class="va">score</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 39.65344</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Use rolling evaluation for approximate comparisons of 3-step ahead</span></span></span>
<span class="r-in"><span><span class="co"># forecasts across the training period</span></span></span>
<span class="r-in"><span><span class="fu">compare_mvgams</span><span class="op">(</span><span class="va">mod_ar2</span>,</span></span>
<span class="r-in"><span>              <span class="va">mod_rw</span>,</span></span>
<span class="r-in"><span>              fc_horizon <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>              n_samples <span class="op">=</span> <span class="fl">1000</span>,</span></span>
<span class="r-in"><span>              n_evaluations <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RPS summaries per model (lower is better)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             Min.  1st Qu.   Median     Mean  3rd Qu.     Max.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model 1 0.816925 1.411382 2.005840 2.367583 3.142912 4.279985</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model 2 1.842947 2.168967 2.494988 2.523765 2.864174 3.233360</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 90% interval coverages per model (closer to 0.9 is better)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model 1 0.9333333 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model 2 1</span>
<span class="r-plt img"><img src="evaluate_mvgams-1.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="evaluate_mvgams-2.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="evaluate_mvgams-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Now use approximate leave-future-out CV to compare</span></span></span>
<span class="r-in"><span><span class="co"># rolling forecasts; start at time point 40 to reduce</span></span></span>
<span class="r-in"><span><span class="co"># computational time and to ensure enough data is available</span></span></span>
<span class="r-in"><span><span class="co"># for estimating model parameters</span></span></span>
<span class="r-in"><span><span class="va">lfo_ar2</span> <span class="op">&lt;-</span> <span class="fu"><a href="lfo_cv.mvgam.html">lfo_cv</a></span><span class="op">(</span><span class="va">mod_ar2</span>,</span></span>
<span class="r-in"><span>                 min_t <span class="op">=</span> <span class="fl">40</span>,</span></span>
<span class="r-in"><span>                 fc_horizon <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>                 silent <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">lfo_rw</span> <span class="op">&lt;-</span> <span class="fu"><a href="lfo_cv.mvgam.html">lfo_cv</a></span><span class="op">(</span><span class="va">mod_rw</span>,</span></span>
<span class="r-in"><span>                min_t <span class="op">=</span> <span class="fl">40</span>,</span></span>
<span class="r-in"><span>                fc_horizon <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>                silent <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Plot Pareto-K values and ELPD estimates</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">lfo_ar2</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="evaluate_mvgams-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">lfo_rw</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="evaluate_mvgams-5.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Proportion of timepoints in which AR2 model gives</span></span></span>
<span class="r-in"><span><span class="co"># better forecasts</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="op">(</span><span class="va">lfo_ar2</span><span class="op">$</span><span class="va">elpds</span> <span class="op">-</span> <span class="va">lfo_rw</span><span class="op">$</span><span class="va">elpds</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span></span></span>
<span class="r-in"><span>      <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">lfo_ar2</span><span class="op">$</span><span class="va">elpds</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.7692308</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># A higher total ELPD is preferred</span></span></span>
<span class="r-in"><span><span class="va">lfo_ar2</span><span class="op">$</span><span class="va">sum_ELPD</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -58.77854</span>
<span class="r-in"><span><span class="va">lfo_rw</span><span class="op">$</span><span class="va">sum_ELPD</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -75.98128</span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://researchers.uq.edu.au/researcher/15140" class="external-link">Nicholas J Clark</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer></div>

  

  

  </body></html>

