<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="These evaluation and plotting functions exist to allow some popular gratia
methods to work with mvgam or jsdgam models"><title>Enhance post-processing of mvgam models using gratia functionality — gratia_mvgam_enhancements • mvgam</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Enhance post-processing of mvgam models using gratia functionality — gratia_mvgam_enhancements"><meta property="og:description" content="These evaluation and plotting functions exist to allow some popular gratia
methods to work with mvgam or jsdgam models"><meta property="og:image" content="https://nicholasjclark.github.io/mvgam/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary" data-bs-theme="dark"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">mvgam</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.592</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/data_in_mvgam.html">Formatting data for use in mvgam</a>
    <a class="dropdown-item" href="../articles/forecast_evaluation.html">Forecasting and forecast evaluation in mvgam</a>
    <a class="dropdown-item" href="../articles/mvgam_overview.html">Overview of the mvgam package</a>
    <a class="dropdown-item" href="../articles/nmixtures.html">N-mixtures in mvgam</a>
    <a class="dropdown-item" href="../articles/shared_states.html">Shared latent states in mvgam</a>
    <a class="dropdown-item" href="../articles/time_varying_effects.html">Time-varying effects in mvgam</a>
    <a class="dropdown-item" href="../articles/trend_formulas.html">State-Space models in mvgam</a>
  </div>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/nicholasjclark/mvgam/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Enhance post-processing of <span class="pkg">mvgam</span> models using <span class="pkg">gratia</span> functionality</h1>
      <small class="dont-index">Source: <a href="https://github.com/nicholasjclark/mvgam/blob/HEAD/R/gratia_methods.R" class="external-link"><code>R/gratia_methods.R</code></a></small>
      <div class="d-none name"><code>gratia_mvgam_enhancements.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>These evaluation and plotting functions exist to allow some popular <code>gratia</code>
methods to work with <code>mvgam</code> or <code>jsdgam</code> models</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">drawDotmvgam</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  trend_effects <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  select <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  parametric <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  terms <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  residuals <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  scales <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"free"</span>, <span class="st">"fixed"</span><span class="op">)</span>,</span>
<span>  ci_level <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  n <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  n_3d <span class="op">=</span> <span class="fl">16</span>,</span>
<span>  n_4d <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  unconditional <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  overall_uncertainty <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  constant <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  fun <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  dist <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  rug <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  contour <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  grouped_by <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  ci_alpha <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>  ci_col <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>  smooth_col <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>  resid_col <span class="op">=</span> <span class="st">"steelblue3"</span>,</span>
<span>  contour_col <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>  n_contour <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  partial_match <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  discrete_colour <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  discrete_fill <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  continuous_colour <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  continuous_fill <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  position <span class="op">=</span> <span class="st">"identity"</span>,</span>
<span>  angle <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ncol <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  nrow <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  guides <span class="op">=</span> <span class="st">"keep"</span>,</span>
<span>  widths <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  heights <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  crs <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  default_crs <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  lims_method <span class="op">=</span> <span class="st">"cross"</span>,</span>
<span>  wrap <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  envir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/environment.html" class="external-link">environment</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/formula.html" class="external-link">formula</a></span><span class="op">(</span><span class="va">object</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">eval_smoothDothilbertDotsmooth</span><span class="op">(</span></span>
<span>  <span class="va">smooth</span>,</span>
<span>  <span class="va">model</span>,</span>
<span>  n <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  n_3d <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  n_4d <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  unconditional <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  overall_uncertainty <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  dist <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">eval_smoothDotmodDotsmooth</span><span class="op">(</span></span>
<span>  <span class="va">smooth</span>,</span>
<span>  <span class="va">model</span>,</span>
<span>  n <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  n_3d <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  n_4d <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  unconditional <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  overall_uncertainty <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  dist <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">eval_smoothDotmoiDotsmooth</span><span class="op">(</span></span>
<span>  <span class="va">smooth</span>,</span>
<span>  <span class="va">model</span>,</span>
<span>  n <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  n_3d <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  n_4d <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  unconditional <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  overall_uncertainty <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  dist <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>object</dt>
<dd><p>a fitted mvgam, the result of a call to <code><a href="mvgam.html">mvgam()</a></code></p></dd>


<dt>trend_effects</dt>
<dd><p>logical specifying whether smooth terms from the <code>trend_formula</code> should
be drawn. If <code>FALSE</code>, only terms from the observation formula are drawn. If <code>TRUE</code>, only
terms from the <code>trend_formula</code> are drawn</p></dd>


<dt>data</dt>
<dd><p>a data frame of covariate values at which to evaluate the
model's smooth functions</p></dd>


<dt>select</dt>
<dd><p>character, logical, or numeric; which smooths to plot. If
<code>NULL</code>, the default, then all model smooths are drawn.
Character <code>select</code> matches the labels for smooths
as shown for example in the output from <code>summary(object)</code>. Logical
<code>select</code> operates as per numeric <code>select</code> in the order that smooths are
stored</p></dd>


<dt>parametric</dt>
<dd><p>logical; plot parametric terms also? Note that <code>select</code> is
used for selecting which smooths to plot. The <code>terms</code> argument is used to
select which parametric effects are plotted. The default, as with
<code><a href="https://rdrr.io/pkg/mgcv/man/plot.gam.html" class="external-link">mgcv::plot.gam()</a></code>, is to not draw parametric effects</p></dd>


<dt>terms</dt>
<dd><p>character; which model parametric terms should be drawn? The
Default of <code>NULL</code> will plot all parametric terms that can be drawn.</p></dd>


<dt>residuals</dt>
<dd><p>currently ignored for <code>mvgam</code> models</p></dd>


<dt>scales</dt>
<dd><p>character; should all univariate smooths be plotted with the
same y-axis scale? If <code>scales = "free"</code>, the default, each univariate
smooth has its own y-axis scale. If <code>scales = "fixed"</code>, a common y axis
scale is used for all univariate smooths.</p>
<p>Currently does not affect the y-axis scale of plots of the parametric
terms</p></dd>


<dt>ci_level</dt>
<dd><p>numeric between 0 and 1; the coverage of credible interval.</p></dd>


<dt>n</dt>
<dd><p>numeric; the number of points over the range of the covariate at
which to evaluate the smooth</p></dd>


<dt>n_3d, n_4d</dt>
<dd><p>numeric; the number of points over the range of last
covariate in a 3D or 4D smooth. The default is <code>NULL</code> which achieves the
standard behaviour of using <code>n</code> points over the range of all covariate,
resulting in <code>n^d</code> evaluation points, where <code>d</code> is the dimension of the
smooth. For <code>d &gt; 2</code> this can result in very many evaluation points and slow
performance. For smooths of <code>d &gt; 4</code>, the value of <code>n_4d</code> will be used for
all dimensions <code>&gt; 4</code>, unless this is <code>NULL</code>, in which case the default
behaviour (using <code>n</code> for all dimensions) will be observed</p></dd>


<dt>unconditional</dt>
<dd><p>ignored for <code>mvgam</code> models as all appropriate
uncertainties are already included in the posterior estimates</p></dd>


<dt>overall_uncertainty</dt>
<dd><p>ignored for <code>mvgam</code> models as all appropriate
uncertainties are already included in the posterior estimates</p></dd>


<dt>constant</dt>
<dd><p>numeric; a constant to add to the estimated values of the
smooth. <code>constant</code>, if supplied, will be added to the estimated value
before the confidence band is computed</p></dd>


<dt>fun</dt>
<dd><p>function; a function that will be applied to the estimated values
and confidence interval before plotting. Can be a function or the name of a
function. Function <code>fun</code> will be applied after adding any <code>constant</code>, if
provided</p></dd>


<dt>dist</dt>
<dd><p>numeric; if greater than 0, this is used to determine when
a location is too far from data to be plotted when plotting 2-D smooths.
The data are scaled into the unit square before deciding what to exclude,
and <code>dist</code> is a distance within the unit square. See
<code><a href="https://rdrr.io/pkg/mgcv/man/exclude.too.far.html" class="external-link">mgcv::exclude.too.far()</a></code> for further details</p></dd>


<dt>rug</dt>
<dd><p>logical; draw a rug plot at the bottom of each plot for 1-D
smooths or plot locations of data for higher dimensions.</p></dd>


<dt>contour</dt>
<dd><p>logical; should contours be draw on the plot using
<code><a href="https://ggplot2.tidyverse.org/reference/geom_contour.html" class="external-link">ggplot2::geom_contour()</a></code></p></dd>


<dt>grouped_by</dt>
<dd><p>logical; should factor by smooths be drawn as one panel
per level of the factor (<code>FALSE</code>, the default), or should the individual
smooths be combined into a single panel containing all levels (<code>TRUE</code>)?</p></dd>


<dt>ci_alpha</dt>
<dd><p>numeric; alpha transparency for confidence or simultaneous
interval</p></dd>


<dt>ci_col</dt>
<dd><p>colour specification for the confidence/credible intervals
band. Affects the fill of the interval</p></dd>


<dt>smooth_col</dt>
<dd><p>colour specification for the smooth line</p></dd>


<dt>resid_col</dt>
<dd><p>colour specification for residual points. Ignored</p></dd>


<dt>contour_col</dt>
<dd><p>colour specification for contour lines</p></dd>


<dt>n_contour</dt>
<dd><p>numeric; the number of contour bins. Will result in
<code>n_contour - 1</code> contour lines being drawn. See <code><a href="https://ggplot2.tidyverse.org/reference/geom_contour.html" class="external-link">ggplot2::geom_contour()</a></code></p></dd>


<dt>partial_match</dt>
<dd><p>logical; should smooths be selected by partial matches
with <code>select</code>? If <code>TRUE</code>, <code>select</code> can only be a single string to match
against</p></dd>


<dt>discrete_colour</dt>
<dd><p>a suitable colour scale to be used when plotting
discrete variables</p></dd>


<dt>discrete_fill</dt>
<dd><p>a suitable fill scale to be used when plotting
discrete variables.</p></dd>


<dt>continuous_colour</dt>
<dd><p>a suitable colour scale to be used when plotting
continuous variables</p></dd>


<dt>continuous_fill</dt>
<dd><p>a suitable fill scale to be used when plotting
continuous variables</p></dd>


<dt>position</dt>
<dd><p>Position adjustment, either as a string, or the result of a
call to a position adjustment function</p></dd>


<dt>angle</dt>
<dd><p>numeric; the angle at which the x axis tick labels are to be
drawn passed to the <code>angle</code> argument of <code><a href="https://ggplot2.tidyverse.org/reference/guide_axis.html" class="external-link">ggplot2::guide_axis()</a></code></p></dd>


<dt>ncol, nrow</dt>
<dd><p>numeric; the numbers of rows and columns over which to
spread the plots</p></dd>


<dt>guides</dt>
<dd><p>character; one of <code>"keep"</code> (the default), <code>"collect"</code>, or
<code>"auto"</code>. Passed to <code><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html" class="external-link">patchwork::plot_layout()</a></code></p></dd>


<dt>widths, heights</dt>
<dd><p>The relative widths and heights of each column and
row in the grid. Will get repeated to match the dimensions of the grid. If
there is more than 1 plot and <code>widths = NULL</code>, the value of <code>widths</code> will
be set internally to <code>widths = 1</code> to accommodate plots of smooths that
use a fixed aspect ratio.=</p></dd>


<dt>crs</dt>
<dd><p>the coordinate reference system (CRS) to use for the plot. All
data will be projected into this CRS. See <code><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">ggplot2::coord_sf()</a></code> for
details</p></dd>


<dt>default_crs</dt>
<dd><p>the coordinate reference system (CRS) to use for the
non-sf layers in the plot. If left at the default <code>NULL</code>, the CRS used is
4326 (WGS84), which is appropriate for spline-on-the-sphere smooths, which
are parameterized in terms of latitude and longitude as coordinates. See
<code><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">ggplot2::coord_sf()</a></code> for more details</p></dd>


<dt>lims_method</dt>
<dd><p>character; affects how the axis limits are determined. See
<code><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">ggplot2::coord_sf()</a></code>. Be careful; in testing of some examples, changing
this to <code>"orthogonal"</code> for example with the chlorophyll-a example from
Simon Wood's GAM book quickly used up all the RAM in my test system and the
OS killed R. This could be incorrect usage on my part; right now the grid
of points at which SOS smooths are evaluated (if not supplied by the user)
can produce invalid coordinates for the corners of tiles as the grid is
generated for tile centres without respect to the spacing of those tiles</p></dd>


<dt>wrap</dt>
<dd><p>logical; wrap plots as a patchwork? If <code>FALSE</code>, a list of
ggplot objects is returned, 1 per term plotted</p></dd>


<dt>envir</dt>
<dd><p>an environment to look up the data within</p></dd>


<dt>...</dt>
<dd><p>additional arguments passed to other methods</p></dd>


<dt>smooth</dt>
<dd><p>a smooth object of class <code>"gp.smooth"</code> (returned from a model using either the
<code><a href="dynamic.html">dynamic()</a></code> function or the <code><a href="https://paulbuerkner.com/brms/reference/gp.html" class="external-link">gp()</a></code> function) or of class <code>"moi.smooth"</code> or <code>"mod.smooth"</code>
(returned from a model using the 'moi' or 'mod' basis)</p></dd>


<dt>model</dt>
<dd><p>a fitted <code>mgcv</code> model of clas <code>gam</code> or <code>bam</code></p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>These methods allow <code>mvgam</code> models to be <em>Enhanced</em> if users have the <code>gratia</code>
package installed, making available the popular <code><a href="https://gavinsimpson.github.io/gratia/reference/draw.html" class="external-link">draw()</a></code> function to plot partial effects
of <code>mvgam</code> smooth functions using <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot2::ggplot()</a></code> utilities</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Nicholas J Clark</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co"># Fit a simple GAM and draw partial effects of smooths using 'gratia'</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu">mgcv</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/gamSim.html" class="external-link">gamSim</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  eg <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>  n <span class="op">=</span> <span class="fl">200</span>,</span></span>
<span class="r-in"><span>  scale <span class="op">=</span> <span class="fl">2</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Gu &amp; Wahba 4 term additive model</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="mvgam.html">mvgam</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/s.html" class="external-link">s</a></span><span class="op">(</span><span class="va">x1</span>, bs <span class="op">=</span> <span class="st">'moi'</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/pkg/mgcv/man/te.html" class="external-link">te</a></span><span class="op">(</span><span class="va">x0</span>, <span class="va">x2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">dat</span>,</span></span>
<span class="r-in"><span>  family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">gaussian</a></span><span class="op">(</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  chains <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>  silent <span class="op">=</span> <span class="fl">2</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="st"><a href="https://gavinsimpson.github.io/gratia/" class="external-link">"gratia"</a></span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="fu">gratia</span><span class="fu">::</span><span class="fu"><a href="https://gavinsimpson.github.io/gratia/reference/draw.html" class="external-link">draw</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required package: gratia</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Attaching package: ‘gratia’</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The following object is masked from ‘package:mvgam’:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     add_residuals</span>
<span class="r-plt img"><img src="gratia_mvgam_enhancements-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://researchers.uq.edu.au/researcher/15140" class="external-link">Nicholas J Clark</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer></div>

  

  

  </body></html>

