<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Nicholas J Clark" />

<meta name="date" content="2025-03-14" />

<title>Forecasting and forecast evaluation in mvgam</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Forecasting and forecast evaluation in
mvgam</h1>
<h4 class="author">Nicholas J Clark</h4>
<h4 class="date">2025-03-14</h4>


<div id="TOC">
<ul>
<li><a href="#simulating-discrete-time-series" id="toc-simulating-discrete-time-series">Simulating discrete time
series</a>
<ul>
<li><a href="#modelling-dynamics-with-splines" id="toc-modelling-dynamics-with-splines">Modelling dynamics with
splines</a></li>
<li><a href="#modelling-dynamics-with-a-correlated-ar1" id="toc-modelling-dynamics-with-a-correlated-ar1">Modelling dynamics
with a correlated AR1</a></li>
</ul></li>
<li><a href="#forecasting-with-the-forecast-function" id="toc-forecasting-with-the-forecast-function">Forecasting with the
<code>forecast()</code> function</a></li>
<li><a href="#forecasting-with-newdata-in-mvgam" id="toc-forecasting-with-newdata-in-mvgam">Forecasting with
<code>newdata</code> in <code>mvgam()</code></a></li>
<li><a href="#scoring-forecast-distributions" id="toc-scoring-forecast-distributions">Scoring forecast
distributions</a></li>
<li><a href="#further-reading" id="toc-further-reading">Further
reading</a></li>
<li><a href="#interested-in-contributing" id="toc-interested-in-contributing">Interested in contributing?</a></li>
</ul>
</div>

<p>The purpose of this vignette is to show how the <code>mvgam</code>
package can be used to produce probabilistic forecasts and to evaluate
those forecasts using a variety of proper scoring rules.</p>
<div id="simulating-discrete-time-series" class="section level2">
<h2>Simulating discrete time series</h2>
<p>We begin by simulating some data to show how forecasts are computed
and evaluated in <code>mvgam</code>. The <code>sim_mvgam()</code>
function can be used to simulate series that come from a variety of
response distributions as well as seasonal patterns and/or dynamic
temporal patterns. Here we simulate a collection of three time
count-valued series. These series all share the same seasonal pattern
but have different temporal dynamics. By setting
<code>trend_model = GP()</code> and <code>prop_trend = 0.75</code>, we
are generating time series that have smooth underlying temporal trends
(evolving as Gaussian Processes with squared exponential kernel) and
moderate seasonal patterns. The observations are Poisson-distributed and
we allow 10% of observations to be missing.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>simdat <span class="ot">&lt;-</span> <span class="fu">sim_mvgam</span>(</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>  <span class="at">T =</span> <span class="dv">100</span>,</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>  <span class="at">n_series =</span> <span class="dv">3</span>,</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>  <span class="at">mu =</span> <span class="dv">2</span>,</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>  <span class="at">trend_model =</span> <span class="fu">GP</span>(),</span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a>  <span class="at">prop_trend =</span> <span class="fl">0.75</span>,</span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a>  <span class="at">family =</span> <span class="fu">poisson</span>(),</span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a>  <span class="at">prop_missing =</span> <span class="fl">0.10</span></span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a>)</span></code></pre></div>
<p>The returned object is a <code>list</code> containing training and
testing data (<code>sim_mvgam()</code> automatically splits the data
into these folds for us) together with some other information about the
data generating process that was used to simulate the data</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">str</span>(simdat)</span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="co">#&gt; List of 6</span></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a><span class="co">#&gt;  $ data_train        :&#39;data.frame&#39;:  225 obs. of  5 variables:</span></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a><span class="co">#&gt;   ..$ y     : int [1:225] 6 NA 11 2 5 20 7 8 NA 11 ...</span></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a><span class="co">#&gt;   ..$ season: int [1:225] 1 1 1 2 2 2 3 3 3 4 ...</span></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a><span class="co">#&gt;   ..$ year  : int [1:225] 1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a><span class="co">#&gt;   ..$ series: Factor w/ 3 levels &quot;series_1&quot;,&quot;series_2&quot;,..: 1 2 3 1 2 3 1 2 3 1 ...</span></span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a><span class="co">#&gt;   ..$ time  : int [1:225] 1 1 1 2 2 2 3 3 3 4 ...</span></span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a><span class="co">#&gt;  $ data_test         :&#39;data.frame&#39;:  75 obs. of  5 variables:</span></span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a><span class="co">#&gt;   ..$ y     : int [1:75] 4 23 8 3 NA 3 1 20 8 3 ...</span></span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a><span class="co">#&gt;   ..$ season: int [1:75] 4 4 4 5 5 5 6 6 6 7 ...</span></span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a><span class="co">#&gt;   ..$ year  : int [1:75] 7 7 7 7 7 7 7 7 7 7 ...</span></span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a><span class="co">#&gt;   ..$ series: Factor w/ 3 levels &quot;series_1&quot;,&quot;series_2&quot;,..: 1 2 3 1 2 3 1 2 3 1 ...</span></span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a><span class="co">#&gt;   ..$ time  : int [1:75] 76 76 76 77 77 77 78 78 78 79 ...</span></span>
<span id="cb2-15"><a href="#cb2-15" tabindex="-1"></a><span class="co">#&gt;  $ true_corrs        : num [1:3, 1:3] 1 0.0861 0.1161 0.0861 1 ...</span></span>
<span id="cb2-16"><a href="#cb2-16" tabindex="-1"></a><span class="co">#&gt;  $ true_trends       : num [1:100, 1:3] -0.851 -0.758 -0.664 -0.571 -0.48 ...</span></span>
<span id="cb2-17"><a href="#cb2-17" tabindex="-1"></a><span class="co">#&gt;  $ global_seasonality: num [1:100] -0.966 -0.197 0.771 1.083 0.37 ...</span></span>
<span id="cb2-18"><a href="#cb2-18" tabindex="-1"></a><span class="co">#&gt;  $ trend_params      :List of 2</span></span>
<span id="cb2-19"><a href="#cb2-19" tabindex="-1"></a><span class="co">#&gt;   ..$ alpha: num [1:3] 0.883 0.936 1.036</span></span>
<span id="cb2-20"><a href="#cb2-20" tabindex="-1"></a><span class="co">#&gt;   ..$ rho  : num [1:3] 7.54 4.01 7.49</span></span></code></pre></div>
<p>Each series in this case has a shared seasonal pattern. The resulting
time series are similar to what we might encounter when dealing with
count-valued data that can take small counts:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">plot_mvgam_series</span>(</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>  <span class="at">data =</span> simdat<span class="sc">$</span>data_train,</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>  <span class="at">series =</span> <span class="st">&quot;all&quot;</span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" alt="Plotting time series features for GAM models in mvgam" width="60%" style="display: block; margin: auto;" /></p>
<p>For individual series, we can plot the training and testing data, as
well as some more specific features of the observed data:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="fu">plot_mvgam_series</span>(</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>  <span class="at">data =</span> simdat<span class="sc">$</span>data_train,</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>  <span class="at">newdata =</span> simdat<span class="sc">$</span>data_test,</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>  <span class="at">series =</span> <span class="dv">1</span></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAlgAAAHgCAMAAABOyeNrAAABMlBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZpAAZrYzMzM6AAA6ADo6AGY6OgA6Ojo6OmY6ZmY6ZpA6ZrY6kLY6kNtNTU1NTW5NTY5NbqtNjshmAABmADpmOgBmOmZmkJBmkLZmkNtmtpBmtttmtv9uTU1uTW5uTY5ubo5ubqtuq+SOTU2OTW6OTY6Obk2OyP+PJyeQOgCQZgCQZjqQZmaQkGaQkLaQtpCQttuQ27aQ2/+rbk2rbm6rbo6ryKur5OSr5P+2ZgC2Zma2kDq2kGa2tpC2ttu225C229u22/+2/9u2///Ijk3I///bkDrbkGbbtmbbtpDb25Db27bb29vb2//b/7bb/9vb///kq27k///r6+v/tmb/trb/yI7/25D/27b/29v/5Kv//7b//8j//9v//+T///+kS5EHAAAACXBIWXMAAA9hAAAPYQGoP6dpAAAf0ElEQVR4nO2dC3vktnWGqXW38thpYle7thXXTS05tjaxZpq2duVLdtJbnF2PnTZNV5aqcSWN+P//QgnwBpAAeA5JDEHye59daUSQIHjmHRAEMWAUA+CBaOgCgGkCsYAXIBbwAsQCXoBYwAsQC3gBYgEvQCzgBYgFvACxgBcgFvACxAJegFjACxALeAFiAS9ALOCFDmLdHUcZj17sVo9ftcul/ZZjYfPohfx9d3xUOdrt37wYqEz+gVjesYuVp0yRjqfC6WvRHVUsc8oU6Uks8Xu7OPp+cfCL+HoRvSUW/vh+FP30m2LN30TRwYexsny3OtxEj34vcyjWLVebDLUaKzvG3Sqp7I/SY/8LGafvF9HB364Os8h8E3//k2TFXySnzEpkx0CvYv1skQTis+RHdCiiIc6SBxf5ivKkeaIs361eW0SP/0fkoCzLV5sOVbHyY8zEui7itEkbFodZZF5lf5/ElciOgl7Fij6Mvxex2i5E+ETF88dFFojt4m3hjwhavjwJ7FGchTpfVqw2ITZ5UzQ6yuKUH6NQLonCh2Kdx6/ujg8+j39cRWVkkkpLrqhHdujjodGrWIfiYynq+vTEKBLyj+t28doHv09f5MuTwL2IK+sWq02Iulj5MYrgZJ+i9cHFtbAp+/BlUfvTv/3DIjqM9cgOdiAs+m1jicMXcVo/fnWdBTM/F67FH299E5fL023FT2XdfLUJUWtjFceYiiXP+9cHFxsZqp1sY8mopg0EKZYa2eGOhMPexIr/+L7smGgQK1+tW7GCot7dkB+jW6y74+hn//Tvfz6GWNrhZwHT+K+/j07K5aVYlXXFat2KFRTGfix5jPZToVgrjUraxoJYxeEnDfLPk0vpvLVwHf110kL4F1FP5ctLscplxWpdjysgqmKVx7hJr4MNjfdUrMNXoi+iGtlhj4aKN7HyxtRRvqL8S11eiqUuy1ebDpbuhuQYN9buhjQyUbYixNIOf5u0JF4r+jplr+Dbsk2aLVfEKtctV5sM5g5ScYx370dJpbTVOkj/7rhovMue08/X4lp5dmKBvqnf+BknECsYtou/TGqz9UQuXCBWMEyrfQmxwmFS7UuIBbwAsYAXIBbwAsQCXoBYwAsQC3gBYgEvdBDr9XnQNcJDl39fVA67i1jZ7yv7KvakEDYiZdddLOJeLcuZqw+WDcRiZgexaKtDLGZ2EIu2OsRiZscS6/b0yZPzOL5/9uTdH2wZhGZET9nMUSzbMfYu1v2vnse3Hz1/+OI8vnzPlkFoRvSUDcSqbxPVV2gn1o2w6eX5/a+/jW9/+a0lg9CM6CkbiFXbRgyCsmfHbWMltdbtJz/Iyivrarhyo+51xECs2jaJVjWzWov18MVZfPNuLpYpg1pJlzmuQnZdjhpr/433PsW6f3aWNOE/gViTE6v+9uxTrNvT5JowZraxIFaFQMWqvj97FCv1Sp4OGVeFEKvCRMQSUvUk1uUTwTmzHwtiVRiNWO7Ge49iGYFYbkSvn/mjCLGcQCw3l0kVb+5ShlhOIJaT248/Pbdc7kAsJxDLxcOXv01qK16X8iAk7w9vgyjKf5iBWLTVW4p1eSZOg+Yu5eBrLOc2srJCjdU5m3ZiJVXVg1ZjCSAWCYjlIO2gOQu/jWV4fyDWXrLp1N1g7lIOXixn4x1i9ZPNxPux2GKlSkGsztlMvOcdYkEsLxsxxYr2IVZDf4ciFq+jJCzmKJZ1mygfPIoaq3M2EEtJERUWxOonG4hVIm/mFK8sG0Es2uoQq6Q8dojVOZs5imU5xghiQSzCRuKNSf6TxYqiK+W1dU8Qi7b6lMVaQiyIBbEKIFaF0YhlBmL1mk2fYg3d2auTvDNX6T8a6uA+DPTrnA1qrBzUWL1mA7FyIFav2UxWrCUa767lEAtiNazebjnEGrlYcuS2GMn9DiYFaQvEqnMjhXp5riyCWFxGI5YZH2K9fPp1UmM9fPlcWQaxuEAsA+JUeP9MzjkTE6eKLMUi9sAFyVTFKqwKQKzbj54rtRZqLC6hiZV+WTUAsSRFOwticRmNWHu/KhRArNZALANCLDHFxcNX6G6gcJN2zIT7hdWQxBL9WE+LC0OI5UCE6/K9kCdeC0WsOhCrgUSugCcFCaXxXgdiNZBUVQFPvCaGYS3TH8QtMB6r12zainV7mrQaAp54raixalUWaqy9ZNO+xtKePiSAWCQgVhO256UFLxYa78GKlZ0DA554jS1W4hLEGlysvGcm2H6sTCmINTaxTEAsEh3FsgGxuCldxCpeNm+kiVUzKyCxluZ0iMVNaS9W7aVroy5i3R2fiF/Xj15YC1QCsbhALJpYDR21DQP9VLGIXb+DALEy2ou1iXIOreVRQI3FZTRiNTfe29VYNCAWl/mKxQJicZmxWNuFPBWi8V4uh1gZXcTarUitK3MGadaKLhCrwmjEMjJwGwti2ZmvWLsVxKoun+bEa+roPuJIP31sn32kn7GNRevBysJU+RtiNRFQjZXIpLwmbdTtVBh1bbxDLDujESvE7gaIZQdikYBYXOYr1h5OhYZkiNVcjpGLlXL38wtrmgLE4jIasYz0cCq8fvzKnmjNYMZi3R0fUD6LEMtwKpTfNTGO4NaznqVYcbyOouZP4+zFWtdjJKeKNM9EoGc9U7HS9umRJS1jvmJljfd6vZ5OFWn+lpye9WzFSqPnvOwZjVimYxQm+ehukDP6Nc9EYBbLlD61EaQbOT7SUNmXQCwD+fxY9S+M61nPs8baraKoeVT3nMWSw5NNTQW9xjJlMGOx7o5rPt2eynmAQ/3C6r7F2ogA3R0bzLpFGyuF1o8lPn+3Hz0PduI1fuO9k1iOb+kIocwzEehZQyzJjQhTwJOChCUW+rHi1tMYBTbxGn88VmUAFnM8lv1UWAdiuRH1e7ATr+25xnI03utALCf3z85iy+XO8GKJLh71j8pG++xuqAOxXNyeivnwQ21jQazG5YGKlXpludyZnViy7b5bkcY2QCwn4smOoiMr0H6s/Yq1XaSNqzXtGxUQi8toxDLRQaz1YfWFE4jFZaZild9W7TI/FsSyE6hYVbMgVovVIZZkr2LtVnn/1abvoclNC5sPC2LtU6yeG++brKIqDXMCsbjMVax4LYeO3h3T+hsYA/2aFpJubw0ExErp1EEqp8cifeHEkAFqrCZCFati1oh63iGWZDRimYBYPWcDsVKGEysFYtmBWCTUDOgOzVosj9cY+Wg92qi9ylqEjaoD+5gD/VhhUl5DLAo+a6w8jHo4iTVWXNnIcIyyhkKNBbHcG0GsxuUQq4VYYp3OYulqQSzu6hBLYhJLXQ1icVefo1gGIFbf2UAsiaGNBbE6ZTMOsfIwVsLpT6w4hljdsoFYEr9iia8IvGOauwFiUfAqVipHP2IRGu9xr2K9PFf+gFhcfIuV/2jcqB+xNLM6ifXw5XPlL4jFxb9Y1XCORKz7Z/K7cnFtiouuYlFubw3FGMRS46lJMhKxbj96rtRaqLHc2OfnyXeWH7kSAZpY1ZDJGKZBjfsQy4BXsSRFOwtiOXHMM12KVet7ooplGOdS5mbeSNseYjUtD1Us1zzT7cUy9oKOXywx29PDV+huoNE8z/QyHQe1XFbHQ9nGRy3TVesbKLk1D65a1ldpHpBlGn9lHpPVsh/raXFhCLHc2OeZrtRYagiu8hRjCbOmeTVmeuGbaqws5K6NiI13tcpCzzt39Z5qLEFXsZb9iBVDLMLysMVqbGNVe8t1sSqOLJdxd7GWECumLA9bLOfEa2X9U76vmlhabAqxat3rLLFSlRs2qh5jPpQBYoUilrMfqxArtoqlvOFXsVK/dRSLu1E++ApihSBWnc5ipQsrnaAQC2LpO8taO1SxlsVCt1hqYj9iCasiUwrE6pCNV7Fii1iFPppYSlbaH/7FsqRArA7Z+BZLr4HCEKtyjFaxFLPCF8tGT2IxV/coltrVUARBFUtvTEGsTmLZZetDLLvLV3q6snwvYsVBi2XPDmJVcg9GrLyuahZLL3NbsdSrTFt+EMuxeHxiLbViDyuWjT2JVd7Q7iqWKaOm2+0tMO7SmK4kexGrdCZ/R2tiLQliZTqaxRK/ximW8rqjWKaMGg/KuTj0Gku74Et3rZQjrje+2GItIRbEinsWqzgK/2LlakGsIcUqT7DL6mi7pVii/52NAjQOw7MNEcyXyvyNafaWQol1UrXaihJ9WUhimV5V6Vmsyo4Gr7HivFjK3+mvrDoxne+yolpisFzSaywVxlWhIKrc7YFYw4pVPcSsUNrfsV2sTE2IBbEaxRI/rvS/HWLFBLGWV7W2WfGqX7GUu4YQa0ixYtMhmortEGuZ13G2GNTFWhLFshykRawIYo1SLOOlX54FUyzHntQUjlgxxJq9WOROBUuVNSexWNjFqh5GuddwxZL1j6ONVZqnbmDdk5ZSbTi5ton02f1CF0tJLg+KbkZ189i6uTPPwcUqmvmOD5Y1qbCSs5FsvKe1EE0s2U06nqvCqhlzFStfE2KxHZqpWMZVTG/d0pri2CjdshCL2rRIz6xR+vWJmlnexDJ+mUmWB2IR8DjxmoXiWOoeW8RaZv1Y1U4E5466imWelCctTweHIFZJz2JdFcdSM8vZq7pnscxfGM+K094hiFXSt1iGc2DDRoVYcf1Y7WJ1u6VjnZSHn1Xo2G/W88Ryzuhn2m+LlP1tRMqu5fxY9blTmvbaR8/mgNl0Ess9ox+jHGFs5Ess86Q8TXuds1ju2WYY5djvRqyb0NWkXttYrr3OWSz3jH7BQh7oZ6LVVaFpUp7yPTAzZ7HcM/oxyjHtGsvej+Xa65zFcs/oxyjHxMXSgFjNVBoP84ATIBNDl39fdBFLbzwUkWsV7glu5CVrbkn8Zk9fvUM/Fn9nE9/IS9bzEKvjzia+kZesZywWAHUgFvACxAJegFjACxALeKGrWMYOCCe3p/K5ttqT3hvJ1mbtTWwjdsXZk/qYBP6hNcPLs/7QBufaaWCp69+kUaGXSIxtoa/eUSx9IA0FcUtIPNtWe9J7I+na/L2Ju5uMPamP++TvrBlenoaHjzrIAktdX0jLO8rLRFv66h3F0m/yULgRxXp5rj/pvYlsbfbeRLAZe9Ie98k/NEJ5OHmaHj7qIAssZxeso7z9+NNzxgF0FEu/LU0l2aJ80jtpg3Rt9t7Eh4u1J+Xhee0OrSF7Xp71R/k1wCx2Eh7y6g9f/vYLzjvQUSx9IA0RcctRf9J7E9na3L3JdVl7Uh732erQGmDmWX/4qBsRWPr6t6dPn9NXvzwTp0F67gPUWPfPzrJX3HYWd283RTuTuqdR11gysJxdMI4yWe9hnzVWi4bI7WnxJnPF4u7t5VnxiiFWKG0s08NHnWvLwPKaceSQppfYZ3trY5kH0rjIvNKf9N5EtjZzb+kJkLUn5XGf/EMjlIiXZ/3ho66VT885u8hOaowSiRqLvvre+7GU3qWn9PNMtjZvb1mdzdnTiPux8sAy1ueFdK/9WACYgVjACxALeAFiAS9ALOAFiAW8ALGAF0IWa7fKZng83L5xMXRhAI+QxRJAqZECsYAXxiFW8nP7xmeLKDraJj9O0rPkoxdDFy5E1ofJj83h0MUYkViLx6/iTSR+PHqxWyWR2ySvQZXr5PO2W50MXYwxiZUEK/3xxoWIXnx3PHz4wkNEZfvm8JX5eMQSL/Ifm/Rq8Wjo0oVIchoM4Ew4VrFwFrSyffMPAZwJRyrW9QGuFW3sVh8EcCYcqVi7VVJlwS4zmyiAM+FIxZLdDfDKjLzCGZzQxQJsQrgmhFgTZBPExTLEmhiyIzkAIBbwAsQCXoBYwAsQC3gBYgEvQCzgBYgFvACxgBcgFvACxAJegFjACxALeAFiAS9ALOAFiAW8ALGAFzqKdR3l46t3//qTKHrtQ/Ey+9YfvgOfU4/NT79R/phkoDqKtc6/ESLmVBC8HU87Xm0wxUZ+IKccqG5ibRd/lX5X5u44evu/4/g/3xcB20wxUO0xxGb33ULEbcqB6ibW5tF/LOTQ/U32dfd06o4Jx6sFxthci4VTDlQnse6OD+VXR+PdKg/Rn+Jpx4uPOTYyblMOVCexRNNdNt8Tw5TFm+m2HFpQiU0elXXyYsqB6iSWCI6MG8SyA7HYZFc7uV0FU67h+bjEmnCguoiVXy0fKe2I7976ZtLx4mOODdpYdtJ2e/KJlHM4plc+d8cT/yC2wBgbXBXauc4Ctj64UPpqJh6vFhhis/tuIX5POVAdxFpn8whdi973vHdZztk74Xi1QYuN1vM+4UC1F2u7yBqlaSPix98sivthE45XK9TYSKsO3krvFU44UBjdALwAsYAXIBbwAsQCXoBYwAsQC3gBYgEvQCzgBYgFvACxgBcgFvBCB7FenwddIzx0+fdF5bC7iFW+vLKuNHxKx+y6i+XeVX8Je9iFIwFiMVMgFi0BYjFTIBYtoZ1Yt7/8Vv6+f/bk3R/yhRCroBIfQ5gglombJ+/IwD18cR5fvpcvhVg5lfiYwgSxDLx8+nX6ibz/9bfFhxNiFVTjYwoTxDKShen2kx/i+189j7Nr6Kuc5fJqsnBOhVl8bGGaNJ3Eunk3j5igzGq5tG45hxqrGh9TmCZZYynve181lgBiFdhqrDKD6Ym1XKpvezexbG0siDWXNtZSQ92ik1gPX5wZrwohlhYfU5imIZZNq05iif+WfiyIpcdnev1YZpvULbz0vM9eLBcjF0s/+fXd3WAEYpEYtVjVmgpi9ZbdjMUyNaWsW0AsZsp8xTK1qQYTi14SiNVQhgDE4mwBsZgpsxXLeAkIsXrLbsZisbaAWMyUuYi1rMPKCmIxUyYolsEhI6x9QCxmyvTEImjUolAQi5kyBbFsDvVZKIjFTOku1gCj7tynOC+7hFjMlDHWWJTWUt+FgljMlPDFamx370FqiMVOCU+s5su5ypsQjljl05dcQCwS/sVqndO+xdqtDg1La8xUrLvjk+oiJ32LtZcWEz+BIhYxdHMW65r+TImexbIPtgtfrN0KYhWvghOrRT/WPhJIbSxa2ExfWJ3eV1eDEku2qMYr1t0x6ZGy7hore4Uaq0ex0pb6eMUiArFI9CVWcQEIsZwlGbFY+SMHaU8J7y5WpWNhzGJt0kc9u5mpWFw6i1Xt9RyxWPIBjXfHDWZBLBKdxOJ0pIcvVtaP1dSOmK9Y18XDdwl0Ect4CxliOUsyXrHSRxUnUXr8Kl1QfKP+8ongXP5+p49JQVijOMMXC6dCp1ibTKjdKg2QPjOkmBzr5bmyOsRSQOO9eFUTq7wvkRmmzVok5sV6+PK5sj7E4jJTsco7qVlbQZtnTVRdyalRnBDjzlNF+hrt6QOIxUxpFkudGVL+vv1IrbU61FjmgQwjrbGSuOGWTusa66aYF6toZ0EsLhArFUttY708y1eDWHXQ3eAWq3JLR5kZMj0Bimrr4avO3Q22b0FALGdJRitWnbQfS04VmZ4RL588eVpcGLYVy/r1mrGKtSk+kA0DlCEWifZiMbcIXayehiYrYvE+eOGLJeOzW+Ud7w1ALC5zFWu7SLuO17QxWRCrpI+vf01XrPVh9YWTlmLxv78cvli71dFuddJ4QpypWLXuhgZai8XdInyxROjWR/F1QyMCYkGsMoEq1uawjFv5oAXDeBDBrMTKBzWUwxzcQKyStbQqj5syLMQwHkQwK7HSQUWxapiTFmI5p4gZs1giZOvo4CL9q7xlYRoPIpiXWPFaRqYc6OeGL5Z77qExi6VT3mS1jQcxfWFVGfExosEfdUwdpPKqOf/cNdFGLO4W7F30n9BCrHJYiGk8iGBmNRYPiJVS/9qc/sDQ6m17AcRywB/oN8oavkWNpT8wFGIxQY1loxwWYhoPIoBYDiCWwiaKTspemnJYiGE8iABiOWCL1TQuZMRirR//+fikcV4/iEUCYhXIYe8n/Q30m5ZY3icFgVjFq1mJxQVilWzEqbC/b0JDLMZb1Thb0ZjFSme96O2b0KbkcYtFG7CmZkB9q8p7OZMUi8R8xSIOWFMzoIvVWLjxitXLrMlTFos4YE3NAGLFPr9MMSGx1AFrTlhiESbuG7FYrBFsgrmJVRmw5oYpVnPhxitW33M3TE8sfcCaG7pY+iisCYpFZMZi6dSGbpcLYoZYy8mLhcY7S6za0G19ij+GWLTCjVcsNN4pp8LiXmpt6LY+zogqVufHV4YvFhrvhMZ7+fS92tDtcgFnRr9RDu8rQeOdmWLrbogNM/plQ7fVKf5oNVYvz0UdQY1FA2IZ5iAV7Sx9AUGsfh64C7Eayhi+WPp85bWh2+w2lvEu/STF6nc67umJpd2lrw3dVqb4iyGWSs8PEJigWBq1odvcfqy5iEWdKrK4IiB/YXWEVz57GI9l/tbzjMUqXs2qxqLPV65m4BaLVbjxioVTIe9U6AZiKaDxXrwyD/QjPlKuzMD+jnAnRx61WCTmKxbxnpeagXVX7Fm3IVZRksmJRbznpWbgEKuxCMSEEYil3WO18npyupRZRGlwxOlTvIrk8uVS/k5KkizM1ktXTNPjq6jYvoffVz3lk/2+Kv4211j9Nd5nJZZ2j9VKtxrLGtAx1FgcIFbBXrobghZLKRzEoiVALEqKS6ye+7HmJNZe+rFGKxYXiKWwh29CQ6zarnQmKRaJOYsle5BpnVkNI0hHePvUCMSipDSJRWsrqBnYdmUPwyRrrD3c0hmzWMSrGzUDiCVA4x1icRPQ3UBJaToVXosvQeNUqCZALEpKY43FmC0SYpXgVLi37oZ5iYXGO8TiJqC7gZLSJFZfU0W2ecjXiMWaaRvLXDjzCFLS06DVDIyFEF719+ZCrOrLWiF7TfEgVl8jSMVu5iPWprjiyT+W5dfkDF+YE8xNrL7GvM9LrNoHspzuyTTxk2BuYhG7RtUMIFadcioC06QEgtmJ1VPjfW5iVcaxlZOnVCZ+Ws4B86lQ64opGwi3p/LRxtmMkSkQq8Ldz7O5W8vpnkwTP7n3R0mp1RRXpoXGNfVtaGvad2QsdnPjvWwgiNiIObKKZ4WWGUCsknx+fFONJZivWHrjvWwg3Ai9Xp6Xj80uMzDFQe56jmJlp8LmNtbcxIq3byqtK/3jlrzKZoyMm6aKnMoYPwlDrHVWY5XTPZkmfqq8D/Z3yJoyPrH0RqjWQBAhymaM1DJAjRUXcSvmxy/nf7L0Y/V2HTcSsXTUGuv+2Vm2tPJMdohFB2KlKA2E29Oi2Q6x7PyOektnVmLJS0LZ/swaoWUDIfMqmzFSywBi5STnQ/K9wjGL1VS4ZrHKpoLovxLN9mzGSDWDyq6yTjJXGaYp1obw7SaI1brnvfRqVmLJxnvzwBCI1UEsw56sRSAmhC7WRl4PriFWCsSiJTSKld2ugFgZEIuW0FxjXcvmFcTKgFi0BEoba7dCG6t4ZRCL8d2v2CiW2sUxJ7HivNpyM1OxuEAsnaTaQj9WDLGoCZye9/+FWBCLmoB7hczC9S9W3jXaUIYZi9Vtmmz3dNxJ7PO/xcTe6fL0Damky3m/0/2U6eKVlt5Uzsrvq+Lv3sXSvYJYdTzUWGWKjxqrVeE8iEUrA8Ry7Q9i1aaKnNS40RKIxSwcaixawvzE6li4vsVaQqwmIBaJmljEMsxYLJ+n7KYn/+7tGcEQi5aAGotZuD7FKof3EcoAsVz7g1gQi41XsRSmIxarDBDLtb+hxOqvCBCLljBCsUoglisBYvWRArE85gSxylcQC2L1kgKxPOYEscpX9m0gFsRqlTK8WLVZpQ2T8kAsOhArpTartGlyaYhFB2Kl1GY8NE18CLHoBCJWU4p3sWpztFYml+7rdnjYQCxmSrNYtVmlTZNLo8aiA7FSHDVWmQHEogOxUtDGiiEWP4VyVViZVdo0uTTEogOxMmqzSqMfC2I1pqDnnZbQp1jzoH2AZhWmHsVSgxfwNvvbUb8ZsrfYwy4YW0Cs/nbUb4YQi7W//W8DsQbZoh+xAKgAsYAXIBbwAsQCXoBYwAs9iKXdwCCiPeedhryty92X3Ii1s+xB9G0Oygo7M+ax8st8k0aEVTAxMJa+RXex9IG4RLTnvJO4EZHg7ktuxNpZ9iD6Vgdlg50Z81j5ZRbi1sZQN3GZyEvfortY+iARGvpz3im8fPq1uMnL21e6EWtn2YPo2xyUFW5m3GNtV+ba+J6m9T/+9JxRqO5i6cPaaJTPeWfsJzke9r6yIQe8ndXG6nWEnxn/WPllTioezhYPX/42qa3oW3QXSx+IS0N/zjtxmyTY7H3Jd4i5MzGcqs1BWeFnxj5WdplvT58+Z21xeSZOg/QthqmxJMx2Vusai7kz+SD6kdVYbcrMq+OSVR/2XGO1bo60EIu9L75Y6QPDB21jsY+1XZlZrbL0cddn+2xj6QNxaejPeachjoe9r/ycQt5Z9iD6NgdlhZ8Z71j5Zc7OaLyCiRqLvsVw/VhPmSeaTv1Y5J3lD6IfUz9WizJnIQm6HwsAAxALeAFiAS9ALOAFiAW8ALGAFyAW8EL4Yu1WR0MXAfCBWMALEAt4YURibRdRFCWv746jg8/efDFsqYJlfZj82BwOXYwRiXV3fJJE7NGLu+Oj5PUjiGXmOonMbnUydDFGJNb/vUp+bN+4EJETgg1bqmARn79tAPX5eMRKPozJqfDgYvM4MSyE0AVKchoM4Ew4IrHujg8uRI0Fsdxs3/xDAGfCEYl1LYS6PkhPhdc4FdrYrT4I4VM3IrFEhbU4uEDjvYFNFMCZcBRiRZHsZ1gnLax/TpqmorvhHyGWle0igDPhCMQyIs+LwEgY7c/xiSVOibtVCLV9oGyCuFMxPrGSNkQURCsiTLaLMCrzEYoFxgDEAl6AWMALEAt4AWIBL0As4AWIBbwAsYAXIBbwAsQCXoBYwAsQC3gBYgEvQCzgBYgFvPD/1S4Cp8O7ERkAAAAASUVORK5CYII=" alt="Plotting time series features for GAM models in mvgam" width="60%" style="display: block; margin: auto;" /></p>
<div id="modelling-dynamics-with-splines" class="section level3">
<h3>Modelling dynamics with splines</h3>
<p>The first model we will fit uses a shared cyclic spline to capture
the repeated seasonality, as well as series-specific splines of time to
capture the long-term dynamics. We allow the temporal splines to be
fairly complex so they can capture as much of the temporal variation as
possible:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a>mod1 <span class="ot">&lt;-</span> <span class="fu">mvgam</span>(</span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>  y <span class="sc">~</span> <span class="fu">s</span>(season, <span class="at">bs =</span> <span class="st">&quot;cc&quot;</span>, <span class="at">k =</span> <span class="dv">8</span>) <span class="sc">+</span></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>    <span class="fu">s</span>(time, <span class="at">by =</span> series, <span class="at">bs =</span> <span class="st">&quot;cr&quot;</span>, <span class="at">k =</span> <span class="dv">20</span>),</span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>  <span class="at">knots =</span> <span class="fu">list</span>(<span class="at">season =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">12.5</span>)),</span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>  <span class="at">trend_model =</span> <span class="st">&quot;None&quot;</span>,</span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a>  <span class="at">data =</span> simdat<span class="sc">$</span>data_train,</span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a>  <span class="at">silent =</span> <span class="dv">2</span></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a>)</span></code></pre></div>
<p>The model fits without issue:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="fu">summary</span>(mod1, <span class="at">include_betas =</span> <span class="cn">FALSE</span>)</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a><span class="co">#&gt; GAM formula:</span></span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a><span class="co">#&gt; y ~ s(season, bs = &quot;cc&quot;, k = 8) + s(time, by = series, k = 20)</span></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a><span class="co">#&gt; &lt;environment: 0x000002118a50f610&gt;</span></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a><span class="co">#&gt; Family:</span></span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a><span class="co">#&gt; poisson</span></span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a><span class="co">#&gt; Link function:</span></span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a><span class="co">#&gt; log</span></span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a><span class="co">#&gt; Trend model:</span></span>
<span id="cb6-13"><a href="#cb6-13" tabindex="-1"></a><span class="co">#&gt; None</span></span>
<span id="cb6-14"><a href="#cb6-14" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-15"><a href="#cb6-15" tabindex="-1"></a><span class="co">#&gt; N series:</span></span>
<span id="cb6-16"><a href="#cb6-16" tabindex="-1"></a><span class="co">#&gt; 3 </span></span>
<span id="cb6-17"><a href="#cb6-17" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-18"><a href="#cb6-18" tabindex="-1"></a><span class="co">#&gt; N timepoints:</span></span>
<span id="cb6-19"><a href="#cb6-19" tabindex="-1"></a><span class="co">#&gt; 100 </span></span>
<span id="cb6-20"><a href="#cb6-20" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-21"><a href="#cb6-21" tabindex="-1"></a><span class="co">#&gt; Status:</span></span>
<span id="cb6-22"><a href="#cb6-22" tabindex="-1"></a><span class="co">#&gt; Fitted using Stan </span></span>
<span id="cb6-23"><a href="#cb6-23" tabindex="-1"></a><span class="co">#&gt; 4 chains, each with iter = 1000; warmup = 500; thin = 1 </span></span>
<span id="cb6-24"><a href="#cb6-24" tabindex="-1"></a><span class="co">#&gt; Total post-warmup draws = 2000</span></span>
<span id="cb6-25"><a href="#cb6-25" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-26"><a href="#cb6-26" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-27"><a href="#cb6-27" tabindex="-1"></a><span class="co">#&gt; GAM coefficient (beta) estimates:</span></span>
<span id="cb6-28"><a href="#cb6-28" tabindex="-1"></a><span class="co">#&gt;             2.5% 50% 97.5% Rhat n_eff</span></span>
<span id="cb6-29"><a href="#cb6-29" tabindex="-1"></a><span class="co">#&gt; (Intercept)  1.9 1.9     2    1  1458</span></span>
<span id="cb6-30"><a href="#cb6-30" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-31"><a href="#cb6-31" tabindex="-1"></a><span class="co">#&gt; Approximate significance of GAM smooths:</span></span>
<span id="cb6-32"><a href="#cb6-32" tabindex="-1"></a><span class="co">#&gt;                         edf Ref.df Chi.sq p-value    </span></span>
<span id="cb6-33"><a href="#cb6-33" tabindex="-1"></a><span class="co">#&gt; s(season)              3.50      6   23.0 &lt; 2e-16 ***</span></span>
<span id="cb6-34"><a href="#cb6-34" tabindex="-1"></a><span class="co">#&gt; s(time):seriesseries_1 6.45     19   55.4 0.00042 ***</span></span>
<span id="cb6-35"><a href="#cb6-35" tabindex="-1"></a><span class="co">#&gt; s(time):seriesseries_2 9.70     19   45.5 &lt; 2e-16 ***</span></span>
<span id="cb6-36"><a href="#cb6-36" tabindex="-1"></a><span class="co">#&gt; s(time):seriesseries_3 5.52     19   56.6   9e-05 ***</span></span>
<span id="cb6-37"><a href="#cb6-37" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb6-38"><a href="#cb6-38" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb6-39"><a href="#cb6-39" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-40"><a href="#cb6-40" tabindex="-1"></a><span class="co">#&gt; Stan MCMC diagnostics:</span></span>
<span id="cb6-41"><a href="#cb6-41" tabindex="-1"></a><span class="co">#&gt; ✔ No issues with effective samples per iteration</span></span>
<span id="cb6-42"><a href="#cb6-42" tabindex="-1"></a><span class="co">#&gt; ✔ Rhat looks good for all parameters</span></span>
<span id="cb6-43"><a href="#cb6-43" tabindex="-1"></a><span class="co">#&gt; ✔ No issues with divergences</span></span>
<span id="cb6-44"><a href="#cb6-44" tabindex="-1"></a><span class="co">#&gt; ✖ 60 of 2000 iterations saturated the maximum tree depth of 10 (3%)</span></span>
<span id="cb6-45"><a href="#cb6-45" tabindex="-1"></a><span class="co">#&gt;     Try a larger max_treedepth to avoid saturation</span></span>
<span id="cb6-46"><a href="#cb6-46" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-47"><a href="#cb6-47" tabindex="-1"></a><span class="co">#&gt; Samples were drawn using sampling(hmc). For each parameter, n_eff is a</span></span>
<span id="cb6-48"><a href="#cb6-48" tabindex="-1"></a><span class="co">#&gt;   crude measure of effective sample size, and Rhat is the potential scale</span></span>
<span id="cb6-49"><a href="#cb6-49" tabindex="-1"></a><span class="co">#&gt;   reduction factor on split MCMC chains (at convergence, Rhat = 1)</span></span>
<span id="cb6-50"><a href="#cb6-50" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb6-51"><a href="#cb6-51" tabindex="-1"></a><span class="co">#&gt; Use how_to_cite() to get started describing this model</span></span></code></pre></div>
<p>And we can plot the conditional effects of the splines (on the link
scale) to see that they are estimated to be highly nonlinear</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="fu">conditional_effects</span>(mod1, <span class="at">type =</span> <span class="st">&quot;link&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" alt="Plotting GAM smooth functions using mvgam" width="60%" style="display: block; margin: auto;" /><img src="data:image/png;base64,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" alt="Plotting GAM smooth functions using mvgam" width="60%" style="display: block; margin: auto;" /></p>
</div>
<div id="modelling-dynamics-with-a-correlated-ar1" class="section level3">
<h3>Modelling dynamics with a correlated AR1</h3>
<p>Before showing how to produce and evaluate forecasts, we will fit a
second model to these data so the two models can be compared. This model
is equivalent to the above, except we now use a correlated AR(1) process
to model series-specific dynamics. See <code>?AR</code> for more
details.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>mod2 <span class="ot">&lt;-</span> <span class="fu">mvgam</span>(y <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>  <span class="at">trend_formula =</span> <span class="sc">~</span> <span class="fu">s</span>(season, <span class="at">bs =</span> <span class="st">&quot;cc&quot;</span>, <span class="at">k =</span> <span class="dv">8</span>) <span class="sc">-</span> <span class="dv">1</span>,</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>  <span class="at">trend_knots =</span> <span class="fu">list</span>(<span class="at">season =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">12.5</span>)),</span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a>  <span class="at">trend_model =</span> <span class="fu">AR</span>(<span class="at">cor =</span> <span class="cn">TRUE</span>),</span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a>  <span class="at">noncentred =</span> <span class="cn">TRUE</span>,</span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a>  <span class="at">data =</span> simdat<span class="sc">$</span>data_train,</span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a>  <span class="at">silent =</span> <span class="dv">1</span></span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a>)</span></code></pre></div>
<p>The summary for this model now contains information on the
autoregressive and process error parameters for each time series:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="fu">summary</span>(mod2, <span class="at">include_betas =</span> <span class="cn">FALSE</span>)</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a><span class="co">#&gt; GAM observation formula:</span></span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a><span class="co">#&gt; y ~ 1</span></span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a><span class="co">#&gt; &lt;environment: 0x000002118a50f610&gt;</span></span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a><span class="co">#&gt; GAM process formula:</span></span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a><span class="co">#&gt; ~s(season, bs = &quot;cc&quot;, k = 8) - 1</span></span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a><span class="co">#&gt; &lt;environment: 0x000002118a50f610&gt;</span></span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a><span class="co">#&gt; Family:</span></span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a><span class="co">#&gt; poisson</span></span>
<span id="cb9-12"><a href="#cb9-12" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-13"><a href="#cb9-13" tabindex="-1"></a><span class="co">#&gt; Link function:</span></span>
<span id="cb9-14"><a href="#cb9-14" tabindex="-1"></a><span class="co">#&gt; log</span></span>
<span id="cb9-15"><a href="#cb9-15" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-16"><a href="#cb9-16" tabindex="-1"></a><span class="co">#&gt; Trend model:</span></span>
<span id="cb9-17"><a href="#cb9-17" tabindex="-1"></a><span class="co">#&gt; AR(cor = TRUE)</span></span>
<span id="cb9-18"><a href="#cb9-18" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-19"><a href="#cb9-19" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-20"><a href="#cb9-20" tabindex="-1"></a><span class="co">#&gt; N process models:</span></span>
<span id="cb9-21"><a href="#cb9-21" tabindex="-1"></a><span class="co">#&gt; 3 </span></span>
<span id="cb9-22"><a href="#cb9-22" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-23"><a href="#cb9-23" tabindex="-1"></a><span class="co">#&gt; N series:</span></span>
<span id="cb9-24"><a href="#cb9-24" tabindex="-1"></a><span class="co">#&gt; 3 </span></span>
<span id="cb9-25"><a href="#cb9-25" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-26"><a href="#cb9-26" tabindex="-1"></a><span class="co">#&gt; N timepoints:</span></span>
<span id="cb9-27"><a href="#cb9-27" tabindex="-1"></a><span class="co">#&gt; 75 </span></span>
<span id="cb9-28"><a href="#cb9-28" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-29"><a href="#cb9-29" tabindex="-1"></a><span class="co">#&gt; Status:</span></span>
<span id="cb9-30"><a href="#cb9-30" tabindex="-1"></a><span class="co">#&gt; Fitted using Stan </span></span>
<span id="cb9-31"><a href="#cb9-31" tabindex="-1"></a><span class="co">#&gt; 4 chains, each with iter = 1000; warmup = 500; thin = 1 </span></span>
<span id="cb9-32"><a href="#cb9-32" tabindex="-1"></a><span class="co">#&gt; Total post-warmup draws = 2000</span></span>
<span id="cb9-33"><a href="#cb9-33" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-34"><a href="#cb9-34" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-35"><a href="#cb9-35" tabindex="-1"></a><span class="co">#&gt; GAM observation model coefficient (beta) estimates:</span></span>
<span id="cb9-36"><a href="#cb9-36" tabindex="-1"></a><span class="co">#&gt;             2.5% 50% 97.5% Rhat n_eff</span></span>
<span id="cb9-37"><a href="#cb9-37" tabindex="-1"></a><span class="co">#&gt; (Intercept)  1.7   2   2.4 1.02   456</span></span>
<span id="cb9-38"><a href="#cb9-38" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-39"><a href="#cb9-39" tabindex="-1"></a><span class="co">#&gt; Process model AR parameter estimates:</span></span>
<span id="cb9-40"><a href="#cb9-40" tabindex="-1"></a><span class="co">#&gt;        2.5%  50% 97.5% Rhat n_eff</span></span>
<span id="cb9-41"><a href="#cb9-41" tabindex="-1"></a><span class="co">#&gt; ar1[1] 0.73 0.89  0.99 1.01   530</span></span>
<span id="cb9-42"><a href="#cb9-42" tabindex="-1"></a><span class="co">#&gt; ar1[2] 0.66 0.83  0.95 1.01   525</span></span>
<span id="cb9-43"><a href="#cb9-43" tabindex="-1"></a><span class="co">#&gt; ar1[3] 0.88 0.96  1.00 1.01   679</span></span>
<span id="cb9-44"><a href="#cb9-44" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-45"><a href="#cb9-45" tabindex="-1"></a><span class="co">#&gt; Process error parameter estimates:</span></span>
<span id="cb9-46"><a href="#cb9-46" tabindex="-1"></a><span class="co">#&gt;          2.5%  50% 97.5% Rhat n_eff</span></span>
<span id="cb9-47"><a href="#cb9-47" tabindex="-1"></a><span class="co">#&gt; sigma[1] 0.24 0.33  0.45 1.01   568</span></span>
<span id="cb9-48"><a href="#cb9-48" tabindex="-1"></a><span class="co">#&gt; sigma[2] 0.31 0.42  0.58 1.00   387</span></span>
<span id="cb9-49"><a href="#cb9-49" tabindex="-1"></a><span class="co">#&gt; sigma[3] 0.19 0.26  0.35 1.01   425</span></span>
<span id="cb9-50"><a href="#cb9-50" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-51"><a href="#cb9-51" tabindex="-1"></a><span class="co">#&gt; Approximate significance of GAM process smooths:</span></span>
<span id="cb9-52"><a href="#cb9-52" tabindex="-1"></a><span class="co">#&gt;           edf Ref.df Chi.sq p-value    </span></span>
<span id="cb9-53"><a href="#cb9-53" tabindex="-1"></a><span class="co">#&gt; s(season) 2.2      6   20.8 6.1e-06 ***</span></span>
<span id="cb9-54"><a href="#cb9-54" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb9-55"><a href="#cb9-55" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb9-56"><a href="#cb9-56" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-57"><a href="#cb9-57" tabindex="-1"></a><span class="co">#&gt; Stan MCMC diagnostics:</span></span>
<span id="cb9-58"><a href="#cb9-58" tabindex="-1"></a><span class="co">#&gt; ✔ No issues with effective samples per iteration</span></span>
<span id="cb9-59"><a href="#cb9-59" tabindex="-1"></a><span class="co">#&gt; ✔ Rhat looks good for all parameters</span></span>
<span id="cb9-60"><a href="#cb9-60" tabindex="-1"></a><span class="co">#&gt; ✔ No issues with divergences</span></span>
<span id="cb9-61"><a href="#cb9-61" tabindex="-1"></a><span class="co">#&gt; ✔ No issues with maximum tree depth</span></span>
<span id="cb9-62"><a href="#cb9-62" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-63"><a href="#cb9-63" tabindex="-1"></a><span class="co">#&gt; Samples were drawn using sampling(hmc). For each parameter, n_eff is a</span></span>
<span id="cb9-64"><a href="#cb9-64" tabindex="-1"></a><span class="co">#&gt;   crude measure of effective sample size, and Rhat is the potential scale</span></span>
<span id="cb9-65"><a href="#cb9-65" tabindex="-1"></a><span class="co">#&gt;   reduction factor on split MCMC chains (at convergence, Rhat = 1)</span></span>
<span id="cb9-66"><a href="#cb9-66" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-67"><a href="#cb9-67" tabindex="-1"></a><span class="co">#&gt; Use how_to_cite() to get started describing this model</span></span></code></pre></div>
<p>We can plot the posteriors for these parameters, and for any other
parameter for that matter, using <code>bayesplot</code> routines. First
the autoregressive parameters:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="fu">mcmc_plot</span>(mod2, <span class="at">variable =</span> <span class="st">&quot;ar&quot;</span>, <span class="at">regex =</span> <span class="cn">TRUE</span>, <span class="at">type =</span> <span class="st">&quot;areas&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" alt="Summarising latent Gaussian Process parameters in mvgam" width="60%" style="display: block; margin: auto;" /></p>
<p>And now the variance (<span class="math inline">\(\sigma\)</span>)
parameters:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="fu">mcmc_plot</span>(mod2, <span class="at">variable =</span> <span class="st">&quot;sigma&quot;</span>, <span class="at">regex =</span> <span class="cn">TRUE</span>, <span class="at">type =</span> <span class="st">&quot;areas&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" alt="Summarising latent Gaussian Process parameters in mvgam" width="60%" style="display: block; margin: auto;" /></p>
<p>We can again plot the conditional seasonal effect:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="fu">conditional_effects</span>(mod2, <span class="at">type =</span> <span class="st">&quot;link&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" alt="Plotting latent Gaussian Process effects in mvgam and marginaleffects" width="60%" style="display: block; margin: auto;" /></p>
<p>The estimates for the seasonal component are fairly similar for the
two models, but below we will see if they produce similar forecasts</p>
</div>
</div>
<div id="forecasting-with-the-forecast-function" class="section level2">
<h2>Forecasting with the <code>forecast()</code> function</h2>
<p>Probabilistic forecasts can be computed in two main ways in
<code>mvgam</code>. The first is to take a model that was fit only to
training data (as we did above in the two example models) and produce
temporal predictions from the posterior predictive distribution by
feeding <code>newdata</code> to the <code>forecast()</code> function. It
is crucial that any <code>newdata</code> fed to the
<code>forecast()</code> function follows on sequentially from the data
that was used to fit the model (this is not internally checked by the
package because it might be a headache to do so when data are not
supplied in a specific time-order). When calling the
<code>forecast()</code> function, you have the option to generate
different kinds of predictions (i.e. predicting on the link scale,
response scale or to produce expectations; see
<code>?forecast.mvgam</code> for details). We will use the default and
produce forecasts on the response scale, which is the most common way to
evaluate forecast distributions</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a>fc_mod1 <span class="ot">&lt;-</span> <span class="fu">forecast</span>(mod1, <span class="at">newdata =</span> simdat<span class="sc">$</span>data_test)</span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>fc_mod2 <span class="ot">&lt;-</span> <span class="fu">forecast</span>(mod2, <span class="at">newdata =</span> simdat<span class="sc">$</span>data_test)</span></code></pre></div>
<p>The objects we have created are of class <code>mvgam_forecast</code>,
which contain information on hindcast distributions, forecast
distributions and true observations for each series in the data:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="fu">str</span>(fc_mod1)</span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a><span class="co">#&gt; List of 16</span></span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a><span class="co">#&gt;  $ call              :Class &#39;formula&#39;  language y ~ s(season, bs = &quot;cc&quot;, k = 8) + s(time, by = series, k = 20)</span></span>
<span id="cb14-4"><a href="#cb14-4" tabindex="-1"></a><span class="co">#&gt;   .. ..- attr(*, &quot;.Environment&quot;)=&lt;environment: 0x000002118a50f610&gt; </span></span>
<span id="cb14-5"><a href="#cb14-5" tabindex="-1"></a><span class="co">#&gt;  $ trend_call        : NULL</span></span>
<span id="cb14-6"><a href="#cb14-6" tabindex="-1"></a><span class="co">#&gt;  $ family            : chr &quot;poisson&quot;</span></span>
<span id="cb14-7"><a href="#cb14-7" tabindex="-1"></a><span class="co">#&gt;  $ family_pars       : NULL</span></span>
<span id="cb14-8"><a href="#cb14-8" tabindex="-1"></a><span class="co">#&gt;  $ trend_model       : chr &quot;None&quot;</span></span>
<span id="cb14-9"><a href="#cb14-9" tabindex="-1"></a><span class="co">#&gt;  $ drift             : logi FALSE</span></span>
<span id="cb14-10"><a href="#cb14-10" tabindex="-1"></a><span class="co">#&gt;  $ use_lv            : logi FALSE</span></span>
<span id="cb14-11"><a href="#cb14-11" tabindex="-1"></a><span class="co">#&gt;  $ fit_engine        : chr &quot;stan&quot;</span></span>
<span id="cb14-12"><a href="#cb14-12" tabindex="-1"></a><span class="co">#&gt;  $ type              : chr &quot;response&quot;</span></span>
<span id="cb14-13"><a href="#cb14-13" tabindex="-1"></a><span class="co">#&gt;  $ series_names      : Factor w/ 3 levels &quot;series_1&quot;,&quot;series_2&quot;,..: 1 2 3</span></span>
<span id="cb14-14"><a href="#cb14-14" tabindex="-1"></a><span class="co">#&gt;  $ train_observations:List of 3</span></span>
<span id="cb14-15"><a href="#cb14-15" tabindex="-1"></a><span class="co">#&gt;   ..$ series_1: int [1:75] 6 2 7 11 8 6 9 11 7 4 ...</span></span>
<span id="cb14-16"><a href="#cb14-16" tabindex="-1"></a><span class="co">#&gt;   ..$ series_2: int [1:75] NA 5 8 2 1 NA 2 4 0 2 ...</span></span>
<span id="cb14-17"><a href="#cb14-17" tabindex="-1"></a><span class="co">#&gt;   ..$ series_3: int [1:75] 11 20 NA 36 44 34 57 50 26 28 ...</span></span>
<span id="cb14-18"><a href="#cb14-18" tabindex="-1"></a><span class="co">#&gt;  $ train_times       : int [1:75] 1 2 3 4 5 6 7 8 9 10 ...</span></span>
<span id="cb14-19"><a href="#cb14-19" tabindex="-1"></a><span class="co">#&gt;  $ test_observations :List of 3</span></span>
<span id="cb14-20"><a href="#cb14-20" tabindex="-1"></a><span class="co">#&gt;   ..$ series_1: int [1:25] 4 3 1 3 1 NA NA 7 9 8 ...</span></span>
<span id="cb14-21"><a href="#cb14-21" tabindex="-1"></a><span class="co">#&gt;   ..$ series_2: int [1:25] 23 NA 20 20 14 7 6 6 6 1 ...</span></span>
<span id="cb14-22"><a href="#cb14-22" tabindex="-1"></a><span class="co">#&gt;   ..$ series_3: int [1:25] 8 3 8 3 NA 1 1 9 8 NA ...</span></span>
<span id="cb14-23"><a href="#cb14-23" tabindex="-1"></a><span class="co">#&gt;  $ test_times        : int [1:25] 76 77 78 79 80 81 82 83 84 85 ...</span></span>
<span id="cb14-24"><a href="#cb14-24" tabindex="-1"></a><span class="co">#&gt;  $ hindcasts         :List of 3</span></span>
<span id="cb14-25"><a href="#cb14-25" tabindex="-1"></a><span class="co">#&gt;   ..$ series_1: num [1:2000, 1:75] 1 4 6 5 2 5 6 3 6 0 ...</span></span>
<span id="cb14-26"><a href="#cb14-26" tabindex="-1"></a><span class="co">#&gt;   .. ..- attr(*, &quot;dimnames&quot;)=List of 2</span></span>
<span id="cb14-27"><a href="#cb14-27" tabindex="-1"></a><span class="co">#&gt;   .. .. ..$ : NULL</span></span>
<span id="cb14-28"><a href="#cb14-28" tabindex="-1"></a><span class="co">#&gt;   .. .. ..$ : chr [1:75] &quot;ypred[1,1]&quot; &quot;ypred[2,1]&quot; &quot;ypred[3,1]&quot; &quot;ypred[4,1]&quot; ...</span></span>
<span id="cb14-29"><a href="#cb14-29" tabindex="-1"></a><span class="co">#&gt;   ..$ series_2: num [1:2000, 1:75] 4 6 3 7 4 9 5 5 7 6 ...</span></span>
<span id="cb14-30"><a href="#cb14-30" tabindex="-1"></a><span class="co">#&gt;   .. ..- attr(*, &quot;dimnames&quot;)=List of 2</span></span>
<span id="cb14-31"><a href="#cb14-31" tabindex="-1"></a><span class="co">#&gt;   .. .. ..$ : NULL</span></span>
<span id="cb14-32"><a href="#cb14-32" tabindex="-1"></a><span class="co">#&gt;   .. .. ..$ : chr [1:75] &quot;ypred[1,2]&quot; &quot;ypred[2,2]&quot; &quot;ypred[3,2]&quot; &quot;ypred[4,2]&quot; ...</span></span>
<span id="cb14-33"><a href="#cb14-33" tabindex="-1"></a><span class="co">#&gt;   ..$ series_3: num [1:2000, 1:75] 16 10 11 17 11 15 22 16 8 6 ...</span></span>
<span id="cb14-34"><a href="#cb14-34" tabindex="-1"></a><span class="co">#&gt;   .. ..- attr(*, &quot;dimnames&quot;)=List of 2</span></span>
<span id="cb14-35"><a href="#cb14-35" tabindex="-1"></a><span class="co">#&gt;   .. .. ..$ : NULL</span></span>
<span id="cb14-36"><a href="#cb14-36" tabindex="-1"></a><span class="co">#&gt;   .. .. ..$ : chr [1:75] &quot;ypred[1,3]&quot; &quot;ypred[2,3]&quot; &quot;ypred[3,3]&quot; &quot;ypred[4,3]&quot; ...</span></span>
<span id="cb14-37"><a href="#cb14-37" tabindex="-1"></a><span class="co">#&gt;  $ forecasts         :List of 3</span></span>
<span id="cb14-38"><a href="#cb14-38" tabindex="-1"></a><span class="co">#&gt;   ..$ series_1: num [1:2000, 1:25] 1 2 3 1 3 6 1 3 0 0 ...</span></span>
<span id="cb14-39"><a href="#cb14-39" tabindex="-1"></a><span class="co">#&gt;   .. ..- attr(*, &quot;dimnames&quot;)=List of 2</span></span>
<span id="cb14-40"><a href="#cb14-40" tabindex="-1"></a><span class="co">#&gt;   .. .. ..$ : NULL</span></span>
<span id="cb14-41"><a href="#cb14-41" tabindex="-1"></a><span class="co">#&gt;   .. .. ..$ : chr [1:25] &quot;ypred[76,1]&quot; &quot;ypred[77,1]&quot; &quot;ypred[78,1]&quot; &quot;ypred[79,1]&quot; ...</span></span>
<span id="cb14-42"><a href="#cb14-42" tabindex="-1"></a><span class="co">#&gt;   ..$ series_2: num [1:2000, 1:25] 20 19 30 27 23 40 27 23 22 39 ...</span></span>
<span id="cb14-43"><a href="#cb14-43" tabindex="-1"></a><span class="co">#&gt;   .. ..- attr(*, &quot;dimnames&quot;)=List of 2</span></span>
<span id="cb14-44"><a href="#cb14-44" tabindex="-1"></a><span class="co">#&gt;   .. .. ..$ : NULL</span></span>
<span id="cb14-45"><a href="#cb14-45" tabindex="-1"></a><span class="co">#&gt;   .. .. ..$ : chr [1:25] &quot;ypred[76,2]&quot; &quot;ypred[77,2]&quot; &quot;ypred[78,2]&quot; &quot;ypred[79,2]&quot; ...</span></span>
<span id="cb14-46"><a href="#cb14-46" tabindex="-1"></a><span class="co">#&gt;   ..$ series_3: num [1:2000, 1:25] 1 5 2 3 2 2 2 1 0 1 ...</span></span>
<span id="cb14-47"><a href="#cb14-47" tabindex="-1"></a><span class="co">#&gt;   .. ..- attr(*, &quot;dimnames&quot;)=List of 2</span></span>
<span id="cb14-48"><a href="#cb14-48" tabindex="-1"></a><span class="co">#&gt;   .. .. ..$ : NULL</span></span>
<span id="cb14-49"><a href="#cb14-49" tabindex="-1"></a><span class="co">#&gt;   .. .. ..$ : chr [1:25] &quot;ypred[76,3]&quot; &quot;ypred[77,3]&quot; &quot;ypred[78,3]&quot; &quot;ypred[79,3]&quot; ...</span></span>
<span id="cb14-50"><a href="#cb14-50" tabindex="-1"></a><span class="co">#&gt;  - attr(*, &quot;class&quot;)= chr &quot;mvgam_forecast&quot;</span></span></code></pre></div>
<p>We can plot the forecasts for some series from each model using the
<code>S3 plot</code> method for objects of this class:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a><span class="fu">plot</span>(fc_mod1, <span class="at">series =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" width="60%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="fu">plot</span>(fc_mod2, <span class="at">series =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" width="60%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a></span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a><span class="fu">plot</span>(fc_mod1, <span class="at">series =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" width="60%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="fu">plot</span>(fc_mod2, <span class="at">series =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAlgAAAHgCAMAAABOyeNrAAAAt1BMVEUAAAAAADoAAGYAOpAAZrYzMzM6AAA6ADo6kNtNTU1NTW5NTY5NbqtNjshmAABmAGZmtv9uTU1uTW5uTY5ubo5ubqtuq+SOTU2OTW6OTY6Obk2OyP+PJyeQOgCQtpCQ2/+iUFCrbk2rbm6rbo6ryKur5OSr5P+zs7O2ZgC2//+5fHzHmZnIjk3I///bkDrb/7bb///cvLzkq27k////tmb/yI7/25D/5Kv//7b//8j//9v//+T///8XLV0xAAAACXBIWXMAAA9hAAAPYQGoP6dpAAAgAElEQVR4nO2d64LbNpKFNbnMpBMn60w2TrLd3sgzs5Yjuj0jO06n3Xj/51pRN5Ig6gYCBEmd86MtiVWoAvAZACGSWjkIyqBV6QSgZQpgQVkEsKAsAlhQFgEsKIsAFpRFVrAA4mQ07a4AWLPVtLsCYM1W0+4KgAVlEcCCsghgQVkEsKAsAliz1bS7AmDNVtPuCoA1W027KwDWbDXtrgBYUBYBLCiLABaURQALyiKANVtNuysA1mw17a4AWLPVtLsCYM1W0+4KgAVlEcCCsmiyYG3GCgRlEcCCsghgzVbTXpVw2b2/ubn55t49/nTz7IPGPqkAlqT5gvX2tv779OrWvf9WY59UAEvSbMF6+sfr+p/HX+7dww/3sn1aASxJswVrPwXe3Ny6hx8/uMefa8a+3AtgQSoxoDz8/XU9an18dgZLsE8rgDVvSaC8vW1GLI19MgGseUsGq9QaC2TNWgwo9Rz49M/7p1cvipwVAixBs1281/tYX792pfaxAJag+YKVwj5aAEsSwIoSwJIEsKIEsOatiYF1oWkDsGK0K53ARQBrUQJYhADWMAEsQm2wQBavUFcALEIASy+AZRDA0gtgGQSw9AJYBgGsYRoCVlooAdaiBLAIAaxhAliEANYg7QAWIYClV6ArABalC00bkCUJYBkEsPRKDNYgKPsCWLMVwDLoDNMGYMVoN4AOgAWRAliUANYgASxKAGuQABYlgKVXcPEeTcduCJQBAazZCmAZ1AULZHHqd8UQOAAWdBLAMghgDRHAInWGCWDFCGBR2gCsIRoAxw5gQaQAFiWAZVDSxTvAgs4CWHr5YIEuRgBLrzNHmw3IEhUGy0rHLt6VFcBajnZRYO0a15RkAazlKAaOHcCCJEWCtXMAC+IUC9YOYEEt9boiAo7dFYG1cQBLpXRg7QAW1CghWDuABV2UAKwdwIJkASxSAGuIABYpgDVEZjh8rgAWFJAdDoAFBeR3RQKwEpIFsGarwWD1uVo6WBuApRABlh4OgAWFBLD0AlgDNCZYsuEEwdoArCgBLFphsECWSgCLFsAaIIBFagOwDCq5eAdYC5bXFXY4AFbOmPMVwFILYFkEsNQCWAOUBCytM8C6Ho0JlsIOYC1FAIsWwIpXxDoJYOWMOV91uwJgMfKBAlicKLDUcACsnDHnK4ClFsCyCGCpBbDiNS+wnl7dOvf4082zDzr7gQJY0YqBoyBY729uD3C9/1ZnP1AAK1qjgqWxY0F5+O//uXWPv9y7hx/uNfZDBbCiNSuwnv7xf/vR6uHHD+7x59f791/uBbAmo05XxMBRDKz3L+pp8OOzM1iS/WABLIuygKVyHgjWfqh66oxYgv1wUWCBrJBmC9b7m1ovJrDGAlghtbsiajorBZY7bjc8vXpR+qwQYEmaI1gT2McCWJLmBtZwe5MAVqwAFiuAFatRwVKZAazZatDineIKYEGtroiD42rAIrkCWCEBLK0AlkkASyuAFSuAxQpgxQpgsQJYsQJYrABWpOxwkFwBLKjpinHB0pkBrNkKYGkFsEwCWFoBLJMuXRELB8ACWKwAliCAFSeAJYgGC2QxioYjkiyAdSWKZQNgAaygzl0BsCQBLJNOXRHNBsACWEEBLK0AlkmFwFKGAFgz1wA4ABbAogWwZAGsCAEsWQDLrig4OK4A1tXr0BUASyGAZRLA0gpgmTQbsN6sVp/9tv/398Nf2T65AJZJcwHrzef/cb+vnpcDi+EKYFGaPlh/fvf88PcLgDUnzQUs9+nlFwBrRhodLCV+3lToasBWAKuU7PWMgYPlKj1Y7s1ffq3/+fQSYJWSqaLRi/exwVIJYOXU4sH687+oQasQWFdClqmiAEspgOVMNc0Els5Zl11PAKuM7DUFWLIAlrNXFWDJAlgAK4sAlrPXNYINgSuAtUCZ6lp3RQwcg8DS0ecA1rS0eLDS2RsEsBYL1p/fPRe+KgRYWbVUsN584d599tu7L7T2aUUjBbAozQOs/YD16eXUrsdyq9XK9h3ajLVcsP787iuAVU5jgCVxlQGsTy+/+v0vv9YTos4+sQDWUsFyf/x19cX5gj+NfVphjTXK4r0EWArhrDCnAFYOAazlgvVutXr+bjpTYevDfGGnpMmDpaPvnN1Fbz7/93HHQWmfVn2ujuv2qwPLUNl5gHXYbnhearshMGABLEkASxYP1nWQNQJYIlc5psJ39VRY75Eq7ZMqvGLfXBNY9rrOBCz3+36MWHFcjQuWB9niZatr3OK9DFi62uQRwLKDFQGHDJZqgabJziSAlVGLBOt4LdZBU1m8AyxWMwFLKYCVUea6RsBRAqxPL5+b7NMKYE0fLBV8R3n7WCb7tAJYY4Cl4Co9WI7/mrBvn1QAa7FgTXrxfg1k2arKLd6nBZavjzc339w79/jTzbMPGvthAljXAtbDD/fu/bfu6dVt/Y9sP1AAy/j91fhgqeBrsmupdz3WHq7HX+4PjIXsUwpgLRes/vVY+6Hq4ccP7vHn1/s3X+4FsDLKXNeZgNW7bObh+69fu4/PzmD59mkFsEYAS8PVCGC5mqhmxPLt0wpgLRas0PVYb2+xxhpNEwdLBd9ZzPVYpznw6dULnBWOI1tdYxbvpcDq6v3NzX6NhX2s0WQFyw7HNMBKYa8XwFouWCWfjyVxdQ1kTRssFXyt7Foq+XwsgGVfvM8FrKLPxwJYI4Cl4ioLWOWejwWwJgOWxlnMbTLPxwJYzlzXuYBV9PlYAMsKFrt4D/f8ELA07HWyswlg5RPAyqFOo14pWM709AaApVLDT/tRIFcFVqvmKmuApRHAsoLFc2IwjfGV66KrQrS9WjJYyydrqWAVvWFVXmMtHizjGssClokrja+Y22RuWA2zdF1gWauqhsPGlcZXzG0yN6wCrIzbDYXBKnrDKsDKB5aRK42vIjubAFY+WcHSwmHlSuMrZ2esPMDKp0xgmbnS+MrZdd69K/cMUoBlXrwH+ruaJljv6tVVoacmAyxnretswDptN0z1eiyA5QlgaQSwlgtWyalQwdXiyTJWNbB4ryYKVsHFO8BaNFiK2hjttQJYucCyc6XxlbM7vzg9EURtn1gAKw1YVa/nAdYkwRozprWqLFg72kpPVgqwjuurYt8VAqwEYFWTBKvsZTMAa8FgaQSwMsYCWOkFsJy1qv3FewesU9/HcKXwlbMz1h5g5Qs1FKwKYPUFsABWFqnAKkBWKbAUccNg+YusSYBV8MFrAMsMVq+zpwtWwQevTRSsMWOmBmsXtjKQlQqskg9eA1iDwapCYEVyJfqK2U3lwWsAa8FglXzwGn3/M8Ai5C/epwtW0QevkU9sAFiERLDq3o8FS/KVszPWHmDljDUErKoKDVkAC2CVBqvqvBN85ezab/ZTYbHLZhzWWMaqElx1wDJw1QOLNRaz6y7euWV73z6lZKiKkAWwUoBV8HosJVdjgzVqzEFgVSGwdgPAEnzF7Cby4DWAZQZrQ3AVC1aVDyx+azRgn04Ayw7WatcssROAdSjKNQNh0qmw2DXvACsKrMO5tMdVJFiHos7lJQZLI4CVN1gEWJUvPU0cWIK5JIAlpjVqsIWCVewWe4AVt3jf/9vjKg6synlrrJRglXsoCMCKPCvsYxULls1RTG8ijzECWL02EM0BlkIKoAqANS7NxqpuKK6mB9Z0p8LmK+o84fmsxg12rqpov0oJltVRrM48Fu8AK2A/J7BkAazcwYaDpQWkbXelYDUX1eQJz2c1ajDtGmszF7CO9xRO/SudKwBLWdPNhuRqWmApBbAyBxsTrKr10kiWWJ2ZbDcArL75ULAqgAWwQuZzAat5VGSB+wonCda4Qc1grSiu9GBV7dfZRyy1fUIBrKJgGRdnVrA0KgCW+RGKyZMaN9oQsLbTBOvTy6+kW3XygMWPUaWGrGWD1ULJONTZwTo8tYEnC2Blj6YFK7B2344FViVWZxpnhSxXACtsHhqwosCyLs4Gg/Xw/c3NrXOPP908+xCyTyeWK4AVNk8CVkXe4ZMQLO+ymcefX7uHv79+enXr3n8btE+myYJ1+TtKNENFNz5Y+8+qrTtdqaznKg6sygiW+7192czHmqa3t4+/3LuHH+6D9qnEclUQrNOlBiNFM4K16nB1uRfCClY1Blg97Uethx8/HAYv577ca1ywAkezxKeSugKwqiJgPb164T4+O4Ml28dq4mBlDhoYl8WansHalgCrsoAVumzm8acX+yX8j9cL1qb5J2ugc7gIsC5kObeNWWNlByugh+/354Su5BorcDRLfCmp7IFcBFhHri5kHd9oTwvDXI0D1pGrw3RY6qwwcDRLfCmp7IFcArC2Y4FVGadC/4cw39/Uui25jxU6miUBIan8gQaAdSZromDVOu1jcdc4lACr0JA1KlibKLC2LZiSgKUiywzW9L7SCR3OkoCQ1GiBLGCtLmC1pcOD4kq97BcrBbBUScUVEBFoMFjbCYJV7k7oKYI1OKjaKxqsEFeTBOv4lQ57GSnAMhQQE0kXczMzsGQBLIN/RCADWOGZEGC1JTTtHMHSe0WDFeRKtXonucoF1rv9RPiuwI80Aax+zZcE1pvP/338LUylfTItDyyDV6jih6+UBZ/5gHX4Hvp5ge0GgqswWGPRNSiexSsWrFUYLM0iawhY1aLBGoGsQfHmCJZpb1WsVXcfq54KC+xjAaxA9eTthmiwwoNVRrC6lyYr7BNpimANizcULMk7A1i2b4PEWk1iuwFgxYBFcDVBsIr9+pfYtHMDy+QUCZarLxnNB5ajfkogAqxiDwVZKlg6L6r2nPdpfR8HFsFVx5P+8ZOYqZDfG+3bp9JVg0VyxXhv5gVWqWeQ9hp0gmDZAo4H1roL1frEhwqsbQxYVcyIpdCYYNEWAKsmq+Zq3SFrbQNr2+WqM9Y5Yo21dLCykzUknskpFqzDdkN6sJR7q2K1WqC84SfBnn0yAaxYsNbrDlnrC1gcHv7klxusN/uV+zuRrGsBa1C83GAdD5+4asha28Hq3uFj+DZIrNYFlMMmlryTBbAszlGRxgfLnbfEcoB12MSqnxWptE+opYFlc4oHa73ukHV5rQOrGaSanYtlg3X5hLQAWLXWQYl4VF2w9rKAVc0IrEB7ThAsQ0DChyghGqwVBRZ/WgiwrgMsmisy4iYFWO1dCnf52lEL1lZsBObZDbx9OinAGn+H9KrAapQBLKUmA1ZmsgbEo3xmApZmc3ULsFIlFQdWxyk1WOHF+1oAi+VKCdZ23mBxNrnBGhKvXY/O59pIQsTz4ZJgya0AsFQ5RYDVuyEiXEQ8WHe1SoB1Oo/kVR6sYHPOGKyLfW6wXJgsFVgEV+Lq/TwRAqxESRkC5gNr0/U4LN77ZPF0MAOW5soIgJU4qQiw+muswWBtOh7Hs8IeWTweacCaxRprYWCRPkQJDFi+/aZ1xnwBa20bsmiwVNdyXXzFdgBYqqSmDFZgyAJYLh6srGRp+lnj6R1QBgoHPH3UHF2HyXKHXxGwcrVdK6+M2AKshEmpA9IuacDa9MFa3zWquTr+7ol9wNIMWTMGq/mUMaL7OQ1ymn5WeXpHtJEYsFpH10GyemBVrVFoIFjVjMAiGnMQWIPJKgUWPZEGktqu+9qTFQarAliXj1mzEmApimU8VGA5yjuQ0ypA1mHI8tZYVUMWz5Vqc3U7e7B4s6xgEVzNBKx1l46qasgCWEsBa+MdEhy8D/iiV9s+WSewtiGwqqFgVQArcU5qsDgXJVgu6Bwqe7UlyKLAqmiw1gqwKoA1ECyKq2FgueCXOgPA2qrAqgICWLQZ1c9aBCwp6cniPA6/Aix4eB/xRW9DZGnAImfCIFnd9dl2LmCRHREHlpYAU05qsFgPHyyy/NHA6q/9e2CRvmIjAiwxpbHBcgFnEiyfDv+0kJsJAVbAbopgsR6nMz6NtRKsFTNkVWc8GLACXPlg0VCKrQiwxJS0ZPEOvQJo61C0gLEEVsXPhCGuvD0wZrATWxFgSRlJIXlH/6imRqFoAeMVORc2YBkHrKsHy/W/8/HM0mWkBUtwIN6HrEPRAsYcWGeyaLDCXB3AcqeH+dFQTh8spiMYw+NCeFpgSQ7E+5CxEixi5NmTdQarosEiuKrBOj9+lB3txGacDlhqw7xgsVzRxYoOw8AKWRMnd22wLFwdrxfcnu6UYHyXBVb3O7QjWNx2Y4qMZLKEmS0EEufQO8YWH1osbTuLLCNYJ7KuGKzzl7WMUYqMWFCOxqJb7zjnQBqHweqvlrbxYN1dwKrXWJzvwVtsx3mCRbmoS7PFIUPKYFHTG1t4P1rIetUfsoaAdZkLaVeAJRdnCUOH5DlpO/gfsIX3o4WsV70h6/j6sMgS2AitsGSwtrMBi6WENiV99MWZwlAhQ9wQ9v4HbNmMd0srf/g5vVGAFRqw2l8HiQPWAsFy3ISnL06TEdv5J2PRrWfAOPST4Iq/gLUdDtZdGCzXXW0tGazzCWHYR1+cIiEWlIu15BbOjC+b827kc7Jtg0WRRe59hcDyzg+3VwuWoThFQnznn60lt37BtEM/Cy6tTmdvm173wTp8LIDVwqvlGgbrYCq2ZDKwyD1zTgYSzlbXAJbuHHIXJKu/et+2yQqCdWcH605qyXRgbfwXChlIaJmRTiQBMfkIpFysBbdwTYWivY/C1sSjrgiwtiJXobnQETPhxMEiOkxhHHYylaeOQYYUMOmYex8JRXsfha1XOrC2MlhrCqyOOlzdSU2ZEKxN51+NiA5TGIedTOWpY5AhL+8V5t2PpKK9j8LWq/CQRYG1pcC6iwFLbEoerIcf7p17/Onm2QfRvt3GYtSWT7+/FMaEF3PInA+pnjnvFipZGrBsYFVKsLbEpVh3axVYtpmQB+vjzTf37unVrXv/rWh/agWvhXg1jRcL1iZk4mzjJhHC9cD3QoYxCRTTS94AVjdu5xUB1rYLVutAaMDaF9V6ChL3dZBtJmTBevv1v/Yj1uMv98eRi7dvt5gYtdN+xI1RYWO6M7zyhoLVPf1sv/WtObeEYDUln17tiDub644PgrX1wKr5qIuKAGvoPlYN1MOPH9zjz6/3777ciwcr1NuM2i2mNKY7w9+R0CZBRNCDxbmxG+1MXTof+iUrwFoHwfJmwjBYoTNKzzkNWB+fncFi7aneZtTpC611sDM6SxHyai1ThFRgiRtdwWbrfOiX3AOrtUDfeousAFfbFkVmsE5Aph2xWHuqiRh12k5tHeiMTXfX8fxSlwUVwfX+s3iVIxMKpBi2DdXFL7sTt/Nq1yeraoG1FcA6ngzui/JPEIMLf2/ASgGWZY0VaCJGNhe6N4gOtZKl6vymWLW5tCERSrf9KWW+al+XfuLq8O8JrC0Blr/JsPbICq/P0oP19OqF9qww1ESMbC5Cr4UsdGkIAYIhLeYlwWIGrBBXIljnmTAFWIZ9rFATMbK5kL3RfuF685deqs5vShUsgjnyHuFcWLA6ZJ3/PZ4WblsbV32wjsskHqy2kzv+VuZlrBNbM+XOe6/tBRk9iB5pvyLOyezZsBLt+2mIRXq/IaLx7YJVNav1C1hbEqzzs0o5sDpcnX7ddxZgWT2kzgn2qF6K4rXqnxqqPIzJkE/taMCiB6zuCWEbuHXI6QTWZSa8erAMZGn6UqnhYGm8w7fBHxA5LbJIsPydhu4RCaz1nMCy2lMdFDUna0tXy16ec/4vOokKP2BBAqvDRocrfshyrlmdXSFYoQ7TKar0tDKmQzy5QwOWt7JSgNUyKAqWGRSrfVRvpS89pazprMghi1lkNWNOj6vz1acsk2dnsT3LgWW1zwtWXOFJZc3nDNbOANZ55R7k6kwdx1VBsJzyohWmVTUOUd2VuPDopORMFfaxYJEDFgGWO25hHR/YcFcMLPW1BUyrahzi+itp4faTP32iCvsLWAGyCLB4rpo7MTpcXbawDq9O3mKDAqz4sguDRT2C1gery9HlaUUEeF2w1u1tiUmA1TQT1bNMq2oc4vrLXLZpg32YrLV1AbJ2gdNCLVhVYPU+IbDOC4/WAd4+1KpCiCEdZizZ8pXgQFkr2wKr+YWvqnPlTJ8rGqyTY59Jd9nvcvUa6zh/ik2a66ywfdWSxl4TO0mHGUse8XTRWtkosO7OP+OkB6uPZVGwNq3PFfaa2Ek6zFjwhMFa9cjanX/5rTWj6QesqvLB6nF1BmvM57xT7RRos5C9JnaaHjOVO+YGl7WyHbB2VfOLAadF1vl5WSqw2jsVxCR6Ge8ODyqVlBusUJu1zB1NniJEVI/x5brTovDy1hYnNsV+mmIMx4Ll6oVRaMAiZsIGrOaMMjxgucO2lthZ+cDq3EVAmF/Oq1Sx0/QYW+zxKoPOjRP6MANPEjWVbae2cl2ydi2wTqdy52/3uk9noAasy1xIcXW5jGs6YPVazmsnVew0PcaWOiewXBesXQCs9QWsOxasqguWv6SaIFhk03ntpIqdqMu4UhcBVtUBq/VQNW8mrAJgbT2w7jyupgAWe3GUZ6KKnajL2FJdZ41lizokxX6SUoyDETVkNbfOd8aqzoBVdZ9wdBmyumB5N+BPYY3FgSW1qjZEXJ+pCx0U1ShrbQ9G5Fy4Pl3E0HqUjAfWeYjq3FLfnQtrrPx58eQsdlZesMjGk1pVG0Kp2EKHRbXJWNtjV7Bg3Z3pOnPRmQlVYPlknryrsmD1dxdJa13wnk/vlbLThLy7fsGQfUM+A1lcYsEWO3QFtcg6kODq+dDVGw/1n7vOLlSzqvK+wfbA6s6lZ66WDFbvWQaGTuPT9txCIX3DBF9HM5mFiifB2l3Aas5Ejmv54K/leM+WaYN1d1nx37WgPJIo9lVWsMjWE1tVEcMCFl2+wisU0jecBViX7Xj2Z5j8Maq9X9HMnGJfASzRKxTSNywB1lEWsM6LpDBYp6cwN0T1H+8wdbDkVtXEcPo1Flm+MVvSQ90A+hSF4s9m3CLLnZdX/q1eLvD7Xrvz472bxVXwbp5qkmD1t+ODjTosBhnXWuLgqBbFpOZ4sELyzwODYK3bq/b5gCU36rAYbEcYSkwQdkiGSmtmLrRx1TmhvAuA1fYV+6oAWJpGHRSD7wh9gQnCDslQsj51hQkslqtmkbVe3/Vnwo6v2FdJwdJ0QnBhpAwe32tECN8i7DIkbD8L6m0/OS60yw0Wu8IaGSzVudGFq7axMri1G72e4AukHygyJKyXBPlg01CCXHO2uiK8yIrgqrM84wesCYKlbFRa5t6MSaiTVLYY7behth4CFqkeTcS6P3RJYLVksHKRlR6swNlvKrDaZsRcOBSsZpgqDpZtN8fZ11itUBnklzw0IHH6S7wNVJOJ3DE0gcVx1ZtFaV+xk8Y+K1S0k6xBsSJyivWPi6aJ2jG0zIU8V96QxfiKfQSwFDnF+sdF00TtGFrmwiWCxRgZk9Av5FTXy4k5xZTMpBk6Yqxltyv0YDW/bRnkqrtVwTEpdtF4YGnXoiqJ0cSQkgkfTSyZyZL7SllbyW5XqMFqfo2X4Kq9yGLHOrGHJgGWMQdNNCmkaMJHU1ZGHdJYyVBXeHyEiKguYFFc+cuzKqDdksHSkZUKLHHfgHJUhzTWMdgVBB9dKiSwvMFuDmAxyxJjDrpwfEjJRApHlqzIsn/AWEeiTTyw+tcdH8hyLFddsEiuJgUWLWMOQ8NFpBTpGBlN8ibaxB+yaF0JWMYUBseLySnOLzYa7022iRYshqsOWYyv2D8AS5lSlF90NM6baRQdWCxXLbA4X7F/5g4WGVlhEjImU2KMGb+jsZQBV8W+7/lwoCt0Q9a1gGXMoBNQcXtD1KkhU0Hbfpz3LAhbC/CphbpCAxbPVbNVwfqK3bM0sM6HhoHFVdC2baIBi6sicwEED1a8VBCK3bNIsFwOsBxlzLq1wLIvxjdmsFKQtRSwjAl4Ef3Il0NuwBqLryJZXsjFNWssg1srYCeuQknJom3EPOYOVriw6GTYlCLcukdN0Xr2ulYBWLb2UkYcnA2bUYRb97ApGnndIa+EYDE2YhrFwTLGF0IOzUbIyO7mHbfVX2vXVTKyOBMxi0xguV6rUG+N8emQncI4AqisFBlxpQgeYspCuP5RqiuWDBZ3m5P31hifDOkVFkLANw6f3llD+r8dRDgQBWijBY6SXZEILNaEzZvNzmrP9Znt5hS1OCgCIFFIGHqaBkt06BVgqmDo6BCwIt10TPHZWe1bjTAWWNx/fxGrOLD8GV8NVr8AUwVDB+mui4Rj4mC5wLdj5FtjdDJovzQNWeHrrPQhm6qK9swHimg640aRbCTkKsPvFbbfKLp2mOjitCmYE/KMJbd+waaaRzZTJBvpuFoUWPQRtUwhm7eiee8TUwW1xo2WB1b7nZO61xibCRsorBeq/YpIzRSyeStb+x+pAtmNGxFMSGwk4yo1WO230VeLmHQp7PB1b+BAc7RlF7HTQFfVYqzw8AugDvBdF2CirrTERiqu0oHlSQGWMbKY2SqQmxasxLmMImvXhVsol3KB1d9zKALWZf4DWEsBi17IjNuXTbT2Ky+1kXJJqxEpiVBOsHgZA8dKSmO+YE1b+cDKf0aYIg1wlUkKUB5/unn2wWB/0UT6ElyVkAzK06tb9/5bvX0johMB1jVIBuXxl3v38MO92r6lQB/yF5nk0UK5mvvi/eHHD+7x59f7V1/uNbQ2o57yLlvTbkg5u4/PzmDp7IV4ACuVpt2QlhFLZw+NpGl3RdY1FnS90pwVvog8K4SuWDn3saArVsadd+iaBbBmq2l3BcCarabdFQBrtpp2VwCs2WraXQGwoCwCWFAWASwoiwAWlEUAa7aadlcArNlq2l0BsGaraXcFwJqtpt0VZrAC+jL04VhC8GkFjwUrpC8TlIHgCwsOsBA8S3CAheBZgk97BQjNVgALyiKABWURwIKyCGBBWTQYrM7NYaPq4fubm1vn3t/c3HxzL5un1SlqkdrXseuql6j54dblU63Zyg8Fq/uQozFV3/b/8PfX7uiKBZ4AAAHTSURBVO1tiejHqOVqXz9Ro0DNP9Ykn2rNV34oWN0b8MfUx7pOb2+f/vFaNE2vU9Rita//VxWo+duv/7Wv7anWfOWHgtV9ZMjY2kfej8eHGXHkwMeoxWpfjxRFal6TdKo1X/mhYHUfcjSy6sdK1LPh+P93T1FL1f4Qs0jNa7BOteYrP+cR6/GnF6dXpdZZpWr/8bJoHrvmo41Y5dZY+7PCS6OWAqtU7d++uLwqANYoa6zuQ47G1Imr+j/v0z/H7ttT1EK1P06ARWpek3SqNV/5+e5jtXZzvh5/MjpFLVP70wRUouaj7WNBUFAAC8oigAVlEcCCsghgQVkEsKAsAlhQFgEsiz69PN2W+cUff/u1dDLTFsCyCkipBLCsAlgqASyrjmDt//7xt//962r11R/7P8+Ps+Rnv5VObjoCWFY1YP318/+4d6v6z2e/fXr5hXPv9q+howCWVS2w9gPV8c/ffv29Hq3+/O556ewmI4BlVWsq/PX0bv/n3fFs8avS2U1GAMsqAizMgl0BLKvCYP3+F5wrdgSwrAqD9enlfsgCXY0AllVhsA7bDeCqEcCCsghgQVkEsKAsAlhQFgEsKIsAFpRFAAvKIoAFZRHAgrIIYEFZ9P8/X9HC4arfHAAAAABJRU5ErkJggg==" width="60%" style="display: block; margin: auto;" /></p>
<p>Clearly the two models do not produce equivalent forecasts. We will
come back to scoring these forecasts in a moment.</p>
</div>
<div id="forecasting-with-newdata-in-mvgam" class="section level2">
<h2>Forecasting with <code>newdata</code> in <code>mvgam()</code></h2>
<p>The second way we can produce forecasts in <code>mvgam</code> is to
feed the testing data directly to the <code>mvgam()</code> function as
<code>newdata</code>. This will include the testing data as missing
observations so that they are automatically predicted from the posterior
predictive distribution using the <code>generated quantities</code>
block in <code>Stan</code>. As an example, we can refit
<code>mod2</code> but include the testing data for automatic
forecasts:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a>mod2 <span class="ot">&lt;-</span> <span class="fu">mvgam</span>(y <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a>  <span class="at">trend_formula =</span> <span class="sc">~</span> <span class="fu">s</span>(season, <span class="at">bs =</span> <span class="st">&quot;cc&quot;</span>, <span class="at">k =</span> <span class="dv">8</span>) <span class="sc">-</span> <span class="dv">1</span>,</span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a>  <span class="at">trend_knots =</span> <span class="fu">list</span>(<span class="at">season =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">12.5</span>)),</span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a>  <span class="at">trend_model =</span> <span class="fu">AR</span>(<span class="at">cor =</span> <span class="cn">TRUE</span>),</span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a>  <span class="at">noncentred =</span> <span class="cn">TRUE</span>,</span>
<span id="cb19-6"><a href="#cb19-6" tabindex="-1"></a>  <span class="at">data =</span> simdat<span class="sc">$</span>data_train,</span>
<span id="cb19-7"><a href="#cb19-7" tabindex="-1"></a>  <span class="at">newdata =</span> simdat<span class="sc">$</span>data_test,</span>
<span id="cb19-8"><a href="#cb19-8" tabindex="-1"></a>  <span class="at">silent =</span> <span class="dv">2</span></span>
<span id="cb19-9"><a href="#cb19-9" tabindex="-1"></a>)</span></code></pre></div>
<p>Because the model already contains a forecast distribution, we do not
need to feed <code>newdata</code> to the <code>forecast()</code>
function:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a>fc_mod2 <span class="ot">&lt;-</span> <span class="fu">forecast</span>(mod2)</span></code></pre></div>
<p>The forecasts will be nearly identical to those calculated
previously:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a><span class="fu">plot</span>(fc_mod2, <span class="at">series =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" alt="Plotting posterior forecast distributions using mvgam and R" width="60%" style="display: block; margin: auto;" /></p>
</div>
<div id="scoring-forecast-distributions" class="section level2">
<h2>Scoring forecast distributions</h2>
<p>A primary purpose of the <code>mvgam_forecast</code> class is to
readily allow forecast evaluations for each series in the data, using a
variety of possible scoring functions. See
<code>?mvgam::score.mvgam_forecast</code> to view the types of scores
that are available. A useful scoring metric is the Continuous Rank
Probability Score (CRPS). A CRPS value is similar to what we might get
if we calculated a weighted absolute error using the full forecast
distribution.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a>crps_mod1 <span class="ot">&lt;-</span> <span class="fu">score</span>(fc_mod1, <span class="at">score =</span> <span class="st">&quot;crps&quot;</span>)</span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a><span class="fu">str</span>(crps_mod1)</span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a><span class="co">#&gt; List of 4</span></span>
<span id="cb22-4"><a href="#cb22-4" tabindex="-1"></a><span class="co">#&gt;  $ series_1  :&#39;data.frame&#39;:  25 obs. of  5 variables:</span></span>
<span id="cb22-5"><a href="#cb22-5" tabindex="-1"></a><span class="co">#&gt;   ..$ score         : num [1:25] 1.014 0.817 0.343 0.96 0.276 ...</span></span>
<span id="cb22-6"><a href="#cb22-6" tabindex="-1"></a><span class="co">#&gt;   ..$ in_interval   : num [1:25] 1 1 1 1 1 NA NA 0 0 0 ...</span></span>
<span id="cb22-7"><a href="#cb22-7" tabindex="-1"></a><span class="co">#&gt;   ..$ interval_width: num [1:25] 0.9 0.9 0.9 0.9 0.9 0.9 0.9 0.9 0.9 0.9 ...</span></span>
<span id="cb22-8"><a href="#cb22-8" tabindex="-1"></a><span class="co">#&gt;   ..$ eval_horizon  : int [1:25] 1 2 3 4 5 6 7 8 9 10 ...</span></span>
<span id="cb22-9"><a href="#cb22-9" tabindex="-1"></a><span class="co">#&gt;   ..$ score_type    : chr [1:25] &quot;crps&quot; &quot;crps&quot; &quot;crps&quot; &quot;crps&quot; ...</span></span>
<span id="cb22-10"><a href="#cb22-10" tabindex="-1"></a><span class="co">#&gt;  $ series_2  :&#39;data.frame&#39;:  25 obs. of  5 variables:</span></span>
<span id="cb22-11"><a href="#cb22-11" tabindex="-1"></a><span class="co">#&gt;   ..$ score         : num [1:25] 1.87 NA 7.22 16.71 20.02 ...</span></span>
<span id="cb22-12"><a href="#cb22-12" tabindex="-1"></a><span class="co">#&gt;   ..$ in_interval   : num [1:25] 1 NA 1 1 1 0 0 0 0 0 ...</span></span>
<span id="cb22-13"><a href="#cb22-13" tabindex="-1"></a><span class="co">#&gt;   ..$ interval_width: num [1:25] 0.9 0.9 0.9 0.9 0.9 0.9 0.9 0.9 0.9 0.9 ...</span></span>
<span id="cb22-14"><a href="#cb22-14" tabindex="-1"></a><span class="co">#&gt;   ..$ eval_horizon  : int [1:25] 1 2 3 4 5 6 7 8 9 10 ...</span></span>
<span id="cb22-15"><a href="#cb22-15" tabindex="-1"></a><span class="co">#&gt;   ..$ score_type    : chr [1:25] &quot;crps&quot; &quot;crps&quot; &quot;crps&quot; &quot;crps&quot; ...</span></span>
<span id="cb22-16"><a href="#cb22-16" tabindex="-1"></a><span class="co">#&gt;  $ series_3  :&#39;data.frame&#39;:  25 obs. of  5 variables:</span></span>
<span id="cb22-17"><a href="#cb22-17" tabindex="-1"></a><span class="co">#&gt;   ..$ score         : num [1:25] 3.644 0.456 4.234 0.49 NA ...</span></span>
<span id="cb22-18"><a href="#cb22-18" tabindex="-1"></a><span class="co">#&gt;   ..$ in_interval   : num [1:25] 0 1 0 1 NA 1 1 0 0 NA ...</span></span>
<span id="cb22-19"><a href="#cb22-19" tabindex="-1"></a><span class="co">#&gt;   ..$ interval_width: num [1:25] 0.9 0.9 0.9 0.9 0.9 0.9 0.9 0.9 0.9 0.9 ...</span></span>
<span id="cb22-20"><a href="#cb22-20" tabindex="-1"></a><span class="co">#&gt;   ..$ eval_horizon  : int [1:25] 1 2 3 4 5 6 7 8 9 10 ...</span></span>
<span id="cb22-21"><a href="#cb22-21" tabindex="-1"></a><span class="co">#&gt;   ..$ score_type    : chr [1:25] &quot;crps&quot; &quot;crps&quot; &quot;crps&quot; &quot;crps&quot; ...</span></span>
<span id="cb22-22"><a href="#cb22-22" tabindex="-1"></a><span class="co">#&gt;  $ all_series:&#39;data.frame&#39;:  25 obs. of  3 variables:</span></span>
<span id="cb22-23"><a href="#cb22-23" tabindex="-1"></a><span class="co">#&gt;   ..$ score       : num [1:25] 6.53 NA 11.8 18.16 NA ...</span></span>
<span id="cb22-24"><a href="#cb22-24" tabindex="-1"></a><span class="co">#&gt;   ..$ eval_horizon: int [1:25] 1 2 3 4 5 6 7 8 9 10 ...</span></span>
<span id="cb22-25"><a href="#cb22-25" tabindex="-1"></a><span class="co">#&gt;   ..$ score_type  : chr [1:25] &quot;sum_crps&quot; &quot;sum_crps&quot; &quot;sum_crps&quot; &quot;sum_crps&quot; ...</span></span>
<span id="cb22-26"><a href="#cb22-26" tabindex="-1"></a>crps_mod1<span class="sc">$</span>series_1</span>
<span id="cb22-27"><a href="#cb22-27" tabindex="-1"></a><span class="co">#&gt;         score in_interval interval_width eval_horizon score_type</span></span>
<span id="cb22-28"><a href="#cb22-28" tabindex="-1"></a><span class="co">#&gt; 1   1.0140790           1            0.9            1       crps</span></span>
<span id="cb22-29"><a href="#cb22-29" tabindex="-1"></a><span class="co">#&gt; 2   0.8172095           1            0.9            2       crps</span></span>
<span id="cb22-30"><a href="#cb22-30" tabindex="-1"></a><span class="co">#&gt; 3   0.3430390           1            0.9            3       crps</span></span>
<span id="cb22-31"><a href="#cb22-31" tabindex="-1"></a><span class="co">#&gt; 4   0.9601160           1            0.9            4       crps</span></span>
<span id="cb22-32"><a href="#cb22-32" tabindex="-1"></a><span class="co">#&gt; 5   0.2761875           1            0.9            5       crps</span></span>
<span id="cb22-33"><a href="#cb22-33" tabindex="-1"></a><span class="co">#&gt; 6          NA          NA            0.9            6       crps</span></span>
<span id="cb22-34"><a href="#cb22-34" tabindex="-1"></a><span class="co">#&gt; 7          NA          NA            0.9            7       crps</span></span>
<span id="cb22-35"><a href="#cb22-35" tabindex="-1"></a><span class="co">#&gt; 8   6.1122768           0            0.9            8       crps</span></span>
<span id="cb22-36"><a href="#cb22-36" tabindex="-1"></a><span class="co">#&gt; 9   8.2056642           0            0.9            9       crps</span></span>
<span id="cb22-37"><a href="#cb22-37" tabindex="-1"></a><span class="co">#&gt; 10  7.3489420           0            0.9           10       crps</span></span>
<span id="cb22-38"><a href="#cb22-38" tabindex="-1"></a><span class="co">#&gt; 11 21.3067160           0            0.9           11       crps</span></span>
<span id="cb22-39"><a href="#cb22-39" tabindex="-1"></a><span class="co">#&gt; 12 35.2279993           0            0.9           12       crps</span></span>
<span id="cb22-40"><a href="#cb22-40" tabindex="-1"></a><span class="co">#&gt; 13 37.2142593           0            0.9           13       crps</span></span>
<span id="cb22-41"><a href="#cb22-41" tabindex="-1"></a><span class="co">#&gt; 14 36.2565240           0            0.9           14       crps</span></span>
<span id="cb22-42"><a href="#cb22-42" tabindex="-1"></a><span class="co">#&gt; 15 39.3413357           0            0.9           15       crps</span></span>
<span id="cb22-43"><a href="#cb22-43" tabindex="-1"></a><span class="co">#&gt; 16 42.2836615           0            0.9           16       crps</span></span>
<span id="cb22-44"><a href="#cb22-44" tabindex="-1"></a><span class="co">#&gt; 17 42.4259613           0            0.9           17       crps</span></span>
<span id="cb22-45"><a href="#cb22-45" tabindex="-1"></a><span class="co">#&gt; 18 12.6684920           0            0.9           18       crps</span></span>
<span id="cb22-46"><a href="#cb22-46" tabindex="-1"></a><span class="co">#&gt; 19 13.7129962           0            0.9           19       crps</span></span>
<span id="cb22-47"><a href="#cb22-47" tabindex="-1"></a><span class="co">#&gt; 20  9.6689547           0            0.9           20       crps</span></span>
<span id="cb22-48"><a href="#cb22-48" tabindex="-1"></a><span class="co">#&gt; 21  4.7457437           0            0.9           21       crps</span></span>
<span id="cb22-49"><a href="#cb22-49" tabindex="-1"></a><span class="co">#&gt; 22  4.7838565           0            0.9           22       crps</span></span>
<span id="cb22-50"><a href="#cb22-50" tabindex="-1"></a><span class="co">#&gt; 23  2.7938578           0            0.9           23       crps</span></span>
<span id="cb22-51"><a href="#cb22-51" tabindex="-1"></a><span class="co">#&gt; 24  0.8515640           1            0.9           24       crps</span></span>
<span id="cb22-52"><a href="#cb22-52" tabindex="-1"></a><span class="co">#&gt; 25  3.7254275           0            0.9           25       crps</span></span></code></pre></div>
<p>The returned list contains a <code>data.frame</code> for each series
in the data that shows the CRPS score for each evaluation in the testing
data, along with some other useful information about the fit of the
forecast distribution. In particular, we are given a logical value (1s
and 0s) telling us whether the true value was within a pre-specified
credible interval (i.e. the coverage of the forecast distribution). The
default interval width is 0.9, so we would hope that the values in the
<code>in_interval</code> column take a 1 approximately 90% of the time.
This value can be changed if you wish to compute different coverages,
say using a 60% interval:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a>crps_mod1 <span class="ot">&lt;-</span> <span class="fu">score</span>(fc_mod1, <span class="at">score =</span> <span class="st">&quot;crps&quot;</span>, <span class="at">interval_width =</span> <span class="fl">0.6</span>)</span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a>crps_mod1<span class="sc">$</span>series_1</span>
<span id="cb23-3"><a href="#cb23-3" tabindex="-1"></a><span class="co">#&gt;         score in_interval interval_width eval_horizon score_type</span></span>
<span id="cb23-4"><a href="#cb23-4" tabindex="-1"></a><span class="co">#&gt; 1   1.0140790           1            0.6            1       crps</span></span>
<span id="cb23-5"><a href="#cb23-5" tabindex="-1"></a><span class="co">#&gt; 2   0.8172095           1            0.6            2       crps</span></span>
<span id="cb23-6"><a href="#cb23-6" tabindex="-1"></a><span class="co">#&gt; 3   0.3430390           1            0.6            3       crps</span></span>
<span id="cb23-7"><a href="#cb23-7" tabindex="-1"></a><span class="co">#&gt; 4   0.9601160           1            0.6            4       crps</span></span>
<span id="cb23-8"><a href="#cb23-8" tabindex="-1"></a><span class="co">#&gt; 5   0.2761875           1            0.6            5       crps</span></span>
<span id="cb23-9"><a href="#cb23-9" tabindex="-1"></a><span class="co">#&gt; 6          NA          NA            0.6            6       crps</span></span>
<span id="cb23-10"><a href="#cb23-10" tabindex="-1"></a><span class="co">#&gt; 7          NA          NA            0.6            7       crps</span></span>
<span id="cb23-11"><a href="#cb23-11" tabindex="-1"></a><span class="co">#&gt; 8   6.1122768           0            0.6            8       crps</span></span>
<span id="cb23-12"><a href="#cb23-12" tabindex="-1"></a><span class="co">#&gt; 9   8.2056642           0            0.6            9       crps</span></span>
<span id="cb23-13"><a href="#cb23-13" tabindex="-1"></a><span class="co">#&gt; 10  7.3489420           0            0.6           10       crps</span></span>
<span id="cb23-14"><a href="#cb23-14" tabindex="-1"></a><span class="co">#&gt; 11 21.3067160           0            0.6           11       crps</span></span>
<span id="cb23-15"><a href="#cb23-15" tabindex="-1"></a><span class="co">#&gt; 12 35.2279993           0            0.6           12       crps</span></span>
<span id="cb23-16"><a href="#cb23-16" tabindex="-1"></a><span class="co">#&gt; 13 37.2142593           0            0.6           13       crps</span></span>
<span id="cb23-17"><a href="#cb23-17" tabindex="-1"></a><span class="co">#&gt; 14 36.2565240           0            0.6           14       crps</span></span>
<span id="cb23-18"><a href="#cb23-18" tabindex="-1"></a><span class="co">#&gt; 15 39.3413357           0            0.6           15       crps</span></span>
<span id="cb23-19"><a href="#cb23-19" tabindex="-1"></a><span class="co">#&gt; 16 42.2836615           0            0.6           16       crps</span></span>
<span id="cb23-20"><a href="#cb23-20" tabindex="-1"></a><span class="co">#&gt; 17 42.4259613           0            0.6           17       crps</span></span>
<span id="cb23-21"><a href="#cb23-21" tabindex="-1"></a><span class="co">#&gt; 18 12.6684920           0            0.6           18       crps</span></span>
<span id="cb23-22"><a href="#cb23-22" tabindex="-1"></a><span class="co">#&gt; 19 13.7129962           0            0.6           19       crps</span></span>
<span id="cb23-23"><a href="#cb23-23" tabindex="-1"></a><span class="co">#&gt; 20  9.6689547           0            0.6           20       crps</span></span>
<span id="cb23-24"><a href="#cb23-24" tabindex="-1"></a><span class="co">#&gt; 21  4.7457437           0            0.6           21       crps</span></span>
<span id="cb23-25"><a href="#cb23-25" tabindex="-1"></a><span class="co">#&gt; 22  4.7838565           0            0.6           22       crps</span></span>
<span id="cb23-26"><a href="#cb23-26" tabindex="-1"></a><span class="co">#&gt; 23  2.7938578           0            0.6           23       crps</span></span>
<span id="cb23-27"><a href="#cb23-27" tabindex="-1"></a><span class="co">#&gt; 24  0.8515640           0            0.6           24       crps</span></span>
<span id="cb23-28"><a href="#cb23-28" tabindex="-1"></a><span class="co">#&gt; 25  3.7254275           0            0.6           25       crps</span></span></code></pre></div>
<p>We can also compare forecasts against out of sample observations
using the <a href="https://link.springer.com/article/10.1007/s11222-016-9696-4" target="_blank">Expected Log Predictive Density (ELPD; also known as the
log score)</a>. The ELPD is a strictly proper scoring rule that can be
applied to any distributional forecast, but to compute it we need
predictions on the link scale rather than on the outcome scale. This is
where it is advantageous to change the type of prediction we can get
using the <code>forecast()</code> function:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a>link_mod1 <span class="ot">&lt;-</span> <span class="fu">forecast</span>(mod1, <span class="at">newdata =</span> simdat<span class="sc">$</span>data_test, <span class="at">type =</span> <span class="st">&quot;link&quot;</span>)</span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a><span class="fu">score</span>(link_mod1, <span class="at">score =</span> <span class="st">&quot;elpd&quot;</span>)<span class="sc">$</span>series_1</span>
<span id="cb24-3"><a href="#cb24-3" tabindex="-1"></a><span class="co">#&gt;         score eval_horizon score_type</span></span>
<span id="cb24-4"><a href="#cb24-4" tabindex="-1"></a><span class="co">#&gt; 1   -2.154963            1       elpd</span></span>
<span id="cb24-5"><a href="#cb24-5" tabindex="-1"></a><span class="co">#&gt; 2   -1.951288            2       elpd</span></span>
<span id="cb24-6"><a href="#cb24-6" tabindex="-1"></a><span class="co">#&gt; 3   -1.244906            3       elpd</span></span>
<span id="cb24-7"><a href="#cb24-7" tabindex="-1"></a><span class="co">#&gt; 4   -2.188772            4       elpd</span></span>
<span id="cb24-8"><a href="#cb24-8" tabindex="-1"></a><span class="co">#&gt; 5   -1.213424            5       elpd</span></span>
<span id="cb24-9"><a href="#cb24-9" tabindex="-1"></a><span class="co">#&gt; 6          NA            6       elpd</span></span>
<span id="cb24-10"><a href="#cb24-10" tabindex="-1"></a><span class="co">#&gt; 7          NA            7       elpd</span></span>
<span id="cb24-11"><a href="#cb24-11" tabindex="-1"></a><span class="co">#&gt; 8   -6.953353            8       elpd</span></span>
<span id="cb24-12"><a href="#cb24-12" tabindex="-1"></a><span class="co">#&gt; 9   -8.026647            9       elpd</span></span>
<span id="cb24-13"><a href="#cb24-13" tabindex="-1"></a><span class="co">#&gt; 10  -7.606749           10       elpd</span></span>
<span id="cb24-14"><a href="#cb24-14" tabindex="-1"></a><span class="co">#&gt; 11 -12.495600           11       elpd</span></span>
<span id="cb24-15"><a href="#cb24-15" tabindex="-1"></a><span class="co">#&gt; 12 -16.939454           12       elpd</span></span>
<span id="cb24-16"><a href="#cb24-16" tabindex="-1"></a><span class="co">#&gt; 13 -14.939413           13       elpd</span></span>
<span id="cb24-17"><a href="#cb24-17" tabindex="-1"></a><span class="co">#&gt; 14 -14.029803           14       elpd</span></span>
<span id="cb24-18"><a href="#cb24-18" tabindex="-1"></a><span class="co">#&gt; 15 -13.634550           15       elpd</span></span>
<span id="cb24-19"><a href="#cb24-19" tabindex="-1"></a><span class="co">#&gt; 16 -12.172281           16       elpd</span></span>
<span id="cb24-20"><a href="#cb24-20" tabindex="-1"></a><span class="co">#&gt; 17 -13.522049           17       elpd</span></span>
<span id="cb24-21"><a href="#cb24-21" tabindex="-1"></a><span class="co">#&gt; 18  -8.960513           18       elpd</span></span>
<span id="cb24-22"><a href="#cb24-22" tabindex="-1"></a><span class="co">#&gt; 19  -9.513524           19       elpd</span></span>
<span id="cb24-23"><a href="#cb24-23" tabindex="-1"></a><span class="co">#&gt; 20  -7.717374           20       elpd</span></span>
<span id="cb24-24"><a href="#cb24-24" tabindex="-1"></a><span class="co">#&gt; 21  -6.737752           21       elpd</span></span>
<span id="cb24-25"><a href="#cb24-25" tabindex="-1"></a><span class="co">#&gt; 22  -6.851763           22       elpd</span></span>
<span id="cb24-26"><a href="#cb24-26" tabindex="-1"></a><span class="co">#&gt; 23  -5.503431           23       elpd</span></span>
<span id="cb24-27"><a href="#cb24-27" tabindex="-1"></a><span class="co">#&gt; 24  -3.002872           24       elpd</span></span>
<span id="cb24-28"><a href="#cb24-28" tabindex="-1"></a><span class="co">#&gt; 25  -6.004690           25       elpd</span></span></code></pre></div>
<p>Finally, when we have multiple time series it may also make sense to
use a multivariate proper scoring rule. <code>mvgam</code> offers two
such options: the Energy score and the Variogram score. The first
penalizes forecast distributions that are less well calibrated against
the truth, while the second penalizes forecasts that do not capture the
observed true correlation structure. Which score to use depends on your
goals, but both are very easy to compute:</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a>energy_mod2 <span class="ot">&lt;-</span> <span class="fu">score</span>(fc_mod2, <span class="at">score =</span> <span class="st">&quot;energy&quot;</span>)</span>
<span id="cb25-2"><a href="#cb25-2" tabindex="-1"></a><span class="fu">str</span>(energy_mod2)</span>
<span id="cb25-3"><a href="#cb25-3" tabindex="-1"></a><span class="co">#&gt; List of 4</span></span>
<span id="cb25-4"><a href="#cb25-4" tabindex="-1"></a><span class="co">#&gt;  $ series_1  :&#39;data.frame&#39;:  25 obs. of  3 variables:</span></span>
<span id="cb25-5"><a href="#cb25-5" tabindex="-1"></a><span class="co">#&gt;   ..$ in_interval   : num [1:25] 1 1 1 1 1 NA NA 1 1 1 ...</span></span>
<span id="cb25-6"><a href="#cb25-6" tabindex="-1"></a><span class="co">#&gt;   ..$ interval_width: num [1:25] 0.9 0.9 0.9 0.9 0.9 0.9 0.9 0.9 0.9 0.9 ...</span></span>
<span id="cb25-7"><a href="#cb25-7" tabindex="-1"></a><span class="co">#&gt;   ..$ eval_horizon  : int [1:25] 1 2 3 4 5 6 7 8 9 10 ...</span></span>
<span id="cb25-8"><a href="#cb25-8" tabindex="-1"></a><span class="co">#&gt;  $ series_2  :&#39;data.frame&#39;:  25 obs. of  3 variables:</span></span>
<span id="cb25-9"><a href="#cb25-9" tabindex="-1"></a><span class="co">#&gt;   ..$ in_interval   : num [1:25] 1 NA 1 1 1 1 1 1 1 1 ...</span></span>
<span id="cb25-10"><a href="#cb25-10" tabindex="-1"></a><span class="co">#&gt;   ..$ interval_width: num [1:25] 0.9 0.9 0.9 0.9 0.9 0.9 0.9 0.9 0.9 0.9 ...</span></span>
<span id="cb25-11"><a href="#cb25-11" tabindex="-1"></a><span class="co">#&gt;   ..$ eval_horizon  : int [1:25] 1 2 3 4 5 6 7 8 9 10 ...</span></span>
<span id="cb25-12"><a href="#cb25-12" tabindex="-1"></a><span class="co">#&gt;  $ series_3  :&#39;data.frame&#39;:  25 obs. of  3 variables:</span></span>
<span id="cb25-13"><a href="#cb25-13" tabindex="-1"></a><span class="co">#&gt;   ..$ in_interval   : num [1:25] 1 1 1 1 NA 1 1 1 1 NA ...</span></span>
<span id="cb25-14"><a href="#cb25-14" tabindex="-1"></a><span class="co">#&gt;   ..$ interval_width: num [1:25] 0.9 0.9 0.9 0.9 0.9 0.9 0.9 0.9 0.9 0.9 ...</span></span>
<span id="cb25-15"><a href="#cb25-15" tabindex="-1"></a><span class="co">#&gt;   ..$ eval_horizon  : int [1:25] 1 2 3 4 5 6 7 8 9 10 ...</span></span>
<span id="cb25-16"><a href="#cb25-16" tabindex="-1"></a><span class="co">#&gt;  $ all_series:&#39;data.frame&#39;:  25 obs. of  3 variables:</span></span>
<span id="cb25-17"><a href="#cb25-17" tabindex="-1"></a><span class="co">#&gt;   ..$ score       : num [1:25] 4.61 NA 4.91 5.46 NA ...</span></span>
<span id="cb25-18"><a href="#cb25-18" tabindex="-1"></a><span class="co">#&gt;   ..$ eval_horizon: int [1:25] 1 2 3 4 5 6 7 8 9 10 ...</span></span>
<span id="cb25-19"><a href="#cb25-19" tabindex="-1"></a><span class="co">#&gt;   ..$ score_type  : chr [1:25] &quot;energy&quot; &quot;energy&quot; &quot;energy&quot; &quot;energy&quot; ...</span></span></code></pre></div>
<p>The returned object still provides information on interval coverage
for each individual series, but there is only a single score per horizon
now (which is provided in the <code>all_series</code> slot):</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a>energy_mod2<span class="sc">$</span>all_series</span>
<span id="cb26-2"><a href="#cb26-2" tabindex="-1"></a><span class="co">#&gt;        score eval_horizon score_type</span></span>
<span id="cb26-3"><a href="#cb26-3" tabindex="-1"></a><span class="co">#&gt; 1   4.613612            1     energy</span></span>
<span id="cb26-4"><a href="#cb26-4" tabindex="-1"></a><span class="co">#&gt; 2         NA            2     energy</span></span>
<span id="cb26-5"><a href="#cb26-5" tabindex="-1"></a><span class="co">#&gt; 3   4.913187            3     energy</span></span>
<span id="cb26-6"><a href="#cb26-6" tabindex="-1"></a><span class="co">#&gt; 4   5.455274            4     energy</span></span>
<span id="cb26-7"><a href="#cb26-7" tabindex="-1"></a><span class="co">#&gt; 5         NA            5     energy</span></span>
<span id="cb26-8"><a href="#cb26-8" tabindex="-1"></a><span class="co">#&gt; 6         NA            6     energy</span></span>
<span id="cb26-9"><a href="#cb26-9" tabindex="-1"></a><span class="co">#&gt; 7         NA            7     energy</span></span>
<span id="cb26-10"><a href="#cb26-10" tabindex="-1"></a><span class="co">#&gt; 8   3.958379            8     energy</span></span>
<span id="cb26-11"><a href="#cb26-11" tabindex="-1"></a><span class="co">#&gt; 9   4.172307            9     energy</span></span>
<span id="cb26-12"><a href="#cb26-12" tabindex="-1"></a><span class="co">#&gt; 10        NA           10     energy</span></span>
<span id="cb26-13"><a href="#cb26-13" tabindex="-1"></a><span class="co">#&gt; 11 13.159805           11     energy</span></span>
<span id="cb26-14"><a href="#cb26-14" tabindex="-1"></a><span class="co">#&gt; 12 22.642568           12     energy</span></span>
<span id="cb26-15"><a href="#cb26-15" tabindex="-1"></a><span class="co">#&gt; 13        NA           13     energy</span></span>
<span id="cb26-16"><a href="#cb26-16" tabindex="-1"></a><span class="co">#&gt; 14 21.117025           14     energy</span></span>
<span id="cb26-17"><a href="#cb26-17" tabindex="-1"></a><span class="co">#&gt; 15 24.099136           15     energy</span></span>
<span id="cb26-18"><a href="#cb26-18" tabindex="-1"></a><span class="co">#&gt; 16 25.250985           16     energy</span></span>
<span id="cb26-19"><a href="#cb26-19" tabindex="-1"></a><span class="co">#&gt; 17 28.004023           17     energy</span></span>
<span id="cb26-20"><a href="#cb26-20" tabindex="-1"></a><span class="co">#&gt; 18  6.155508           18     energy</span></span>
<span id="cb26-21"><a href="#cb26-21" tabindex="-1"></a><span class="co">#&gt; 19 10.855617           19     energy</span></span>
<span id="cb26-22"><a href="#cb26-22" tabindex="-1"></a><span class="co">#&gt; 20  4.121863           20     energy</span></span>
<span id="cb26-23"><a href="#cb26-23" tabindex="-1"></a><span class="co">#&gt; 21  2.874126           21     energy</span></span>
<span id="cb26-24"><a href="#cb26-24" tabindex="-1"></a><span class="co">#&gt; 22  3.413452           22     energy</span></span>
<span id="cb26-25"><a href="#cb26-25" tabindex="-1"></a><span class="co">#&gt; 23        NA           23     energy</span></span>
<span id="cb26-26"><a href="#cb26-26" tabindex="-1"></a><span class="co">#&gt; 24  8.728667           24     energy</span></span>
<span id="cb26-27"><a href="#cb26-27" tabindex="-1"></a><span class="co">#&gt; 25  7.521980           25     energy</span></span></code></pre></div>
<p>You can use your score(s) of choice to compare different models. For
example, we can compute and plot the difference in CRPS scores for each
series in data. Here, a negative value means the AR(1) model
(<code>mod2</code>) is better, while a positive value means the spline
model (<code>mod1</code>) is better.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a>crps_mod1 <span class="ot">&lt;-</span> <span class="fu">score</span>(fc_mod1, <span class="at">score =</span> <span class="st">&quot;crps&quot;</span>)</span>
<span id="cb27-2"><a href="#cb27-2" tabindex="-1"></a>crps_mod2 <span class="ot">&lt;-</span> <span class="fu">score</span>(fc_mod2, <span class="at">score =</span> <span class="st">&quot;crps&quot;</span>)</span>
<span id="cb27-3"><a href="#cb27-3" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" tabindex="-1"></a>diff_scores <span class="ot">&lt;-</span> crps_mod2<span class="sc">$</span>series_1<span class="sc">$</span>score <span class="sc">-</span></span>
<span id="cb27-5"><a href="#cb27-5" tabindex="-1"></a>  crps_mod1<span class="sc">$</span>series_1<span class="sc">$</span>score</span>
<span id="cb27-6"><a href="#cb27-6" tabindex="-1"></a><span class="fu">plot</span>(diff_scores,</span>
<span id="cb27-7"><a href="#cb27-7" tabindex="-1"></a>  <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">cex =</span> <span class="fl">1.25</span>, <span class="at">col =</span> <span class="st">&quot;darkred&quot;</span>,</span>
<span id="cb27-8"><a href="#cb27-8" tabindex="-1"></a>  <span class="at">ylim =</span> <span class="fu">c</span>(</span>
<span id="cb27-9"><a href="#cb27-9" tabindex="-1"></a>    <span class="sc">-</span><span class="dv">1</span> <span class="sc">*</span> <span class="fu">max</span>(<span class="fu">abs</span>(diff_scores), <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb27-10"><a href="#cb27-10" tabindex="-1"></a>    <span class="fu">max</span>(<span class="fu">abs</span>(diff_scores), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb27-11"><a href="#cb27-11" tabindex="-1"></a>  ),</span>
<span id="cb27-12"><a href="#cb27-12" tabindex="-1"></a>  <span class="at">bty =</span> <span class="st">&quot;l&quot;</span>,</span>
<span id="cb27-13"><a href="#cb27-13" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;Forecast horizon&quot;</span>,</span>
<span id="cb27-14"><a href="#cb27-14" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="fu">expression</span>(CRPS[AR1] <span class="sc">~</span> <span class="sc">-</span><span class="er">~</span> CRPS[spline])</span>
<span id="cb27-15"><a href="#cb27-15" tabindex="-1"></a>)</span>
<span id="cb27-16"><a href="#cb27-16" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">lty =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb27-17"><a href="#cb27-17" tabindex="-1"></a>ar1_better <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">which</span>(diff_scores <span class="sc">&lt;</span> <span class="dv">0</span>))</span>
<span id="cb27-18"><a href="#cb27-18" tabindex="-1"></a><span class="fu">title</span>(<span class="at">main =</span> <span class="fu">paste0</span>(</span>
<span id="cb27-19"><a href="#cb27-19" tabindex="-1"></a>  <span class="st">&quot;AR(1) better in &quot;</span>,</span>
<span id="cb27-20"><a href="#cb27-20" tabindex="-1"></a>  ar1_better,</span>
<span id="cb27-21"><a href="#cb27-21" tabindex="-1"></a>  <span class="st">&quot; of &quot;</span>,</span>
<span id="cb27-22"><a href="#cb27-22" tabindex="-1"></a>  <span class="fu">length</span>(diff_scores),</span>
<span id="cb27-23"><a href="#cb27-23" tabindex="-1"></a>  <span class="st">&quot; evaluations&quot;</span>,</span>
<span id="cb27-24"><a href="#cb27-24" tabindex="-1"></a>  <span class="st">&quot;</span><span class="sc">\n</span><span class="st">Mean difference = &quot;</span>,</span>
<span id="cb27-25"><a href="#cb27-25" tabindex="-1"></a>  <span class="fu">round</span>(<span class="fu">mean</span>(diff_scores, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">2</span>)</span>
<span id="cb27-26"><a href="#cb27-26" tabindex="-1"></a>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" width="60%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a></span>
<span id="cb28-2"><a href="#cb28-2" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" tabindex="-1"></a>diff_scores <span class="ot">&lt;-</span> crps_mod2<span class="sc">$</span>series_2<span class="sc">$</span>score <span class="sc">-</span></span>
<span id="cb28-4"><a href="#cb28-4" tabindex="-1"></a>  crps_mod1<span class="sc">$</span>series_2<span class="sc">$</span>score</span>
<span id="cb28-5"><a href="#cb28-5" tabindex="-1"></a><span class="fu">plot</span>(diff_scores,</span>
<span id="cb28-6"><a href="#cb28-6" tabindex="-1"></a>  <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">cex =</span> <span class="fl">1.25</span>, <span class="at">col =</span> <span class="st">&quot;darkred&quot;</span>,</span>
<span id="cb28-7"><a href="#cb28-7" tabindex="-1"></a>  <span class="at">ylim =</span> <span class="fu">c</span>(</span>
<span id="cb28-8"><a href="#cb28-8" tabindex="-1"></a>    <span class="sc">-</span><span class="dv">1</span> <span class="sc">*</span> <span class="fu">max</span>(<span class="fu">abs</span>(diff_scores), <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb28-9"><a href="#cb28-9" tabindex="-1"></a>    <span class="fu">max</span>(<span class="fu">abs</span>(diff_scores), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb28-10"><a href="#cb28-10" tabindex="-1"></a>  ),</span>
<span id="cb28-11"><a href="#cb28-11" tabindex="-1"></a>  <span class="at">bty =</span> <span class="st">&quot;l&quot;</span>,</span>
<span id="cb28-12"><a href="#cb28-12" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;Forecast horizon&quot;</span>,</span>
<span id="cb28-13"><a href="#cb28-13" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="fu">expression</span>(CRPS[AR1] <span class="sc">~</span> <span class="sc">-</span><span class="er">~</span> CRPS[spline])</span>
<span id="cb28-14"><a href="#cb28-14" tabindex="-1"></a>)</span>
<span id="cb28-15"><a href="#cb28-15" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">lty =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb28-16"><a href="#cb28-16" tabindex="-1"></a>ar1_better <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">which</span>(diff_scores <span class="sc">&lt;</span> <span class="dv">0</span>))</span>
<span id="cb28-17"><a href="#cb28-17" tabindex="-1"></a><span class="fu">title</span>(<span class="at">main =</span> <span class="fu">paste0</span>(</span>
<span id="cb28-18"><a href="#cb28-18" tabindex="-1"></a>  <span class="st">&quot;AR(1) better in &quot;</span>,</span>
<span id="cb28-19"><a href="#cb28-19" tabindex="-1"></a>  ar1_better,</span>
<span id="cb28-20"><a href="#cb28-20" tabindex="-1"></a>  <span class="st">&quot; of &quot;</span>,</span>
<span id="cb28-21"><a href="#cb28-21" tabindex="-1"></a>  <span class="fu">length</span>(diff_scores),</span>
<span id="cb28-22"><a href="#cb28-22" tabindex="-1"></a>  <span class="st">&quot; evaluations&quot;</span>,</span>
<span id="cb28-23"><a href="#cb28-23" tabindex="-1"></a>  <span class="st">&quot;</span><span class="sc">\n</span><span class="st">Mean difference = &quot;</span>,</span>
<span id="cb28-24"><a href="#cb28-24" tabindex="-1"></a>  <span class="fu">round</span>(<span class="fu">mean</span>(diff_scores, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">2</span>)</span>
<span id="cb28-25"><a href="#cb28-25" tabindex="-1"></a>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" width="60%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a></span>
<span id="cb29-2"><a href="#cb29-2" tabindex="-1"></a>diff_scores <span class="ot">&lt;-</span> crps_mod2<span class="sc">$</span>series_3<span class="sc">$</span>score <span class="sc">-</span></span>
<span id="cb29-3"><a href="#cb29-3" tabindex="-1"></a>  crps_mod1<span class="sc">$</span>series_3<span class="sc">$</span>score</span>
<span id="cb29-4"><a href="#cb29-4" tabindex="-1"></a><span class="fu">plot</span>(diff_scores,</span>
<span id="cb29-5"><a href="#cb29-5" tabindex="-1"></a>  <span class="at">pch =</span> <span class="dv">16</span>, <span class="at">cex =</span> <span class="fl">1.25</span>, <span class="at">col =</span> <span class="st">&quot;darkred&quot;</span>,</span>
<span id="cb29-6"><a href="#cb29-6" tabindex="-1"></a>  <span class="at">ylim =</span> <span class="fu">c</span>(</span>
<span id="cb29-7"><a href="#cb29-7" tabindex="-1"></a>    <span class="sc">-</span><span class="dv">1</span> <span class="sc">*</span> <span class="fu">max</span>(<span class="fu">abs</span>(diff_scores), <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb29-8"><a href="#cb29-8" tabindex="-1"></a>    <span class="fu">max</span>(<span class="fu">abs</span>(diff_scores), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb29-9"><a href="#cb29-9" tabindex="-1"></a>  ),</span>
<span id="cb29-10"><a href="#cb29-10" tabindex="-1"></a>  <span class="at">bty =</span> <span class="st">&quot;l&quot;</span>,</span>
<span id="cb29-11"><a href="#cb29-11" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;Forecast horizon&quot;</span>,</span>
<span id="cb29-12"><a href="#cb29-12" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="fu">expression</span>(CRPS[AR1] <span class="sc">~</span> <span class="sc">-</span><span class="er">~</span> CRPS[spline])</span>
<span id="cb29-13"><a href="#cb29-13" tabindex="-1"></a>)</span>
<span id="cb29-14"><a href="#cb29-14" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">0</span>, <span class="at">lty =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb29-15"><a href="#cb29-15" tabindex="-1"></a>ar1_better <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="fu">which</span>(diff_scores <span class="sc">&lt;</span> <span class="dv">0</span>))</span>
<span id="cb29-16"><a href="#cb29-16" tabindex="-1"></a><span class="fu">title</span>(<span class="at">main =</span> <span class="fu">paste0</span>(</span>
<span id="cb29-17"><a href="#cb29-17" tabindex="-1"></a>  <span class="st">&quot;AR(1) better in &quot;</span>,</span>
<span id="cb29-18"><a href="#cb29-18" tabindex="-1"></a>  ar1_better,</span>
<span id="cb29-19"><a href="#cb29-19" tabindex="-1"></a>  <span class="st">&quot; of &quot;</span>,</span>
<span id="cb29-20"><a href="#cb29-20" tabindex="-1"></a>  <span class="fu">length</span>(diff_scores),</span>
<span id="cb29-21"><a href="#cb29-21" tabindex="-1"></a>  <span class="st">&quot; evaluations&quot;</span>,</span>
<span id="cb29-22"><a href="#cb29-22" tabindex="-1"></a>  <span class="st">&quot;</span><span class="sc">\n</span><span class="st">Mean difference = &quot;</span>,</span>
<span id="cb29-23"><a href="#cb29-23" tabindex="-1"></a>  <span class="fu">round</span>(<span class="fu">mean</span>(diff_scores, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">2</span>)</span>
<span id="cb29-24"><a href="#cb29-24" tabindex="-1"></a>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" width="60%" style="display: block; margin: auto;" /></p>
<p>The correlated AR(1) model consistently gives better forecasts, and
the difference between scores tends to grow as the forecast horizon
increases. This is not unexpected given the way that splines linearly
extrapolate outside the range of training data</p>
</div>
<div id="further-reading" class="section level2">
<h2>Further reading</h2>
<p>The following papers and resources offer useful material about
Bayesian forecasting and proper scoring rules:</p>
<p>Clark N.J., et al. <a href="https://peerj.com/articles/18929/">Beyond
single-species models: leveraging multispecies forecasts to navigate the
dynamics of ecological predictability</a>. <em>PeerJ</em> 13:e18929
(2025) <a href="https://doi.org/10.7717/peerj.18929" class="uri">https://doi.org/10.7717/peerj.18929</a></p>
<p>Hyndman, Rob J., and George Athanasopoulos. <a href="https://otexts.com/fpp3/distaccuracy.html">Forecasting: principles
and practice</a>. <em>OTexts</em>, (2018).</p>
<p>Gneiting, Tilmann, and Adrian E. Raftery. <a href="https://www.tandfonline.com/doi/abs/10.1198/016214506000001437">Strictly
proper scoring rules, prediction, and estimation</a> <em>Journal of the
American statistical Association</em> 102.477 (2007) 359-378.</p>
<p>Simonis, Juniper L., et al. <a href="https://esajournals.onlinelibrary.wiley.com/doi/full/10.1002/ecy.3431">Evaluating
probabilistic ecological forecasts</a> <em>Ecology</em> 102.8 (2021)
e03431.</p>
</div>
<div id="interested-in-contributing" class="section level2">
<h2>Interested in contributing?</h2>
<p>I’m actively seeking PhD students and other researchers to work in
the areas of ecological forecasting, multivariate model evaluation and
development of <code>mvgam</code>. Please see <a href="https://ecogambler.netlify.app/opportunities/">this small list of
opportunities on my website</a> and do reach out if you are interested
(n.clark’at’uq.edu.au)</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
