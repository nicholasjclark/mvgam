% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/mock-stanfit.R
\name{prepare_predictions.mock_stanfit}
\alias{prepare_predictions.mock_stanfit}
\title{Prepare Predictions for Mock stanfit}
\usage{
\method{prepare_predictions}{mock_stanfit}(
  object,
  brmsfit,
  newdata = NULL,
  re_formula = NULL,
  allow_new_levels = FALSE,
  sample_new_levels = "uncertainty",
  ...
)
}
\arguments{
\item{object}{A mock_stanfit object created by create_mock_stanfit()
containing parameter draws subset}

\item{brmsfit}{A brmsfit object providing formula, family, and other
metadata needed for design matrix construction}

\item{newdata}{Data frame with predictor values for predictions. If NULL,
uses original fitting data from brmsfit}

\item{re_formula}{Formula for random effects. NULL includes all random
effects, NA excludes all}

\item{allow_new_levels}{Logical indicating whether new factor levels in
random effects are allowed}

\item{sample_new_levels}{Character specifying how to sample new levels:
"uncertainty" or "gaussian"}

\item{...}{Additional arguments passed to brms::make_standata()}
}
\value{
A brmsprep object (S3 list) containing design matrices, formula
metadata, family information, and parameter draws needed for posterior
predictions. Compatible with downstream mvgam prediction functions.
}
\description{
S3 method for prepare_predictions that works with mock_stanfit objects
created by create_mock_stanfit(). This method generates design matrices
and prediction metadata using brmsfit formula and family information
without requiring a full Stan fit object.
}
\details{
This method implements the prepare_predictions interface for
mock_stanfit objects, enabling mvgam to use brms prediction
infrastructure with parameter subsets extracted from combined
Stan fits.

The function leverages brms::standata() to generate design matrices
for fixed effects, random effects, smooths, GPs, and other special
terms. This ensures compatibility with all brms formula features.

For nonlinear formula models (nl = TRUE), this method automatically
calls compute_nonlinear_dpars() to evaluate the nonlinear
expression and add dpars$mu to the returned prep object.

The returned brmsprep object contains all metadata needed for
computing linear predictors via extract_linpred_from_prep().
}
