% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/make_stan.R
\name{stancode.mvgam_formula}
\alias{stancode.mvgam_formula}
\title{Generate Stan Model Code for mvgam Formula}
\usage{
\method{stancode}{mvgam_formula}(
  object,
  data,
  family = gaussian(),
  prior = NULL,
  data2 = NULL,
  sample_prior = "no",
  sparse = NULL,
  knots = NULL,
  drop_unused_levels = TRUE,
  backend = "rstan",
  threads = getOption("mc.cores", 1),
  normalize = TRUE,
  save_model = NULL,
  stan_funs = NULL,
  silent = 1L,
  validate = TRUE,
  ...
)
}
\arguments{
\item{object}{An \code{mvgam_formula} object created by \code{mvgam_formula()}.}

\item{data}{A data frame containing all variables referenced in the formula.}

\item{family}{A family object or character string specifying the response
distribution. If \code{object} contains embedded family specifications,
this parameter can be omitted.}

\item{prior}{An optional \code{brmsprior} object containing custom prior
specifications. Can be created using \code{brms::prior()}.}

\item{data2}{Optional data frame for out-of-sample prediction points.}

\item{sample_prior}{Character string indicating whether to sample from priors
only. Options: \code{"no"} (default), \code{"yes"}, \code{"only"}.}

\item{sparse}{Logical; should sparse matrix operations be used? Default is
\code{NULL} (automatic selection).}

\item{knots}{Optional list of knot positions for spline terms.}

\item{drop_unused_levels}{Logical; should unused factor levels be dropped?
Default is \code{TRUE}.}

\item{backend}{Character string specifying Stan backend. Options:
\code{"rstan"} (default) or \code{"cmdstanr"}.}

\item{threads}{Number of threads to use for parallelization. Default is
\code{getOption("mc.cores", 1)}.}

\item{normalize}{Logical; should data be normalized for efficient sampling?
Default is \code{TRUE}.}

\item{save_model}{File path to save the compiled Stan model. If \code{NULL}
(default), the model is not saved.}

\item{stan_funs}{Optional character string containing additional Stan functions.}

\item{silent}{Integer controlling verbosity. 0 = silent, 1 = some output,
2 = verbose. Default is 1.}

\item{...}{Additional arguments passed to internal functions.}
}
\value{
A character string containing complete, polished Stan model code with data,
parameters, model, and generated quantities blocks for both observation
and trend components. The returned code is automatically polished for
consistent formatting and is identical to the code used internally by
\code{mvgam()} for model fitting.
}
\description{
Generate complete Stan model code for an \code{mvgam_formula} object before
model fitting. This allows users to inspect the generated Stan code for
debugging, understanding, or modification purposes.
}
\details{
This function uses the shared Stan code generation infrastructure
(\code{generate_stan_components_mvgam_formula()}) to ensure identical output
to what \code{mvgam()} uses internally. The Stan code is automatically
polished for consistent formatting, with empty lines removed and whitespace
trimmed. This guarantees that \code{stancode()} produces exactly the same
model code that would be compiled and fit by \code{mvgam()}.
}
\examples{
\dontrun{
# Create mvgam_formula object
mf <- mvgam_formula(count ~ temperature, trend_formula = ~ AR(p = 1))

# Generate Stan code
stan_code <- stancode(mf, data = ecology_data, family = poisson())
cat(stan_code)

# With custom priors
custom_priors <- brms::prior("normal(0, 0.5)", class = "ar1_trend") +
                 brms::prior("exponential(2)", class = "sigma_trend")
stan_code_custom <- stancode(mf, data = ecology_data,
                             family = poisson(), prior = custom_priors)
}

}
\seealso{
\code{\link{mvgam_formula}}, \code{\link{get_prior.mvgam_formula}},
\code{\link{standata}}, \code{\link{mvgam}}
}
