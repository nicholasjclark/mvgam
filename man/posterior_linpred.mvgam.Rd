% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/posterior_linpred.R
\name{posterior_linpred.mvgam}
\alias{posterior_linpred.mvgam}
\title{Extract Posterior Linear Predictor from mvgam Models}
\usage{
\method{posterior_linpred}{mvgam}(
  object,
  newdata = NULL,
  process_error = TRUE,
  ndraws = NULL,
  re_formula = NULL,
  allow_new_levels = FALSE,
  sample_new_levels = "uncertainty",
  resp = NULL,
  ...
)
}
\arguments{
\item{object}{A fitted mvgam object from \code{\link[=mvgam]{mvgam()}}.}

\item{newdata}{Optional data frame with covariates for prediction. If
NULL, uses original training data stored in the model object.}

\item{process_error}{Logical; if TRUE (default), includes full
draw-by-draw uncertainty from trend parameters. If FALSE, fixes
trend at posterior mean for faster computation.}

\item{ndraws}{Positive integer specifying number of posterior draws to
use. NULL (default) uses all available draws.}

\item{re_formula}{Formula for random effects. NULL (default) includes
all random effects, NA excludes all random effects.}

\item{allow_new_levels}{Logical; if TRUE, allows new factor levels in
random effects grouping variables. Default FALSE.}

\item{sample_new_levels}{Character specifying how to handle new levels.
Either "uncertainty" (default) or "gaussian".}

\item{resp}{Character specifying which response variable for
multivariate models. NULL (default) returns predictions for all
responses.}

\item{...}{Additional arguments passed to internal methods.}
}
\value{
Matrix with dimensions \link{ndraws x nobs} containing linear
predictor values. Each row is one posterior draw, each column is
one observation from newdata. Values are on link scale.

For multivariate models with resp = NULL, returns a named list of
matrices (one per response variable).
}
\description{
Extract linear predictor values (eta, on link scale) from fitted mvgam
models. Combines observation model effects with State-Space trend
components. For Poisson models this is log-scale; for binomial models
this is logit-scale.
}
\details{
The linear predictor combines:
\itemize{
\item Observation model effects: fixed effects, random effects,
smooth terms, GP terms from the observation formula
\item Trend effects: State-Space trend contributions from the
trend formula (if present)
}

For models without a trend component (trend_formula = NULL), behavior
matches \code{\link[brms:posterior_linpred.brmsfit]{brms::posterior_linpred()}}.

The \code{process_error} argument controls uncertainty propagation:
\itemize{
\item TRUE: Full posterior uncertainty from both observation and
trend parameters (draw-by-draw variation)
\item FALSE: Trend fixed at posterior mean; only observation
uncertainty propagated (faster but understates total uncertainty)
}
}
\examples{
\dontrun{
# Fit a State-Space model
fit <- mvgam(
  count ~ temperature + s(day),
  trend_formula = ~ AR(p = 1),
  data = my_data,
  family = poisson()
)

# Extract linear predictor (link scale)
linpred <- posterior_linpred(fit)

# With new data
linpred_new <- posterior_linpred(fit, newdata = new_data)

# Reduce uncertainty by fixing trend at posterior mean
linpred_fast <- posterior_linpred(fit, process_error = FALSE)

# Subset draws for speed
linpred_sub <- posterior_linpred(fit, ndraws = 100)
}

}
\seealso{
\code{\link[brms:posterior_linpred.brmsfit]{brms::posterior_linpred()}} for the brms generic,
\code{\link[=posterior_epred.mvgam]{posterior_epred.mvgam()}} for expected values on response scale,
\code{\link[=posterior_predict.mvgam]{posterior_predict.mvgam()}} for posterior predictive samples.
}
