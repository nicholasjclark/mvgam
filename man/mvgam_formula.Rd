% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/priors.R
\name{mvgam_formula}
\alias{mvgam_formula}
\title{Create an mvgam Formula Object}
\usage{
mvgam_formula(formula, trend_formula = NULL)
}
\arguments{
\item{formula}{An object of class \code{formula}, \code{brmsformula}, or
\code{mvbrmsformula} describing the observation model.}

\item{trend_formula}{An optional formula describing trend dynamics. Default
NULL results in pure brms equivalent model. See Details for trend syntax.}
}
\value{
An object of class \code{c("mvgam_formula", base_class)} where
base_class is the class of the input formula, containing:
\itemize{
\item \code{formula}: The observation model formula
\item \code{trend_formula}: The trend model formula (or NULL)
}
}
\description{
Constructs a lightweight mvgam formula object that combines observation and
trend model formulas. This provides a clean interface for model specification
that can be used with inspection functions like \code{get_prior()},
\code{make_stancode()}, and \code{make_standata()}.
}
\details{
The mvgam_formula object is a minimal container that pairs an observation
formula with an optional trend formula. Data, family, and other model
specifications are provided when calling inspection or fitting functions:

\code{get_prior(mvgam_formula(y ~ x, ~ AR()), data = dat, family = poisson())}

When \code{trend_formula = NULL}, the model reduces to a pure brms
observation model. When specified, the trend_formula can include:
\itemize{
\item Trend constructors: \code{RW()}, \code{AR()}, \code{CAR()},
\code{ZMVN()}, \code{VAR()}, \code{PW()}
\item Covariates that affect trend dynamics
\item Smooth terms using mgcv syntax: \code{s()}, \code{te()}, \code{ti()}, \code{t2()}
\item Random effects: \code{(1|group)}, \code{(slope|group)}
\item Gaussian processes: \code{gp()}
}
}
\section{Trend Formula Restrictions}{

The trend_formula has specific restrictions to maintain compatibility with
State-Space dynamics and prevent conflicts between observation-level and
trend-level modeling:

\strong{Forbidden Terms:}
\itemize{
\item brms addition-terms: \code{weights()}, \code{cens()}, \code{trunc()},
\code{mi()}, \code{trials()}, \code{rate()}, \code{vreal()}, \code{vint()},
\code{subset()}, \code{index()}
\item brms autocorrelation: \code{ar()}, \code{ma()}, \code{arma()},
\code{cosy()}, \code{unstr()}, \code{autocor()}
\item Offset terms: \code{offset()}
}

\strong{Rationale:}
Addition-terms modify observation model behavior (weights, censoring, exposure,
etc.) and should be specified in the main observation formula. Autocorrelation
terms conflict with mvgam's State-Space dynamics. All forbidden terms remain
fully supported in the main observation formula.

\strong{Examples:}
\preformatted{
# Correct usage
mvgam_formula(y ~ x + weights(w), trend_formula = ~ AR(p = 1))
mvgam_formula(count ~ offset(log_exposure), trend_formula = ~ RW())

# Incorrect usage (will error)
mvgam_formula(y ~ x, trend_formula = ~ AR() + weights(w))
mvgam_formula(y ~ x, trend_formula = ~ RW() + offset(z))
}
}

\examples{
\dontrun{
# Create formula specifications
mf1 <- mvgam_formula(y ~ x + (1|group))
mf2 <- mvgam_formula(count ~ treatment, trend_formula = ~ AR(p = 1))
mf3 <- mvgam_formula(mvbind(y1, y2) ~ x, trend_formula = ~ VAR(lags = 1))

# Use with inspection functions (data provided to the function)
priors <- get_prior(mf2, data = ecology_data, family = poisson())
stancode <- make_stancode(mf2, data = ecology_data, family = poisson())
}

}
\seealso{
\code{\link{get_prior.mvgam_formula}}, \code{\link{make_stancode}},
\code{\link{make_standata}}, \code{\link{mvgam}}
}
