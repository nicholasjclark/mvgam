% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/posterior_predict.R
\name{posterior_predict.mvgam}
\alias{posterior_predict.mvgam}
\title{Extract Posterior Predictive Distribution from mvgam Models}
\usage{
\method{posterior_predict}{mvgam}(
  object,
  newdata = NULL,
  process_error = TRUE,
  ndraws = NULL,
  re_formula = NULL,
  allow_new_levels = FALSE,
  sample_new_levels = "uncertainty",
  resp = NULL,
  ...
)
}
\arguments{
\item{object}{A fitted mvgam object from \code{\link[=mvgam]{mvgam()}}.}

\item{newdata}{Optional data frame with covariates for prediction. If
NULL, uses original training data stored in the model object.}

\item{process_error}{Logical; if TRUE (default), includes full
draw-by-draw uncertainty from trend parameters. If FALSE, fixes
trend at posterior mean for faster computation.}

\item{ndraws}{Positive integer specifying number of posterior draws to
use. NULL (default) uses all available draws.}

\item{re_formula}{Formula for random effects. NULL (default) includes
all random effects, NA excludes all random effects.}

\item{allow_new_levels}{Logical; if TRUE, allows new factor levels in
random effects grouping variables. Default FALSE.}

\item{sample_new_levels}{Character specifying how to handle new levels.
Either "uncertainty" (default) or "gaussian".}

\item{resp}{Character specifying which response variable for
multivariate models. NULL (default) returns predictions for all
responses.}

\item{...}{Additional arguments passed to internal methods.}
}
\value{
Matrix with dimensions \link{ndraws x nobs} containing posterior
predictive samples. Each row is one posterior draw, each column is
one observation. Values are on the response scale (include observation
noise).

For multivariate models with resp = NULL, returns a named list of
matrices (one per response variable).
}
\description{
Generate posterior predictive samples from fitted mvgam models. These samples
include observation-level noise, making them suitable for posterior predictive
checks and predictions on new data.
}
\details{
The posterior predictive distribution combines:
\itemize{
\item Expected values E\link{Y|X}: from observation + trend models
\item Observation noise: family-specific random draws
}

This differs from \code{\link[=posterior_epred.mvgam]{posterior_epred.mvgam()}} which returns only E\link{Y|X}.
Posterior predictive samples have higher variance and are suitable for
checking if the model can generate data like the observed data.
}
\examples{
\dontrun{
# Fit a Poisson model
fit <- mvgam(
  count ~ temperature + s(day),
  trend_formula = ~ AR(p = 1),
  data = my_data,
  family = poisson()
)

# Generate posterior predictive samples
pp <- posterior_predict(fit)
dim(pp)  # [ndraws x nobs]

# Posterior predictive check: samples should vary more than epred
epred <- posterior_epred(fit)
var(pp) > var(epred)  # Should be TRUE
}

}
\seealso{
\code{\link[=posterior_epred.mvgam]{posterior_epred.mvgam()}} for expected values without noise,
\code{\link[=posterior_linpred.mvgam]{posterior_linpred.mvgam()}} for link-scale predictions.
}
