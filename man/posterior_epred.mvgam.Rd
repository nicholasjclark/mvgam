% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/posterior_epred.R
\name{posterior_epred.mvgam}
\alias{posterior_epred.mvgam}
\title{Extract Posterior Expected Values from mvgam Models}
\usage{
\method{posterior_epred}{mvgam}(
  object,
  newdata = NULL,
  process_error = TRUE,
  ndraws = NULL,
  re_formula = NULL,
  allow_new_levels = FALSE,
  sample_new_levels = "uncertainty",
  resp = NULL,
  ...
)
}
\arguments{
\item{object}{A fitted mvgam object from \code{\link[=mvgam]{mvgam()}}.}

\item{newdata}{Optional data frame with covariates for prediction. If
NULL, uses original training data stored in the model object.}

\item{process_error}{Logical; if TRUE (default), includes full
draw-by-draw uncertainty from trend parameters. If FALSE, fixes
trend at posterior mean for faster computation.}

\item{ndraws}{Positive integer specifying number of posterior draws to
use. NULL (default) uses all available draws.}

\item{re_formula}{Formula for random effects. NULL (default) includes
all random effects, NA excludes all random effects.}

\item{allow_new_levels}{Logical; if TRUE, allows new factor levels in
random effects grouping variables. Default FALSE.}

\item{sample_new_levels}{Character specifying how to handle new levels.
Either "uncertainty" (default) or "gaussian".}

\item{resp}{Character specifying which response variable for
multivariate models. NULL (default) returns predictions for all
responses.}

\item{...}{Additional arguments passed to internal methods.}
}
\value{
Matrix with dimensions \link{ndraws x nobs} containing expected
values on response scale. Each row is one posterior draw, each column
is one observation from newdata.

For multivariate models with resp = NULL, returns a named list of
matrices (one per response variable).
}
\description{
Extract expected values (on response scale) from fitted mvgam models.
Combines observation and trend components, then applies the inverse link
function to transform from link scale to response scale.
}
\details{
Expected values are computed as E\link{Y|X} by applying the inverse link
function to the linear predictor. For most families this is simply
\code{linkinv(eta)}:
\itemize{
\item Gaussian, Poisson, Bernoulli, Beta, Gamma, NegBinomial, Student:
E\link{Y} = linkinv(eta)
}

Some families require additional parameters:
\itemize{
\item Binomial, Beta-binomial: E\link{Y} = p * trials (requires trials)
\item Lognormal: E\link{Y} = exp(mu + sigma^2/2) (requires sigma)
}

Unsupported families:
\itemize{
\item N-mixture, Tweedie: require specialized computation
}
}
\examples{
\dontrun{
# Fit a Poisson model
fit <- mvgam(
  count ~ temperature + s(day),
  trend_formula = ~ AR(p = 1),
  data = my_data,
  family = poisson()
)

# Extract expected values (response scale)
epred <- posterior_epred(fit)

# For Poisson: epred = exp(linpred)
linpred <- posterior_linpred(fit)
all.equal(epred, exp(linpred))
}

}
\seealso{
\code{\link[=posterior_linpred.mvgam]{posterior_linpred.mvgam()}} for link scale predictions,
\code{\link[=posterior_predict.mvgam]{posterior_predict.mvgam()}} for posterior predictive samples.
}
