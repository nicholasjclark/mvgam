===============================================================================
Parameter Pattern Research for summary.mvgam()
===============================================================================

ℹ Loading mvgam
Loading required package: brms
Loading required package: Rcpp
Loading 'brms' package (version 2.22.9). Useful instructions
can be found by typing help('brms'). A more detailed introduction
to the package is available through vignette('brms_overview').

Attaching package: 'brms'

The following object is masked from 'package:stats':

    ar

Loading 'mvgam' (version 2.0.0). Useful instructions can be found by
  typing help('mvgam'). A more detailed introduction to the package is
  available through vignette('mvgam_overview'). Full brms compatibility is
  now enabled.
This is posterior version 1.6.1

Attaching package: 'posterior'

The following object is masked from 'package:mvgam':

    sd

The following objects are masked from 'package:stats':

    mad, sd, var

The following objects are masked from 'package:base':

    %in%, match

Warning message:
package 'posterior' was built under R version 4.4.3 


FITTING TARGET 1...
Validating combined Stan code...

===============================================================================
MODEL: target1_rw 
===============================================================================

Formula: y ~ x 
Trend Formula: trend_y ~ 1 
Family: poisson 
Response Names: y 

TOTAL PARAMETERS: 126 

--- PARAMETER CATEGORIZATION ---

Fixed Effects (b_*): 2 
  Examples: b_Intercept, b_Intercept_trend 

Family Parameters (sigma, shape, nu, etc.): 1 
  Full list: sigma_trend[1] 

Trend Parameters (*_trend): 99 
  Examples: Intercept_trend, sigma_trend[1], innovations_trend[1,1], innovations_trend[2,1], innovations_trend[3,1], innovations_trend[4,1], innovations_trend[5,1], innovations_trend[6,1], innovations_trend[7,1], innovations_trend[8,1] 

Latent States (trend[*], lv_trend[*]): 48 
  (Not shown - too many)

--- POSTERIOR::SUMMARISE_DRAWS() COLUMN NAMING ---

Probability: 0.90 (quantiles: 0.0500, 0.9500)
  Column names: variable, mean, sd, q5, q95, rhat, ess_bulk, ess_tail 
  Example (first parameter):
# A tibble: 1 × 8
  variable   mean     sd      q5   q95  rhat ess_bulk ess_tail
  <chr>     <dbl>  <dbl>   <dbl> <dbl> <dbl>    <dbl>    <dbl>
1 b[1]     0.0277 0.0690 -0.0790 0.147  1.00     726.     431.

Probability: 0.95 (quantiles: 0.0250, 0.9750)
  Column names: variable, mean, sd, q2.5, q97.5, rhat, ess_bulk, ess_tail 
  Example (first parameter):
# A tibble: 1 × 8
  variable   mean     sd   q2.5 q97.5  rhat ess_bulk ess_tail
  <chr>     <dbl>  <dbl>  <dbl> <dbl> <dbl>    <dbl>    <dbl>
1 b[1]     0.0277 0.0690 -0.106 0.169  1.00     726.     431.

Probability: 0.99 (quantiles: 0.0050, 0.9950)
  Column names: variable, mean, sd, q0.5, q99.5, rhat, ess_bulk, ess_tail 
  Example (first parameter):
# A tibble: 1 × 8
  variable   mean     sd   q0.5 q99.5  rhat ess_bulk ess_tail
  <chr>     <dbl>  <dbl>  <dbl> <dbl> <dbl>    <dbl>    <dbl>
1 b[1]     0.0277 0.0690 -0.132 0.199  1.00     726.     431.

Full parameter list saved to: tasks/research/fitted_models/target1_rw_parameters.txt 

Model saved to: tasks/research/fitted_models/target1_rw.rds 

Warning messages:
1: The ESS has been capped to avoid unstable estimates. 
2: The ESS has been capped to avoid unstable estimates. 
3: The ESS has been capped to avoid unstable estimates. 
4: The ESS has been capped to avoid unstable estimates. 
5: The ESS has been capped to avoid unstable estimates. 
6: The ESS has been capped to avoid unstable estimates. 
7: The ESS has been capped to avoid unstable estimates. 
8: The ESS has been capped to avoid unstable estimates. 
9: The ESS has been capped to avoid unstable estimates. 


FITTING TARGET 2...
Validating combined Stan code...

===============================================================================
MODEL: target2_shared_rw 
===============================================================================

Formula: structure(list(forms = list(count = structure(list(formula = count ~      x, pforms = list(), pfix = list(), resp = "count", family = NULL), class = c("brmsformula",  "bform")), biomass = structure(list(formula = biomass ~ x, pforms = list(),      pfix = list(), resp = "biomass", family = NULL), class = c("brmsformula",  "bform"))), responses = c("count", "biomass"), rescor = FALSE), class = c("mvbrmsformula",  "bform")) 
Trend Formula: trend_y ~ 1 
Family: 
Response Names: count, biomass 

TOTAL PARAMETERS: 236 

--- PARAMETER CATEGORIZATION ---

Fixed Effects (b_*): 5 
  Examples: b_count[1], b_biomass[1], b_count_Intercept, b_biomass_Intercept, b_Intercept_trend 

Family Parameters (sigma, shape, nu, etc.): 4 
  Full list: sigma_count, sigma_biomass, sigma_trend[1], sigma_trend[2] 

Trend Parameters (*_trend): 180 
  Examples: Intercept_trend, sigma_trend[1], sigma_trend[2], L_Omega_trend[1,1], L_Omega_trend[2,1], L_Omega_trend[1,2], L_Omega_trend[2,2], innovations_trend[1,1], innovations_trend[2,1], innovations_trend[3,1] 

Latent States (trend[*], lv_trend[*]): 96 
  (Not shown - too many)

--- POSTERIOR::SUMMARISE_DRAWS() COLUMN NAMING ---

Probability: 0.90 (quantiles: 0.0500, 0.9500)
  Column names: variable, mean, sd, q5, q95, rhat, ess_bulk, ess_tail 
  Example (first parameter):
# A tibble: 1 × 8
  variable     mean    sd     q5   q95  rhat ess_bulk ess_tail
  <chr>       <dbl> <dbl>  <dbl> <dbl> <dbl>    <dbl>    <dbl>
1 b_count[1] 0.0396 0.320 -0.504 0.574  1.00     631.     406.

Probability: 0.95 (quantiles: 0.0250, 0.9750)
  Column names: variable, mean, sd, q2.5, q97.5, rhat, ess_bulk, ess_tail 
  Example (first parameter):
# A tibble: 1 × 8
  variable     mean    sd   q2.5 q97.5  rhat ess_bulk ess_tail
  <chr>       <dbl> <dbl>  <dbl> <dbl> <dbl>    <dbl>    <dbl>
1 b_count[1] 0.0396 0.320 -0.573 0.622  1.00     631.     406.

Probability: 0.99 (quantiles: 0.0050, 0.9950)
  Column names: variable, mean, sd, q0.5, q99.5, rhat, ess_bulk, ess_tail 
  Example (first parameter):
# A tibble: 1 × 8
  variable     mean    sd   q0.5 q99.5  rhat ess_bulk ess_tail
  <chr>       <dbl> <dbl>  <dbl> <dbl> <dbl>    <dbl>    <dbl>
1 b_count[1] 0.0396 0.320 -0.702 0.756  1.00     631.     406.

Full parameter list saved to: tasks/research/fitted_models/target2_shared_rw_parameters.txt 

Model saved to: tasks/research/fitted_models/target2_shared_rw.rds 



FITTING TARGET 3...
Validating combined Stan code...
Warning: 61 of 500 (12.0%) transitions ended with a divergence.
See https://mc-stan.org/misc/warnings for details.

Warning: 29 of 500 (6.0%) transitions hit the maximum treedepth limit of 10.
See https://mc-stan.org/misc/warnings for details.

Warning: 2 of 2 chains had an E-BFMI less than 0.3.
See https://mc-stan.org/misc/warnings for details.


===============================================================================
MODEL: target3_varma 
===============================================================================

Formula: structure(list(forms = list(count = structure(list(formula = count ~      s(x), pforms = list(), pfix = list(), resp = "count", family = NULL), class = c("brmsformula",  "bform")), biomass = structure(list(formula = biomass ~ s(x),      pforms = list(), pfix = list(), resp = "biomass", family = NULL), class = c("brmsformula",  "bform"))), responses = c("count", "biomass"), rescor = FALSE), class = c("mvbrmsformula",  "bform")) 
Trend Formula: trend_y ~ presence 
Family: 
Response Names: count, biomass 

TOTAL PARAMETERS: 295 

--- PARAMETER CATEGORIZATION ---

Fixed Effects (b_*): 4 
  Examples: b_trend[1], b_count_Intercept, b_biomass_Intercept, b_Intercept_trend 

Smooth Parameters (s_*, sds_*): 18 
  Examples: sds_count_1[1], sds_biomass_1[1], s_count_1_1[1], s_count_1_1[2], s_count_1_1[3], s_count_1_1[4], s_count_1_1[5], s_count_1_1[6], s_count_1_1[7], s_count_1_1[8] 

Family Parameters (sigma, shape, nu, etc.): 4 
  Full list: sigma_count, sigma_biomass, sigma_trend[1], sigma_trend[2] 

Trend Parameters (*_trend): 169 
  Examples: lv_trend[1,1], lv_trend[2,1], lv_trend[3,1], lv_trend[4,1], lv_trend[5,1], lv_trend[6,1], lv_trend[7,1], lv_trend[8,1], lv_trend[9,1], lv_trend[10,1] 

Latent States (trend[*], lv_trend[*]): 96 
  (Not shown - too many)

--- POSTERIOR::SUMMARISE_DRAWS() COLUMN NAMING ---

Probability: 0.90 (quantiles: 0.0500, 0.9500)
  Column names: variable, mean, sd, q5, q95, rhat, ess_bulk, ess_tail 
  Example (first parameter):
# A tibble: 1 × 8
  variable         mean    sd    q5   q95  rhat ess_bulk ess_tail
  <chr>           <dbl> <dbl> <dbl> <dbl> <dbl>    <dbl>    <dbl>
1 Intercept_count  3.32  1.49  1.09  5.78  1.00     172.     214.

Probability: 0.95 (quantiles: 0.0250, 0.9750)
  Column names: variable, mean, sd, q2.5, q97.5, rhat, ess_bulk, ess_tail 
  Example (first parameter):
# A tibble: 1 × 8
  variable         mean    sd  q2.5 q97.5  rhat ess_bulk ess_tail
  <chr>           <dbl> <dbl> <dbl> <dbl> <dbl>    <dbl>    <dbl>
1 Intercept_count  3.32  1.49 0.414  6.47  1.00     172.     214.

Probability: 0.99 (quantiles: 0.0050, 0.9950)
  Column names: variable, mean, sd, q0.5, q99.5, rhat, ess_bulk, ess_tail 
  Example (first parameter):
# A tibble: 1 × 8
  variable         mean    sd   q0.5 q99.5  rhat ess_bulk ess_tail
  <chr>           <dbl> <dbl>  <dbl> <dbl> <dbl>    <dbl>    <dbl>
1 Intercept_count  3.32  1.49 -0.887  7.58  1.00     172.     214.

Full parameter list saved to: tasks/research/fitted_models/target3_varma_parameters.txt 

Model saved to: tasks/research/fitted_models/target3_varma.rds 



FITTING TARGET 4...
Setting 'rescor' to FALSE by default for this model
Setting 'rescor' to FALSE by default for this model
Setting 'rescor' to FALSE by default for this model
Validating combined Stan code...
Warning: 16 of 500 (3.0%) transitions ended with a divergence.
See https://mc-stan.org/misc/warnings for details.


===============================================================================
MODEL: target4_factor_ar 
===============================================================================

Formula: structure(list(forms = list(count = structure(list(formula = count ~      x, pforms = list(), pfix = list(), family = structure(list(     family = "poisson", link = "log", linkfun = function (mu)      link(mu, link = slink), linkinv = function (eta)      inv_link(eta, link = slink), dpars = "mu", type = "int",      ybounds = c(0, Inf), closed = c(TRUE, NA), ad = c("weights",      "subset", "cens", "trunc", "rate", "index"), specials = "sbi_log"), class = c("brmsfamily",  "family")), resp = "count"), class = c("brmsformula", "bform" )), presence = structure(list(formula = presence ~ x, pforms = list(),      pfix = list(), family = structure(list(family = "bernoulli",          link = "logit", linkfun = function (mu)          link(mu, link = slink), linkinv = function (eta)          inv_link(eta, link = slink), dpars = "mu", type = "int",          ybounds = c(0, 1), closed = c(TRUE, TRUE), ad = c("weights",          "subset", "index"), specials = c("binary", "sbi_logit"         )), class = c("brmsfamily", "family")), resp = "presence"), class = c("brmsformula",  "bform")), biomass = structure(list(formula = biomass ~ x, pforms = list(),      pfix = list(), family = structure(list(family = "gamma",          link = "log", linkfun = function (mu)          link(mu, link = slink), linkinv = function (eta)          inv_link(eta, link = slink), dpars = c("mu", "shape"),          type = "real", ybounds = c(0, Inf), closed = c(FALSE,          NA), ad = c("weights", "subset", "cens", "trunc", "mi",          "index")), class = c("brmsfamily", "family")), resp = "biomass"), class = c("brmsformula",  "bform"))), responses = c(count = "count", presence = "presence",  "biomass"), rescor = NULL), class = c("mvbrmsformula", "bform" )) 
Trend Formula: trend_y ~ 1 - 1 
Setting 'rescor' to FALSE by default for this model
Family: 
Response Names: count, presence, biomass 

TOTAL PARAMETERS: 274 

--- PARAMETER CATEGORIZATION ---

Fixed Effects (b_*): 6 
  Examples: b_count[1], b_presence[1], b_biomass[1], b_count_Intercept, b_presence_Intercept 

Family Parameters (sigma, shape, nu, etc.): 3 
  Full list: shape_biomass, sigma_trend[1], sigma_trend[2] 

Trend Parameters (*_trend): 180 
  Examples: sigma_trend[1], sigma_trend[2], L_Omega_trend[1,1], L_Omega_trend[2,1], L_Omega_trend[1,2], L_Omega_trend[2,2], innovations_trend[1,1], innovations_trend[2,1], innovations_trend[3,1], innovations_trend[4,1] 

Factor Loadings (Z[*]): 6 
  Examples: Z[1,1], Z[2,1], Z[3,1], Z[1,2], Z[2,2] 

Latent States (trend[*], lv_trend[*]): 120 
  (Not shown - too many)

--- POSTERIOR::SUMMARISE_DRAWS() COLUMN NAMING ---

Probability: 0.90 (quantiles: 0.0500, 0.9500)
  Column names: variable, mean, sd, q5, q95, rhat, ess_bulk, ess_tail 
  Example (first parameter):
# A tibble: 1 × 8
  variable      mean     sd     q5   q95  rhat ess_bulk ess_tail
  <chr>        <dbl>  <dbl>  <dbl> <dbl> <dbl>    <dbl>    <dbl>
1 b_count[1] 0.00837 0.0782 -0.112 0.137  1.00     373.     197.

Probability: 0.95 (quantiles: 0.0250, 0.9750)
  Column names: variable, mean, sd, q2.5, q97.5, rhat, ess_bulk, ess_tail 
  Example (first parameter):
# A tibble: 1 × 8
  variable      mean     sd   q2.5 q97.5  rhat ess_bulk ess_tail
  <chr>        <dbl>  <dbl>  <dbl> <dbl> <dbl>    <dbl>    <dbl>
1 b_count[1] 0.00837 0.0782 -0.145 0.188  1.00     373.     197.

Probability: 0.99 (quantiles: 0.0050, 0.9950)
  Column names: variable, mean, sd, q0.5, q99.5, rhat, ess_bulk, ess_tail 
  Example (first parameter):
# A tibble: 1 × 8
  variable      mean     sd   q0.5 q99.5  rhat ess_bulk ess_tail
  <chr>        <dbl>  <dbl>  <dbl> <dbl> <dbl>    <dbl>    <dbl>
1 b_count[1] 0.00837 0.0782 -0.203 0.215  1.00     373.     197.

Full parameter list saved to: tasks/research/fitted_models/target4_factor_ar_parameters.txt 

Model saved to: tasks/research/fitted_models/target4_factor_ar.rds 



FITTING TARGET 5...
Validating combined Stan code...
Warning: 128 of 500 (26.0%) transitions hit the maximum treedepth limit of 10.
See https://mc-stan.org/misc/warnings for details.


===============================================================================
MODEL: target5_pw 
===============================================================================

Formula: y ~ x 
Trend Formula: trend_y ~ 1 
Family: poisson 
Response Names: y 

TOTAL PARAMETERS: 89 

--- PARAMETER CATEGORIZATION ---

Fixed Effects (b_*): 2 
  Examples: b_Intercept, b_Intercept_trend 

Trend Parameters (*_trend): 62 
  Examples: Intercept_trend, k_trend[1], m_trend[1], delta_trend[1,1], delta_trend[2,1], delta_trend[3,1], delta_trend[4,1], delta_trend[5,1], delta_trend[6,1], delta_trend[7,1] 

Latent States (trend[*], lv_trend[*]): 48 
  (Not shown - too many)

--- POSTERIOR::SUMMARISE_DRAWS() COLUMN NAMING ---

Probability: 0.90 (quantiles: 0.0500, 0.9500)
  Column names: variable, mean, sd, q5, q95, rhat, ess_bulk, ess_tail 
  Example (first parameter):
# A tibble: 1 × 8
  variable   mean     sd      q5   q95  rhat ess_bulk ess_tail
  <chr>     <dbl>  <dbl>   <dbl> <dbl> <dbl>    <dbl>    <dbl>
1 b[1]     0.0122 0.0673 -0.0988 0.124 0.998     533.     384.

Probability: 0.95 (quantiles: 0.0250, 0.9750)
  Column names: variable, mean, sd, q2.5, q97.5, rhat, ess_bulk, ess_tail 
  Example (first parameter):
# A tibble: 1 × 8
  variable   mean     sd   q2.5 q97.5  rhat ess_bulk ess_tail
  <chr>     <dbl>  <dbl>  <dbl> <dbl> <dbl>    <dbl>    <dbl>
1 b[1]     0.0122 0.0673 -0.117 0.138 0.998     533.     384.

Probability: 0.99 (quantiles: 0.0050, 0.9950)
  Column names: variable, mean, sd, q0.5, q99.5, rhat, ess_bulk, ess_tail 
  Example (first parameter):
# A tibble: 1 × 8
  variable   mean     sd   q0.5 q99.5  rhat ess_bulk ess_tail
  <chr>     <dbl>  <dbl>  <dbl> <dbl> <dbl>    <dbl>    <dbl>
1 b[1]     0.0122 0.0673 -0.163 0.208 0.998     533.     384.

Full parameter list saved to: tasks/research/fitted_models/target5_pw_parameters.txt 

Model saved to: tasks/research/fitted_models/target5_pw.rds 


===============================================================================
RESEARCH COMPLETE
===============================================================================

Fitted Models:
  1. target1_rw.rds          - Basic RW with simple fixed effects
  2. target2_shared_rw.rds   - Multivariate with shared RW trends
  3. target3_varma.rds       - VARMA with smooths and trend formula effects
  4. target4_factor_ar.rds   - Factor model with Z matrix loadings
  5. target5_pw.rds          - Piecewise trends with changepoints

All files saved to: tasks/research/fitted_models 

Key Findings to Extract:
  1. Are smooth parameters named s_1_1 or sds_*?
  2. Are random effects r_1[ or r_[?
  3. Do multivariate families use sigma_count or sigma_y1?
  4. Does posterior::quantile2 create q2.5 or Q2.5?
  5. Are GP parameters named consistently?

Next Steps:
  1. Review printed output above
  2. Check parameter list files in tasks/research/fitted_models 
  3. Load .rds files in R for interactive exploration
  4. Update summary.mvgam() patterns based on findings

