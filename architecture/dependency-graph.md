# Package Dependency Map

**Generated:** 2026-01-28 16:11:59
**Package:** mvgam v2.0.0
**Commit:** cfc135c

## Summary

- **Total Files:** 65
- **Total Functions:** 654
- **Exported Functions:** 57
- **Internal Functions:** 597
- **S3 Methods:** 79
- **S3 Classes:** 32

## External Dependencies
- bayesplot
- brms
- dplyr
- generics
- ggplot2
- insight
- loo
- magrittr
- marginaleffects
- methods
- mgcv
- mvnfast
- patchwork
- posterior
- purrr
- Rcpp
- rlang
- rstan
- rstantools
- tibble

## User Interface (Exported Functions)

### Main Entry Points
- **Core Functions**: mvgam,series_to_mvgam,sim_mvgam
- **Trend Types**: AR,CAR,GP,PW,RW,VAR,ZMVN
- **Analysis Tools**: fevd,irf,lfo_cv,loo,ppc,pp_check,stability
- **Plotting Functions**: plot_mvgam_factors,plot_mvgam_fc,plot_mvgam_pterms,plot_mvgam_randomeffects,plot_mvgam_resids,plot_mvgam_series,plot_mvgam_smooth,plot_mvgam_trend,plot_mvgam_uncertainty

## Core Data Structures
- **mvgam object**: Fitted model with data, parameters, and predictions
- **mvgam_prefit**: Pre-compilation model structure
- **mvgam_forecast**: Forecast results with uncertainty
- **trend_param**: Trend model specifications

## File Organization & Function Locations

### Core Files
- **`R/mvgam_core.R`** (13 functions)
- **`R/series_to_mvgam.R`** (2 functions)
- **`R/sim_mvgam.R`** (5 functions)


### Stan/Modeling Files
- **`R/brms_integration.R`** (17 functions)
- **`R/make_stan.R`** (3 functions)
- **`R/mock-stanfit.R`** (6 functions)
- **`R/stan_assembly.R`** (81 functions)
- **`R/stan_polish.R`** (11 functions)


### Validation Files
- **`R/validations.R`** (75 functions)


### S3 Methods Files
- **`R/add_residuals.R`** (2 functions)
- **`R/mvgam_residcor-class.R`** (4 functions)
- **`R/posterior_predict.R`** (12 functions)
- **`R/predictions.R`** (20 functions)
- **`R/predict.R`** (2 functions)
- **`R/print.mvgam.R`** (11 functions)
- **`R/residual_cor.R`** (3 functions)
- **`R/residuals.mvgam.R`** (1 functions)
- **`R/summary.mvgam.R`** (24 functions)


### Plotting Files
- **`R/mcmc_plot.mvgam.R`** (1 functions)
- **`R/plot_mvgam_factors.R`** (1 functions)
- **`R/plot_mvgam_fc.R`** (2 functions)
- **`R/plot_mvgam_pterms.R`** (1 functions)
- **`R/plot.mvgam.R`** (2 functions)
- **`R/plot_mvgam_randomeffects.R`** (1 functions)
- **`R/plot_mvgam_resids.R`** (1 functions)
- **`R/plot_mvgam_series.R`** (6 functions)
- **`R/plot_mvgam_smooth.R`** (1 functions)
- **`R/plot_mvgam_trend.R`** (1 functions)
- **`R/plot_mvgam_uncertainty.R`** (2 functions)


### Utilities Files
- **`R/globals.R`** (0 functions)
- **`R/utils-pipe.R`** (0 functions)


### Data Files
- **`R/all_neon_tick_data.R`** (0 functions)
- **`R/as.data.frame.mvgam.R`** (10 functions)
- **`R/portal_data.R`** (0 functions)


### Other Files
- **`R/backends.R`** (26 functions)
- **`R/cpp_funs.R`** (0 functions)
- **`R/dynamic.R`** (1 functions)
- **`R/ensemble.R`** (4 functions)
- **`R/fevd.mvgam.R`** (4 functions)
- **`R/glm_analysis.R`** (27 functions)
- **`R/how_to_cite.R`** (3 functions)
- **`R/index-mvgam.R`** (6 functions)
- **`R/irf.mvgam.R`** (5 functions)
- **`R/lfo_cv.mvgam.R`** (7 functions)
- **`R/loo.mvgam.R`** (6 functions)
- **`R/lv_correlations.R`** (1 functions)
- **`R/monotonic.R`** (5 functions)
- **`R/mu_expression_analysis.R`** (26 functions)
- **`R/mvgam-class.R`** (0 functions)
- **`R/mvgam_fevd-class.R`** (3 functions)
- **`R/mvgam_forecast-class.R`** (1 functions)
- **`R/mvgam_irf-class.R`** (2 functions)
- **`R/mvgam-package.R`** (0 functions)
- **`R/ordinate.jsdgam.R`** (2 functions)
- **`R/pairs.mvgam.R`** (1 functions)
- **`R/posterior_epred.R`** (78 functions)
- **`R/posterior_linpred.R`** (2 functions)
- **`R/ppc.mvgam.R`** (5 functions)
- **`R/priors.R`** (28 functions)
- **`R/RcppExports.R`** (3 functions)
- **`R/sample_innovations.R`** (16 functions)
- **`R/stability.R`** (2 functions)
- **`R/tidier_methods.R`** (3 functions)
- **`R/trend_system.R`** (64 functions)
- **`R/zzz.R`** (2 functions)


## Function Dependencies

### Forward Dependencies (Calls)
- **AR()** → create_mvgam_trend
- **CAR()** → create_mvgam_trend
- **GP()** → AR,deparse0,RW
- **PW()** → create_mvgam_trend
- **RW()** → create_mvgam_trend,validate_mvgam_trend
- **VAR()** → create_mvgam_trend
- **ZMVN()** → create_mvgam_trend
- **add_all_gp_contributions()** → approx_gp_pred,detect_gp_kernel,detect_gp_terms,GP
- **add_consistent_dispatch_metadata()** → get_trend_dispatch_function
- **add_hierarchical_support()** → append_if_not_null,ensure_registry_initialized,extract_hierarchical_info,generate_hierarchical_correlation_model,generate_hierarchical_correlation_parameters,generate_hierarchical_data_structures,generate_hierarchical_functions,list_trend_types
- **apply_mvgam_trend_defaults()** → generate_forecast_metadata,generate_monitor_params,generate_summary_labels,get_default_validation_rules,get_mvgam_trend_defaults
- **apply_response_suffix_to_stanvars()** → apply_suffix_to_name,apply_suffix_to_stan_code
- **apply_validation_rules()** → is_multivariate_trend_specs,process_trend_validation_rules
- **approx_gp_pred()** → compute_spd_vectorized
- **as_one_logical()** → deparse0
- **auto_register_trend_types()** → register_trend_type,validate_trend_properties
- **build_ar_prior_spec()** → AR
- **compute_spd_vectorized()** → spd_gp_exp_quad,spd_gp_matern32,spd_gp_matern52
- **create_mvgam_from_combined_fit()** → extract_mvgam_components,setup_brms_lightweight
- **create_mvgam_trend()** → add_consistent_dispatch_metadata,apply_mvgam_trend_defaults,deparse0,process_arg,validate_mvgam_trend
- **create_trend_parameter_prior()** → get_default_trend_parameter_prior
- **custom_trend()** → validate_mvgam_trend
- **deduplicate_stan_functions()** → extract_stan_functions_block,parse_stan_functions,reconstruct_functions_block,remove_duplicate_functions,replace_stan_functions_block
- **detect_glm_usage()** → add_hierarchical_support,analyze_stan,append_if_not_null,apply_correct_transformation_order,apply_response_suffix_to_stanvars,apply_safe_parameter_replacement,AR,calculate_car_time_distances,CAR,combine_stanvars,convert_glm_to_standard_form,create_times_trend_matrix,ensure_registry_initialized,extract_and_rename_stan_blocks,extract_and_rename_standata_objects,extract_computed_variables,extract_dependencies_from_declaration,extract_hierarchical_info,extract_mapping_arrays,extract_mu_construction_with_classification,extract_multivariate_standata,extract_non_likelihood_from_model_block,extract_response_names_from_brmsfit,extract_stan_block_content,extract_stan_functions_block,extract_stan_identifiers,extract_time_series_dimensions,extract_univariate_standata,filter_block_content,filter_renameable_identifiers,find_prior_only_insertion_point,find_stan_block,find_trend_computation_end,find_variable_declarations,generate_ar_trend_stanvars,generate_car_trend_stanvars,generate_common_trend_data,generate_factor_model,generate_hierarchical_correlation_model,generate_hierarchical_correlation_parameters,generate_hierarchical_data_structures,generate_hierarchical_functions,generate_innovation_model,generate_matrix_z_multiblock_stanvars,generate_matrix_z_parameters,generate_matrix_z_tdata,generate_obs_trend_mapping,generate_pw_trend_stanvars,generate_rw_trend_stanvars,generate_shared_innovation_stanvars,generate_times_trend_matrices,generate_trend_computation_tparameters,generate_trend_injection_code,generate_trend_priors_stanvar,generate_var_trend_stanvars,generate_zmvn_trend_stanvars,get_prior,get_stan_reserved_words,get_trend_parameter_prior,handle_nonlinear_trend_injection,handle_response_trend_injection,inject_trend_into_linear_predictor,insert_after_mu_lines_in_model_block,is_multivariate_brmsfit,list_trend_types,normalize_function_body,normalize_function_signature,parse_stan_functions,process_variable,PW,reconstruct_functions_block,reconstruct_mu_trend_with_renamed_vars,register_core_trends,remove_duplicate_functions,rename_parameters_in_block,replace_stan_functions_block,RW,should_include_in_transformed_parameters,transform_glm_call,transform_glm_code,validate_mapping_arrays,validate_no_factor_hierarchical,VAR,ZMVN
- **dispatch_validation_rule()** → get_validation_rule_dispatch_table
- **ensure_mvgam_variables()** → create_multivariate_series,validate_prediction_factor_levels
- **ensure_registry_initialized()** → is_registry_initialized,register_core_trends
- **eval_silent()** → as_one_logical,is_try_error
- **eval_trend_constructor()** → is.mvgam_trend
- **evaluate_param_conditions()** → is.trend_param
- **extract_and_rename_stan_blocks()** → combine_stanvars,extract_computed_variables,extract_mu_construction_with_classification,extract_non_likelihood_from_model_block,extract_stan_block_content,filter_block_content,find_variable_declarations,parse_stan_functions,reconstruct_mu_trend_with_renamed_vars,rename_parameters_in_block
- **extract_and_rename_standata_objects()** → combine_stanvars,extract_multivariate_standata,extract_univariate_standata
- **extract_and_rename_trend_parameters()** → combine_stanvars,extract_and_rename_stan_blocks,extract_and_rename_standata_objects,extract_response_names_from_brmsfit,generate_times_trend_matrices,is_multivariate_brmsfit
- **extract_and_validate_trend_components()** → ensure_mvgam_variables,extract_time_series_dimensions,extract_trend_data,is_multivariate_trend_specs,parse_trend_formula,validate_time_series_for_trends
- **extract_component_linpred()** → create_mock_stanfit,extract_linpred_from_prep,extract_obs_parameters,extract_trend_parameters,prepare_predictions.mock_stanfit,validate_prediction_factor_levels
- **extract_computed_variables()** → get_stan_reserved_words
- **extract_dependencies_from_declaration()** → extract_stan_identifiers,get_stan_reserved_words
- **extract_linpred_from_prep()** → extract_linpred_multivariate,extract_linpred_univariate
- **extract_linpred_multivariate()** → add_all_gp_contributions,extract_linpred_nonlinear,has_nlpars,monotonic_pred,smooth_fixed_pred,smooth_random_pred
- **extract_linpred_univariate()** → add_all_gp_contributions,extract_linpred_nonlinear,has_nlpars,monotonic_pred,population_random_pred,smooth_fixed_pred,smooth_random_pred
- **extract_multivariate_standata()** → combine_stanvars
- **extract_mvbind_responses()** → extract_variable_name
- **extract_mvgam_components()** → extract_series_information,extract_time_information,extract_trend_component_info
- **extract_non_likelihood_from_model_block()** → apply_safe_parameter_replacement,combine_stanvars,create_times_trend_matrix,extract_computed_variables,extract_multivariate_standata,extract_stan_block_content,extract_stan_functions_block,extract_stan_identifiers,extract_time_series_dimensions,extract_univariate_standata,filter_block_content,filter_renameable_identifiers,get_stan_reserved_words,normalize_function_body,normalize_function_signature,parse_stan_functions,reconstruct_functions_block,remove_duplicate_functions,replace_stan_functions_block
- **extract_nonlinear_components()** → parse_nonlinear_manually
- **extract_prior_from_setup()** → get_prior
- **extract_prior_string()** → get_best_prior_match
- **extract_regular_terms()** → mvgam_trend_pattern
- **extract_response_names()** → extract_mvbind_responses
- **extract_response_trends()** → validate_multivariate_trend_constraints
- **extract_stan_block_content()** → apply_safe_parameter_replacement,combine_stanvars,create_times_trend_matrix,extract_computed_variables,extract_multivariate_standata,extract_stan_functions_block,extract_stan_identifiers,extract_time_series_dimensions,extract_univariate_standata,filter_renameable_identifiers,get_stan_reserved_words,normalize_function_body,normalize_function_signature,parse_stan_functions,reconstruct_functions_block,remove_duplicate_functions,replace_stan_functions_block
- **extract_stan_functions_block()** → normalize_function_body,normalize_function_signature
- **extract_stan_identifiers()** → extract_computed_variables
- **extract_time_series_dimensions()** → filter_required_variables,generate_obs_trend_mapping,get_series_for_grouping,get_time_for_grouping,validate_regular_time_intervals,validate_required_variables
- **extract_trend_data()** → ensure_mvgam_variables,extract_and_validate_trend_components,extract_factor_levels,get_series_for_grouping,get_time_for_grouping,has_mvgam_variables,remove_mvgam_variables
- **extract_trend_priors()** → generate_trend_priors,parse_trend_formula
- **extract_trend_stanvars_from_setup()** → combine_stanvars,detect_glm_usage,extract_and_rename_trend_parameters,extract_hierarchical_info,extract_time_series_dimensions,generate_trend_specific_stanvars
- **extract_univariate_standata()** → combine_stanvars,filter_renameable_identifiers
- **filter_block_content()** → apply_safe_parameter_replacement,combine_stanvars,create_times_trend_matrix,extract_computed_variables,extract_multivariate_standata,extract_stan_block_content,extract_stan_functions_block,extract_stan_identifiers,extract_time_series_dimensions,extract_univariate_standata,filter_renameable_identifiers,get_stan_reserved_words,normalize_function_body,normalize_function_signature,parse_stan_functions,reconstruct_functions_block,remove_duplicate_functions,replace_stan_functions_block
- **filter_renameable_identifiers()** → get_stan_reserved_words
- **find_prior_only_insertion_point()** → analyze_stan,apply_correct_transformation_order,convert_glm_to_standard_form,detect_glm_usage,extract_mapping_arrays,find_stan_block,find_trend_computation_end,generate_obs_trend_mapping,generate_trend_injection_code,handle_nonlinear_trend_injection,handle_response_trend_injection,inject_trend_into_linear_predictor,insert_after_mu_lines_in_model_block,transform_glm_call,transform_glm_code,validate_mapping_arrays
- **find_stan_block()** → add_hierarchical_support,analyze_stan,append_if_not_null,apply_correct_transformation_order,apply_response_suffix_to_stanvars,apply_safe_parameter_replacement,AR,calculate_car_time_distances,CAR,combine_stanvars,convert_glm_to_standard_form,create_times_trend_matrix,detect_glm_usage,ensure_registry_initialized,extract_and_rename_stan_blocks,extract_and_rename_standata_objects,extract_computed_variables,extract_dependencies_from_declaration,extract_hierarchical_info,extract_mapping_arrays,extract_mu_construction_with_classification,extract_multivariate_standata,extract_non_likelihood_from_model_block,extract_response_names_from_brmsfit,extract_stan_block_content,extract_stan_functions_block,extract_stan_identifiers,extract_time_series_dimensions,extract_univariate_standata,filter_block_content,filter_renameable_identifiers,find_prior_only_insertion_point,find_trend_computation_end,find_variable_declarations,generate_ar_trend_stanvars,generate_car_trend_stanvars,generate_common_trend_data,generate_factor_model,generate_hierarchical_correlation_model,generate_hierarchical_correlation_parameters,generate_hierarchical_data_structures,generate_hierarchical_functions,generate_innovation_model,generate_matrix_z_multiblock_stanvars,generate_matrix_z_parameters,generate_matrix_z_tdata,generate_obs_trend_mapping,generate_pw_trend_stanvars,generate_rw_trend_stanvars,generate_shared_innovation_stanvars,generate_times_trend_matrices,generate_trend_computation_tparameters,generate_trend_injection_code,generate_trend_priors_stanvar,generate_var_trend_stanvars,generate_zmvn_trend_stanvars,get_prior,get_stan_reserved_words,get_trend_parameter_prior,handle_nonlinear_trend_injection,handle_response_trend_injection,inject_trend_into_linear_predictor,insert_after_mu_lines_in_model_block,is_multivariate_brmsfit,list_trend_types,normalize_function_body,normalize_function_signature,parse_stan_functions,process_variable,PW,reconstruct_functions_block,reconstruct_mu_trend_with_renamed_vars,register_core_trends,remove_duplicate_functions,rename_parameters_in_block,replace_stan_functions_block,RW,should_include_in_transformed_parameters,transform_glm_call,transform_glm_code,validate_mapping_arrays,validate_no_factor_hierarchical,VAR,ZMVN
- **find_trend_terms()** → dynamic,mvgam_trend_registry
- **find_variable_declarations()** → extract_dependencies_from_declaration,extract_stan_block_content,process_variable
- **fit_multiple_imputation_models()** → mvgam_single
- **generate_ar_monitor_params()** → AR
- **generate_ar_trend_stanvars()** → add_hierarchical_support,append_if_not_null,generate_factor_model,generate_matrix_z_multiblock_stanvars,generate_trend_computation_tparameters,generate_trend_priors_stanvar
- **generate_base_stancode_with_stanvars()** → sort_stanvars
- **generate_car_trend_stanvars()** → append_if_not_null,calculate_car_time_distances,generate_matrix_z_multiblock_stanvars,generate_trend_computation_tparameters,generate_trend_priors_stanvar
- **generate_combined_stancode()** → AR,deduplicate_stan_functions,detect_shared_trends,extract_response_names,extract_trend_stanvars_from_setup,generate_base_brms_standata,generate_base_stancode_with_stanvars,inject_multivariate_trends_into_linear_predictors,inject_trend_into_linear_predictor,is_multivariate_trend_specs,RW,sort_stanvars,validate_stan_code
- **generate_combined_stancode_and_data()** → generate_combined_stancode
- **generate_factor_model()** → combine_stanvars
- **generate_forecast_metadata()** → generate_forecast_required_params,normalize_trend_type
- **generate_forecast_required_params()** → filter_ar_forecast_params,filter_car_forecast_params,filter_pw_forecast_params,filter_rw_forecast_params,filter_var_forecast_params,filter_zmvn_forecast_params,generate_monitor_params
- **generate_hierarchical_correlation_model()** → combine_stanvars,get_trend_parameter_prior
- **generate_hierarchical_data_structures()** → combine_stanvars
- **generate_innovation_model()** → get_trend_parameter_prior
- **generate_matrix_z_multiblock_stanvars()** → generate_matrix_z_parameters,generate_matrix_z_tdata
- **generate_monitor_params()** → generate_ar_monitor_params,generate_car_monitor_params,generate_pw_monitor_params,generate_rw_monitor_params,generate_var_monitor_params,normalize_trend_type
- **generate_obs_trend_mapping()** → extract_time_series_dimensions,filter_required_variables,get_series_for_grouping,get_time_for_grouping,validate_required_variables
- **generate_parameter_label()** → AR,CAR
- **generate_pw_trend_stanvars()** → append_if_not_null,generate_matrix_z_multiblock_stanvars,generate_trend_computation_tparameters,generate_trend_priors_stanvar
- **generate_rw_trend_stanvars()** → append_if_not_null,generate_factor_model,generate_matrix_z_multiblock_stanvars,generate_trend_computation_tparameters,generate_trend_priors_stanvar
- **generate_shared_innovation_stanvars()** → add_hierarchical_support
- **generate_summary_labels()** → generate_monitor_params,generate_parameter_label,normalize_trend_type
- **generate_times_trend_matrices()** → combine_stanvars,create_times_trend_matrix,extract_time_series_dimensions
- **generate_trend_priors()** → create_empty_brmsprior,generate_trend_priors_from_monitor_params,setup_brms_lightweight
- **generate_trend_priors_from_monitor_params()** → create_empty_brmsprior,create_trend_parameter_prior
- **generate_trend_priors_stanvar()** → get_trend_parameter_prior
- **generate_trend_specific_stanvars()** → apply_response_suffix_to_stanvars,combine_stanvars,extract_hierarchical_info,generate_common_trend_data,generate_innovation_model,generate_shared_innovation_stanvars,register_core_trends,validate_no_factor_hierarchical
- **generate_var_trend_stanvars()** → add_hierarchical_support,append_if_not_null,extract_hierarchical_info,generate_factor_model,generate_hierarchical_correlation_model,generate_hierarchical_correlation_parameters,generate_hierarchical_data_structures,generate_hierarchical_functions,generate_matrix_z_multiblock_stanvars,generate_trend_computation_tparameters,generate_trend_priors_stanvar
- **generate_zmvn_trend_stanvars()** → add_hierarchical_support,append_if_not_null,generate_factor_model,generate_matrix_z_multiblock_stanvars,generate_trend_computation_tparameters
- **get_all_mvgam_trend_parameters()** → ensure_registry_initialized,generate_monitor_params,is_multivariate_trend_specs
- **get_default_trend_parameter_prior()** → get_parameter_type_default_prior
- **get_prior.brmsformula()** → get_prior
- **get_prior.default()** → get_prior
- **get_prior.formula()** → get_prior
- **get_prior.mvgam_formula()** → combine_obs_trend_priors,extract_and_validate_trend_components,extract_response_names,extract_trend_priors,get_prior,has_embedded_families,is_multivariate_trend_specs,parse_multivariate_trends
- **get_series_for_grouping()** → ensure_mvgam_variables
- **get_time_for_grouping()** → ensure_mvgam_variables
- **get_trend_parameter_prior()** → extract_prior_string,get_parameter_type_default_prior,map_prior_to_stan_string
- **handle_nonlinear_model()** → determine_trend_injection_point,extract_nonlinear_components,is_nonlinear_formula,validate_nonlinear_trend_compatibility
- **handle_response_trend_injection()** → apply_correct_transformation_order,find_stan_block
- **inject_multivariate_trends_into_linear_predictors()** → detect_glm_usage,find_prior_only_insertion_point,find_stan_block,find_trend_computation_end
- **inject_trend_into_linear_predictor()** → extract_mapping_arrays,generate_trend_injection_code,transform_glm_code,validate_mapping_arrays
- **insert_after_mu_lines_in_model_block()** → analyze_stan,apply_correct_transformation_order,convert_glm_to_standard_form,detect_glm_usage,find_stan_block,handle_nonlinear_trend_injection
- **is_multivariate_formula()** → has_mvbind_response,is_nonlinear_formula
- **map_trend_priors()** → extract_prior_string,get_trend_prior_spec,map_prior_to_stan_string,patterns
- **monotonic_pred()** → validate_monotonic_indices
- **mvgam()** → mvgam_multiple,mvgam_single
- **mvgam_formula()** → validate_obs_formula_brms,validate_single_trend_formula
- **mvgam_multiple()** → fit_multiple_imputation_models,pool_mvgam_fits,validate_multiple_imputation_datasets
- **mvgam_single()** → compile_model,create_mvgam_from_combined_fit,fit_model,generate_stan_components_mvgam_formula,mvgam_formula,parse_model,validate_opencl,validate_silent,validate_threads
- **mvgam_trend_choices()** → mvgam_trend_registry
- **mvgam_trend_pattern()** → mvgam_trend_registry
- **parse_base_formula_safe()** → remove_trend_expressions
- **parse_model_cmdstanr()** → eval_silent
- **parse_multivariate_trends()** → cache_formula_latent_params,create_trend_base_formula,extract_response_names,extract_response_trends,is_multivariate_formula,parse_trend_formula,validate_trend_formula_brms
- **parse_nonlinear_manually()** → extract_response_from_formula
- **parse_stan_functions()** → normalize_function_body,normalize_function_signature
- **parse_trend_formula()** → dynamic,eval_trend_constructor,mvgam_trend_registry,parse_base_formula_safe,validate_trend_components,ZMVN
- **process_arg()** → deparse0
- **process_capacity_parameter()** → validate_required_variables
- **process_trend_params()** → evaluate_param_conditions,is.trend_param
- **process_trend_validation_rules()** → dispatch_validation_rule
- **process_variable()** → extract_dependencies_from_declaration,extract_stan_block_content
- **reconstruct_mu_trend_with_renamed_vars()** → find_variable_declarations,should_include_in_transformed_parameters
- **register_core_trends()** → auto_register_trend_types
- **register_custom_trend()** → register_trend_type
- **register_trend_type()** → get_default_incompatibility_reason
- **remove_duplicate_functions()** → normalize_function_body,normalize_function_signature
- **remove_trend_expressions()** → is_trend_term
- **remove_trend_suffix_from_priors()** → get_all_mvgam_trend_parameters
- **rename_parameters_in_block()** → apply_safe_parameter_replacement,extract_stan_identifiers,filter_renameable_identifiers
- **setup_brms_lightweight()** → extract_brmsterms_from_setup,extract_prior_from_setup,extract_trend_data,parse_multivariate_trends,should_trend_formula_have_intercept,validate_brms_formula,validate_setup_components
- **should_trend_formula_have_intercept()** → AR,RW
- **spd_gp_exp_quad()** → prepare_spd_inputs
- **spd_gp_matern32()** → prepare_spd_inputs
- **spd_gp_matern52()** → prepare_spd_inputs
- **transform_glm_calls_post_processing()** → transform_glm_call
- **validate_and_process_trend_parameters()** → process_capacity_parameter,process_lag_parameters
- **validate_autocor_separation()** → validate_obs_formula_brms,validate_trend_formula_brms
- **validate_bf_trend_formula()** → extract_all_bf_formulas,validate_single_trend_formula
- **validate_brms_formula()** → validate_obs_formula_brms
- **validate_grouping_structure()** → validate_factor_levels
- **validate_list_trend_formula()** → AR,RW,validate_single_trend_formula
- **validate_mapping_arrays()** → generate_obs_trend_mapping
- **validate_multiple_imputation_datasets()** → validate_missing_patterns
- **validate_multivariate_trend_constraints()** → parse_trend_formula
- **validate_obs_formula_brms()** → formula2str_mvgam,get_trend_validation_patterns,mvgam,RW,validate_exact_gp_usage
- **validate_prediction_factor_levels()** → extract_factor_levels
- **validate_regular_time_intervals()** → CAR
- **validate_series_time()** → validate_multivariate_series_time,validate_univariate_series_time
- **validate_single_trend_formula()** → AR,formula2str_mvgam,RW,validate_exact_gp_usage,validate_trend_formula_restrictions
- **validate_stan_code()** → parse_model_cmdstanr
- **validate_stan_code_structure()** → all_times_avail,create_multivariate_series,deparse0,ensure_mvgam_variables,eval_silent,extract_and_validate_trend_components,extract_factor_levels,extract_time_series_dimensions,extract_trend_data,get_series_for_grouping,get_time_for_grouping,has_mvgam_variables,is_multivariate_trend_specs,is_trend_term,parse_model_cmdstanr,parse_trend_formula,process_capacity_parameter,process_lag_parameters,remove_mvgam_variables,remove_trend_expressions,validate_factor_levels,validate_multivariate_series_time,validate_prediction_factor_levels,validate_required_variables,validate_time_series_for_trends,validate_univariate_series_time
- **validate_time_series_for_trends()** → ensure_mvgam_variables,extract_and_validate_trend_components,has_mvgam_variables,is_multivariate_trend_specs,validate_regular_time_intervals
- **validate_trend_formula_brms()** → validate_bf_trend_formula,validate_list_trend_formula,validate_single_trend_formula
- **validate_trend_formula_restrictions()** → AR,get_trend_validation_patterns,patterns,RW
- **validate_trend_grouping()** → filter_required_variables,validate_grouping_arguments,validate_required_variables
- **validate_trend_time_intervals()** → validate_regular_time_intervals
- **validate_univariate_series_time()** → all_times_avail,get_series_for_grouping,get_time_for_grouping,validate_factor_levels

### Reverse Dependencies (Called By)
- **AR()** ← should_trend_formula_have_intercept,build_ar_prior_spec,detect_glm_usage,find_stan_block,generate_combined_stancode,generate_ar_monitor_params,generate_parameter_label,GP,validate_list_trend_formula,validate_single_trend_formula,validate_trend_formula_restrictions
- **CAR()** ← detect_glm_usage,find_stan_block,generate_parameter_label,validate_regular_time_intervals
- **GP()** ← add_all_gp_contributions
- **PW()** ← detect_glm_usage,find_stan_block
- **RW()** ← should_trend_formula_have_intercept,detect_glm_usage,find_stan_block,generate_combined_stancode,GP,validate_list_trend_formula,validate_obs_formula_brms,validate_single_trend_formula,validate_trend_formula_restrictions
- **VAR()** ← detect_glm_usage,find_stan_block
- **ZMVN()** ← detect_glm_usage,find_stan_block,parse_trend_formula
- **add_all_gp_contributions()** ← extract_linpred_multivariate,extract_linpred_univariate
- **add_consistent_dispatch_metadata()** ← create_mvgam_trend
- **add_hierarchical_support()** ← detect_glm_usage,find_stan_block,generate_ar_trend_stanvars,generate_shared_innovation_stanvars,generate_var_trend_stanvars,generate_zmvn_trend_stanvars
- **all_times_avail()** ← validate_stan_code_structure,validate_univariate_series_time
- **analyze_stan()** ← detect_glm_usage,find_prior_only_insertion_point,find_stan_block,insert_after_mu_lines_in_model_block
- **append_if_not_null()** ← add_hierarchical_support,detect_glm_usage,find_stan_block,generate_ar_trend_stanvars,generate_car_trend_stanvars,generate_pw_trend_stanvars,generate_rw_trend_stanvars,generate_var_trend_stanvars,generate_zmvn_trend_stanvars
- **apply_correct_transformation_order()** ← detect_glm_usage,find_prior_only_insertion_point,find_stan_block,handle_response_trend_injection,insert_after_mu_lines_in_model_block
- **apply_mvgam_trend_defaults()** ← create_mvgam_trend
- **apply_response_suffix_to_stanvars()** ← detect_glm_usage,find_stan_block,generate_trend_specific_stanvars
- **apply_safe_parameter_replacement()** ← detect_glm_usage,extract_non_likelihood_from_model_block,extract_stan_block_content,filter_block_content,find_stan_block,rename_parameters_in_block
- **apply_suffix_to_name()** ← apply_response_suffix_to_stanvars
- **apply_suffix_to_stan_code()** ← apply_response_suffix_to_stanvars
- **approx_gp_pred()** ← add_all_gp_contributions
- **as_one_logical()** ← eval_silent
- **auto_register_trend_types()** ← register_core_trends
- **cache_formula_latent_params()** ← parse_multivariate_trends
- **calculate_car_time_distances()** ← detect_glm_usage,find_stan_block,generate_car_trend_stanvars
- **combine_obs_trend_priors()** ← get_prior.mvgam_formula
- **combine_stanvars()** ← detect_glm_usage,extract_and_rename_stan_blocks,extract_and_rename_standata_objects,extract_and_rename_trend_parameters,extract_multivariate_standata,extract_non_likelihood_from_model_block,extract_stan_block_content,extract_trend_stanvars_from_setup,extract_univariate_standata,filter_block_content,find_stan_block,generate_factor_model,generate_hierarchical_correlation_model,generate_hierarchical_data_structures,generate_times_trend_matrices,generate_trend_specific_stanvars
- **compile_model()** ← mvgam_single
- **compute_spd_vectorized()** ← approx_gp_pred
- **convert_glm_to_standard_form()** ← detect_glm_usage,find_prior_only_insertion_point,find_stan_block,insert_after_mu_lines_in_model_block
- **create_empty_brmsprior()** ← generate_trend_priors,generate_trend_priors_from_monitor_params
- **create_mock_stanfit()** ← extract_component_linpred
- **create_multivariate_series()** ← ensure_mvgam_variables,validate_stan_code_structure
- **create_mvgam_from_combined_fit()** ← mvgam_single
- **create_mvgam_trend()** ← AR,CAR,PW,RW,VAR,ZMVN
- **create_times_trend_matrix()** ← detect_glm_usage,extract_non_likelihood_from_model_block,extract_stan_block_content,filter_block_content,find_stan_block,generate_times_trend_matrices
- **create_trend_base_formula()** ← parse_multivariate_trends
- **create_trend_parameter_prior()** ← generate_trend_priors_from_monitor_params
- **deduplicate_stan_functions()** ← generate_combined_stancode
- **deparse0()** ← create_mvgam_trend,GP,process_arg,as_one_logical,validate_stan_code_structure
- **detect_glm_usage()** ← extract_trend_stanvars_from_setup,find_prior_only_insertion_point,find_stan_block,inject_multivariate_trends_into_linear_predictors,insert_after_mu_lines_in_model_block
- **detect_gp_kernel()** ← add_all_gp_contributions
- **detect_gp_terms()** ← add_all_gp_contributions
- **detect_shared_trends()** ← generate_combined_stancode
- **determine_trend_injection_point()** ← handle_nonlinear_model
- **dispatch_validation_rule()** ← process_trend_validation_rules
- **dynamic()** ← find_trend_terms,parse_trend_formula
- **ensure_mvgam_variables()** ← extract_and_validate_trend_components,extract_trend_data,get_series_for_grouping,get_time_for_grouping,validate_stan_code_structure,validate_time_series_for_trends
- **ensure_registry_initialized()** ← get_all_mvgam_trend_parameters,add_hierarchical_support,detect_glm_usage,find_stan_block
- **eval_silent()** ← parse_model_cmdstanr,validate_stan_code_structure
- **eval_trend_constructor()** ← parse_trend_formula
- **evaluate_param_conditions()** ← process_trend_params
- **extract_all_bf_formulas()** ← validate_bf_trend_formula
- **extract_and_rename_stan_blocks()** ← detect_glm_usage,extract_and_rename_trend_parameters,find_stan_block
- **extract_and_rename_standata_objects()** ← detect_glm_usage,extract_and_rename_trend_parameters,find_stan_block
- **extract_and_rename_trend_parameters()** ← extract_trend_stanvars_from_setup
- **extract_and_validate_trend_components()** ← get_prior.mvgam_formula,extract_trend_data,validate_stan_code_structure,validate_time_series_for_trends
- **extract_brmsterms_from_setup()** ← setup_brms_lightweight
- **extract_computed_variables()** ← detect_glm_usage,extract_and_rename_stan_blocks,extract_non_likelihood_from_model_block,extract_stan_block_content,extract_stan_identifiers,filter_block_content,find_stan_block
- **extract_dependencies_from_declaration()** ← detect_glm_usage,find_stan_block,find_variable_declarations,process_variable
- **extract_factor_levels()** ← extract_trend_data,validate_prediction_factor_levels,validate_stan_code_structure
- **extract_hierarchical_info()** ← add_hierarchical_support,detect_glm_usage,extract_trend_stanvars_from_setup,find_stan_block,generate_trend_specific_stanvars,generate_var_trend_stanvars
- **extract_linpred_from_prep()** ← extract_component_linpred
- **extract_linpred_multivariate()** ← extract_linpred_from_prep
- **extract_linpred_nonlinear()** ← extract_linpred_multivariate,extract_linpred_univariate
- **extract_linpred_univariate()** ← extract_linpred_from_prep
- **extract_mapping_arrays()** ← detect_glm_usage,find_prior_only_insertion_point,find_stan_block,inject_trend_into_linear_predictor
- **extract_mu_construction_with_classification()** ← detect_glm_usage,extract_and_rename_stan_blocks,find_stan_block
- **extract_multivariate_standata()** ← detect_glm_usage,extract_and_rename_standata_objects,extract_non_likelihood_from_model_block,extract_stan_block_content,filter_block_content,find_stan_block
- **extract_mvbind_responses()** ← extract_response_names
- **extract_mvgam_components()** ← create_mvgam_from_combined_fit
- **extract_non_likelihood_from_model_block()** ← detect_glm_usage,extract_and_rename_stan_blocks,find_stan_block
- **extract_nonlinear_components()** ← handle_nonlinear_model
- **extract_obs_parameters()** ← extract_component_linpred
- **extract_prior_from_setup()** ← setup_brms_lightweight
- **extract_prior_string()** ← get_trend_parameter_prior,map_trend_priors
- **extract_response_from_formula()** ← parse_nonlinear_manually
- **extract_response_names()** ← parse_multivariate_trends,get_prior.mvgam_formula,generate_combined_stancode
- **extract_response_names_from_brmsfit()** ← detect_glm_usage,extract_and_rename_trend_parameters,find_stan_block
- **extract_response_trends()** ← parse_multivariate_trends
- **extract_series_information()** ← extract_mvgam_components
- **extract_stan_block_content()** ← detect_glm_usage,extract_and_rename_stan_blocks,extract_non_likelihood_from_model_block,filter_block_content,find_stan_block,find_variable_declarations,process_variable
- **extract_stan_functions_block()** ← deduplicate_stan_functions,detect_glm_usage,extract_non_likelihood_from_model_block,extract_stan_block_content,filter_block_content,find_stan_block
- **extract_stan_identifiers()** ← detect_glm_usage,extract_dependencies_from_declaration,extract_non_likelihood_from_model_block,extract_stan_block_content,filter_block_content,find_stan_block,rename_parameters_in_block
- **extract_time_information()** ← extract_mvgam_components
- **extract_time_series_dimensions()** ← detect_glm_usage,extract_non_likelihood_from_model_block,extract_stan_block_content,extract_trend_stanvars_from_setup,filter_block_content,find_stan_block,generate_times_trend_matrices,extract_and_validate_trend_components,generate_obs_trend_mapping,validate_stan_code_structure
- **extract_trend_component_info()** ← extract_mvgam_components
- **extract_trend_data()** ← setup_brms_lightweight,extract_and_validate_trend_components,validate_stan_code_structure
- **extract_trend_parameters()** ← extract_component_linpred
- **extract_trend_priors()** ← get_prior.mvgam_formula
- **extract_trend_stanvars_from_setup()** ← generate_combined_stancode
- **extract_univariate_standata()** ← detect_glm_usage,extract_and_rename_standata_objects,extract_non_likelihood_from_model_block,extract_stan_block_content,filter_block_content,find_stan_block
- **extract_variable_name()** ← extract_mvbind_responses
- **filter_ar_forecast_params()** ← generate_forecast_required_params
- **filter_block_content()** ← detect_glm_usage,extract_and_rename_stan_blocks,extract_non_likelihood_from_model_block,find_stan_block
- **filter_car_forecast_params()** ← generate_forecast_required_params
- **filter_pw_forecast_params()** ← generate_forecast_required_params
- **filter_renameable_identifiers()** ← detect_glm_usage,extract_non_likelihood_from_model_block,extract_stan_block_content,extract_univariate_standata,filter_block_content,find_stan_block,rename_parameters_in_block
- **filter_required_variables()** ← extract_time_series_dimensions,generate_obs_trend_mapping,validate_trend_grouping
- **filter_rw_forecast_params()** ← generate_forecast_required_params
- **filter_var_forecast_params()** ← generate_forecast_required_params
- **filter_zmvn_forecast_params()** ← generate_forecast_required_params
- **find_prior_only_insertion_point()** ← detect_glm_usage,find_stan_block,inject_multivariate_trends_into_linear_predictors
- **find_stan_block()** ← detect_glm_usage,find_prior_only_insertion_point,handle_response_trend_injection,inject_multivariate_trends_into_linear_predictors,insert_after_mu_lines_in_model_block
- **find_trend_computation_end()** ← detect_glm_usage,find_prior_only_insertion_point,find_stan_block,inject_multivariate_trends_into_linear_predictors
- **find_variable_declarations()** ← detect_glm_usage,extract_and_rename_stan_blocks,find_stan_block,reconstruct_mu_trend_with_renamed_vars
- **fit_model()** ← mvgam_single
- **fit_multiple_imputation_models()** ← mvgam_multiple
- **formula2str_mvgam()** ← validate_obs_formula_brms,validate_single_trend_formula
- **generate_ar_monitor_params()** ← generate_monitor_params
- **generate_ar_trend_stanvars()** ← detect_glm_usage,find_stan_block
- **generate_base_brms_standata()** ← generate_combined_stancode
- **generate_base_stancode_with_stanvars()** ← generate_combined_stancode
- **generate_car_monitor_params()** ← generate_monitor_params
- **generate_car_trend_stanvars()** ← detect_glm_usage,find_stan_block
- **generate_combined_stancode()** ← generate_combined_stancode_and_data
- **generate_common_trend_data()** ← detect_glm_usage,find_stan_block,generate_trend_specific_stanvars
- **generate_factor_model()** ← detect_glm_usage,find_stan_block,generate_ar_trend_stanvars,generate_rw_trend_stanvars,generate_var_trend_stanvars,generate_zmvn_trend_stanvars
- **generate_forecast_metadata()** ← apply_mvgam_trend_defaults
- **generate_forecast_required_params()** ← generate_forecast_metadata
- **generate_hierarchical_correlation_model()** ← add_hierarchical_support,detect_glm_usage,find_stan_block,generate_var_trend_stanvars
- **generate_hierarchical_correlation_parameters()** ← add_hierarchical_support,detect_glm_usage,find_stan_block,generate_var_trend_stanvars
- **generate_hierarchical_data_structures()** ← add_hierarchical_support,detect_glm_usage,find_stan_block,generate_var_trend_stanvars
- **generate_hierarchical_functions()** ← add_hierarchical_support,detect_glm_usage,find_stan_block,generate_var_trend_stanvars
- **generate_innovation_model()** ← detect_glm_usage,find_stan_block,generate_trend_specific_stanvars
- **generate_matrix_z_multiblock_stanvars()** ← detect_glm_usage,find_stan_block,generate_ar_trend_stanvars,generate_car_trend_stanvars,generate_pw_trend_stanvars,generate_rw_trend_stanvars,generate_var_trend_stanvars,generate_zmvn_trend_stanvars
- **generate_matrix_z_parameters()** ← detect_glm_usage,find_stan_block,generate_matrix_z_multiblock_stanvars
- **generate_matrix_z_tdata()** ← detect_glm_usage,find_stan_block,generate_matrix_z_multiblock_stanvars
- **generate_monitor_params()** ← get_all_mvgam_trend_parameters,apply_mvgam_trend_defaults,generate_forecast_required_params,generate_summary_labels
- **generate_obs_trend_mapping()** ← detect_glm_usage,find_prior_only_insertion_point,find_stan_block,validate_mapping_arrays,extract_time_series_dimensions
- **generate_parameter_label()** ← generate_summary_labels
- **generate_pw_monitor_params()** ← generate_monitor_params
- **generate_pw_trend_stanvars()** ← detect_glm_usage,find_stan_block
- **generate_rw_monitor_params()** ← generate_monitor_params
- **generate_rw_trend_stanvars()** ← detect_glm_usage,find_stan_block
- **generate_shared_innovation_stanvars()** ← detect_glm_usage,find_stan_block,generate_trend_specific_stanvars
- **generate_stan_components_mvgam_formula()** ← mvgam_single
- **generate_summary_labels()** ← apply_mvgam_trend_defaults
- **generate_times_trend_matrices()** ← detect_glm_usage,extract_and_rename_trend_parameters,find_stan_block
- **generate_trend_computation_tparameters()** ← detect_glm_usage,find_stan_block,generate_ar_trend_stanvars,generate_car_trend_stanvars,generate_pw_trend_stanvars,generate_rw_trend_stanvars,generate_var_trend_stanvars,generate_zmvn_trend_stanvars
- **generate_trend_injection_code()** ← detect_glm_usage,find_prior_only_insertion_point,find_stan_block,inject_trend_into_linear_predictor
- **generate_trend_priors()** ← extract_trend_priors
- **generate_trend_priors_from_monitor_params()** ← generate_trend_priors
- **generate_trend_priors_stanvar()** ← detect_glm_usage,find_stan_block,generate_ar_trend_stanvars,generate_car_trend_stanvars,generate_pw_trend_stanvars,generate_rw_trend_stanvars,generate_var_trend_stanvars
- **generate_trend_specific_stanvars()** ← extract_trend_stanvars_from_setup
- **generate_var_monitor_params()** ← generate_monitor_params
- **generate_var_trend_stanvars()** ← detect_glm_usage,find_stan_block
- **generate_zmvn_trend_stanvars()** ← detect_glm_usage,find_stan_block
- **get_all_mvgam_trend_parameters()** ← remove_trend_suffix_from_priors
- **get_best_prior_match()** ← extract_prior_string
- **get_default_incompatibility_reason()** ← register_trend_type
- **get_default_trend_parameter_prior()** ← create_trend_parameter_prior
- **get_default_validation_rules()** ← apply_mvgam_trend_defaults
- **get_mvgam_trend_defaults()** ← apply_mvgam_trend_defaults
- **get_parameter_type_default_prior()** ← get_default_trend_parameter_prior,get_trend_parameter_prior
- **get_prior()** ← extract_prior_from_setup,get_prior.brmsformula,get_prior.default,get_prior.formula,get_prior.mvgam_formula,detect_glm_usage,find_stan_block
- **get_series_for_grouping()** ← extract_time_series_dimensions,extract_trend_data,generate_obs_trend_mapping,validate_stan_code_structure,validate_univariate_series_time
- **get_stan_reserved_words()** ← detect_glm_usage,extract_computed_variables,extract_dependencies_from_declaration,extract_non_likelihood_from_model_block,extract_stan_block_content,filter_block_content,filter_renameable_identifiers,find_stan_block
- **get_time_for_grouping()** ← extract_time_series_dimensions,extract_trend_data,generate_obs_trend_mapping,validate_stan_code_structure,validate_univariate_series_time
- **get_trend_dispatch_function()** ← add_consistent_dispatch_metadata
- **get_trend_parameter_prior()** ← detect_glm_usage,find_stan_block,generate_hierarchical_correlation_model,generate_innovation_model,generate_trend_priors_stanvar
- **get_trend_prior_spec()** ← map_trend_priors
- **get_trend_validation_patterns()** ← validate_obs_formula_brms,validate_trend_formula_restrictions
- **get_validation_rule_dispatch_table()** ← dispatch_validation_rule
- **handle_nonlinear_trend_injection()** ← detect_glm_usage,find_prior_only_insertion_point,find_stan_block,insert_after_mu_lines_in_model_block
- **handle_response_trend_injection()** ← detect_glm_usage,find_prior_only_insertion_point,find_stan_block
- **has_embedded_families()** ← get_prior.mvgam_formula
- **has_mvbind_response()** ← is_multivariate_formula
- **has_mvgam_variables()** ← extract_trend_data,validate_stan_code_structure,validate_time_series_for_trends
- **has_nlpars()** ← extract_linpred_multivariate,extract_linpred_univariate
- **inject_multivariate_trends_into_linear_predictors()** ← generate_combined_stancode
- **inject_trend_into_linear_predictor()** ← detect_glm_usage,find_prior_only_insertion_point,find_stan_block,generate_combined_stancode
- **insert_after_mu_lines_in_model_block()** ← detect_glm_usage,find_prior_only_insertion_point,find_stan_block
- **is.mvgam_trend()** ← eval_trend_constructor
- **is.trend_param()** ← evaluate_param_conditions,process_trend_params
- **is_multivariate_brmsfit()** ← detect_glm_usage,extract_and_rename_trend_parameters,find_stan_block
- **is_multivariate_formula()** ← parse_multivariate_trends
- **is_multivariate_trend_specs()** ← get_all_mvgam_trend_parameters,get_prior.mvgam_formula,generate_combined_stancode,apply_validation_rules,extract_and_validate_trend_components,validate_stan_code_structure,validate_time_series_for_trends
- **is_nonlinear_formula()** ← handle_nonlinear_model,is_multivariate_formula
- **is_registry_initialized()** ← ensure_registry_initialized
- **is_trend_term()** ← remove_trend_expressions,validate_stan_code_structure
- **is_try_error()** ← eval_silent
- **list_trend_types()** ← add_hierarchical_support,detect_glm_usage,find_stan_block
- **map_prior_to_stan_string()** ← get_trend_parameter_prior,map_trend_priors
- **monotonic_pred()** ← extract_linpred_multivariate,extract_linpred_univariate
- **mvgam()** ← validate_obs_formula_brms
- **mvgam_formula()** ← mvgam_single
- **mvgam_multiple()** ← mvgam
- **mvgam_single()** ← fit_multiple_imputation_models,mvgam
- **mvgam_trend_pattern()** ← extract_regular_terms
- **mvgam_trend_registry()** ← find_trend_terms,mvgam_trend_choices,mvgam_trend_pattern,parse_trend_formula
- **normalize_function_body()** ← detect_glm_usage,extract_non_likelihood_from_model_block,extract_stan_block_content,extract_stan_functions_block,filter_block_content,find_stan_block,parse_stan_functions,remove_duplicate_functions
- **normalize_function_signature()** ← detect_glm_usage,extract_non_likelihood_from_model_block,extract_stan_block_content,extract_stan_functions_block,filter_block_content,find_stan_block,parse_stan_functions,remove_duplicate_functions
- **normalize_trend_type()** ← generate_forecast_metadata,generate_monitor_params,generate_summary_labels
- **parse_base_formula_safe()** ← parse_trend_formula
- **parse_model()** ← mvgam_single
- **parse_model_cmdstanr()** ← validate_stan_code,validate_stan_code_structure
- **parse_multivariate_trends()** ← setup_brms_lightweight,get_prior.mvgam_formula
- **parse_nonlinear_manually()** ← extract_nonlinear_components
- **parse_stan_functions()** ← deduplicate_stan_functions,detect_glm_usage,extract_and_rename_stan_blocks,extract_non_likelihood_from_model_block,extract_stan_block_content,filter_block_content,find_stan_block
- **parse_trend_formula()** ← parse_multivariate_trends,extract_trend_priors,extract_and_validate_trend_components,validate_multivariate_trend_constraints,validate_stan_code_structure
- **patterns()** ← map_trend_priors,validate_trend_formula_restrictions
- **pool_mvgam_fits()** ← mvgam_multiple
- **population_random_pred()** ← extract_linpred_univariate
- **prepare_predictions.mock_stanfit()** ← extract_component_linpred
- **prepare_spd_inputs()** ← spd_gp_exp_quad,spd_gp_matern32,spd_gp_matern52
- **process_arg()** ← create_mvgam_trend
- **process_capacity_parameter()** ← validate_and_process_trend_parameters,validate_stan_code_structure
- **process_lag_parameters()** ← validate_and_process_trend_parameters,validate_stan_code_structure
- **process_trend_validation_rules()** ← apply_validation_rules
- **process_variable()** ← detect_glm_usage,find_stan_block,find_variable_declarations
- **reconstruct_functions_block()** ← deduplicate_stan_functions,detect_glm_usage,extract_non_likelihood_from_model_block,extract_stan_block_content,filter_block_content,find_stan_block
- **reconstruct_mu_trend_with_renamed_vars()** ← detect_glm_usage,extract_and_rename_stan_blocks,find_stan_block
- **register_core_trends()** ← detect_glm_usage,find_stan_block,generate_trend_specific_stanvars,ensure_registry_initialized
- **register_trend_type()** ← auto_register_trend_types,register_custom_trend
- **remove_duplicate_functions()** ← deduplicate_stan_functions,detect_glm_usage,extract_non_likelihood_from_model_block,extract_stan_block_content,filter_block_content,find_stan_block
- **remove_mvgam_variables()** ← extract_trend_data,validate_stan_code_structure
- **remove_trend_expressions()** ← parse_base_formula_safe,validate_stan_code_structure
- **rename_parameters_in_block()** ← detect_glm_usage,extract_and_rename_stan_blocks,find_stan_block
- **replace_stan_functions_block()** ← deduplicate_stan_functions,detect_glm_usage,extract_non_likelihood_from_model_block,extract_stan_block_content,filter_block_content,find_stan_block
- **setup_brms_lightweight()** ← create_mvgam_from_combined_fit,generate_trend_priors
- **should_include_in_transformed_parameters()** ← detect_glm_usage,find_stan_block,reconstruct_mu_trend_with_renamed_vars
- **should_trend_formula_have_intercept()** ← setup_brms_lightweight
- **smooth_fixed_pred()** ← extract_linpred_multivariate,extract_linpred_univariate
- **smooth_random_pred()** ← extract_linpred_multivariate,extract_linpred_univariate
- **sort_stanvars()** ← generate_base_stancode_with_stanvars,generate_combined_stancode
- **spd_gp_exp_quad()** ← compute_spd_vectorized
- **spd_gp_matern32()** ← compute_spd_vectorized
- **spd_gp_matern52()** ← compute_spd_vectorized
- **transform_glm_call()** ← detect_glm_usage,find_prior_only_insertion_point,find_stan_block,transform_glm_calls_post_processing
- **transform_glm_code()** ← detect_glm_usage,find_prior_only_insertion_point,find_stan_block,inject_trend_into_linear_predictor
- **validate_bf_trend_formula()** ← validate_trend_formula_brms
- **validate_brms_formula()** ← setup_brms_lightweight
- **validate_exact_gp_usage()** ← validate_obs_formula_brms,validate_single_trend_formula
- **validate_factor_levels()** ← validate_grouping_structure,validate_stan_code_structure,validate_univariate_series_time
- **validate_grouping_arguments()** ← validate_trend_grouping
- **validate_list_trend_formula()** ← validate_trend_formula_brms
- **validate_mapping_arrays()** ← detect_glm_usage,find_prior_only_insertion_point,find_stan_block,inject_trend_into_linear_predictor
- **validate_missing_patterns()** ← validate_multiple_imputation_datasets
- **validate_monotonic_indices()** ← monotonic_pred
- **validate_multiple_imputation_datasets()** ← mvgam_multiple
- **validate_multivariate_series_time()** ← validate_series_time,validate_stan_code_structure
- **validate_multivariate_trend_constraints()** ← extract_response_trends
- **validate_mvgam_trend()** ← create_mvgam_trend,custom_trend,RW
- **validate_no_factor_hierarchical()** ← detect_glm_usage,find_stan_block,generate_trend_specific_stanvars
- **validate_nonlinear_trend_compatibility()** ← handle_nonlinear_model
- **validate_obs_formula_brms()** ← mvgam_formula,validate_autocor_separation,validate_brms_formula
- **validate_opencl()** ← mvgam_single
- **validate_prediction_factor_levels()** ← extract_component_linpred,ensure_mvgam_variables,validate_stan_code_structure
- **validate_regular_time_intervals()** ← extract_time_series_dimensions,validate_time_series_for_trends,validate_trend_time_intervals
- **validate_required_variables()** ← extract_time_series_dimensions,generate_obs_trend_mapping,process_capacity_parameter,validate_stan_code_structure,validate_trend_grouping
- **validate_setup_components()** ← setup_brms_lightweight
- **validate_silent()** ← mvgam_single
- **validate_single_trend_formula()** ← mvgam_formula,validate_bf_trend_formula,validate_list_trend_formula,validate_trend_formula_brms
- **validate_stan_code()** ← generate_combined_stancode
- **validate_threads()** ← mvgam_single
- **validate_time_series_for_trends()** ← extract_and_validate_trend_components,validate_stan_code_structure
- **validate_trend_components()** ← parse_trend_formula
- **validate_trend_formula_brms()** ← parse_multivariate_trends,validate_autocor_separation
- **validate_trend_formula_restrictions()** ← validate_single_trend_formula
- **validate_trend_properties()** ← auto_register_trend_types
- **validate_univariate_series_time()** ← validate_series_time,validate_stan_code_structure

## Function Location Quick Reference

### Exported Functions by File
- **`R/add_residuals.R`**: add_residuals
- **`R/dynamic.R`**: dynamic
- **`R/ensemble.R`**: ensemble
- **`R/fevd.mvgam.R`**: fevd
- **`R/how_to_cite.R`**: how_to_cite
- **`R/irf.mvgam.R`**: irf
- **`R/lfo_cv.mvgam.R`**: lfo_cv
- **`R/lv_correlations.R`**: lv_correlations
- **`R/mvgam_core.R`**: mvgam, mvgam_multiple
- **`R/ordinate.jsdgam.R`**: ordinate
- **`R/plot_mvgam_factors.R`**: plot_mvgam_factors
- **`R/plot_mvgam_fc.R`**: plot_mvgam_fc
- **`R/plot_mvgam_pterms.R`**: plot_mvgam_pterms
- **`R/plot_mvgam_randomeffects.R`**: plot_mvgam_randomeffects
- **`R/plot_mvgam_resids.R`**: plot_mvgam_resids
- **`R/plot_mvgam_series.R`**: plot_mvgam_series
- **`R/plot_mvgam_smooth.R`**: plot_mvgam_smooth
- **`R/plot_mvgam_trend.R`**: plot_mvgam_trend
- **`R/plot_mvgam_uncertainty.R`**: plot_mvgam_uncertainty
- **`R/ppc.mvgam.R`**: ppc
- **`R/priors.R`**: get_prior, mvgam_formula
- **`R/residual_cor.R`**: residual_cor
- **`R/series_to_mvgam.R`**: series_to_mvgam
- **`R/sim_mvgam.R`**: sim_mvgam
- **`R/stability.R`**: stability
- **`R/trend_system.R`**: AR, CAR, create_mvgam_trend, custom_trend, GP, is.trend_param, list_trend_types, mvgam_trend_choices, PW, register_custom_trend, register_trend_type, RW, trend_param, VAR, ZMVN
- **`R/validations.R`**: is.mvgam_trend

## Notes for LLM Agents
- **Primary workflow**: `mvgam()` -> prior/trend system setup -> Stan assembly -> model fitting -> S3 methods
- **Prior system**: `mvgam_formula()`, `get_prior()`, `set_prior()` for Bayesian prior specification
- **Trend system**: `trend_param()`, `register_trend_type()` for time series trend modeling
- **Stan assembly**: `stancode()`, `standata()` for Stan model compilation and data preparation
- **Stan integration**: Package heavily relies on Stan/brms for Bayesian computation
- **S3 system**: Extensive use of S3 classes (`mvgam`, `mvgam_forecast`, etc.) with method dispatch
- **File patterns**: `R/priors.R` (prior system), `R/trend_system.R` (trends), `R/stan_assembly.R` (Stan code)
- **Core functions often call**: validation functions, Stan code generation, data preprocessing utilities
